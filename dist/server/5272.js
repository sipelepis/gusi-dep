"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=5272,exports.ids=[5272,9575],exports.modules={59575:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AccessControlModule:()=>AccessControlModule});var common=__webpack_require__(10210),router=__webpack_require__(37895),shared_module=__webpack_require__(66004),cjs=__webpack_require__(39942),operators=__webpack_require__(5796),paginated_list_model=__webpack_require__(73535),eperson_data_service=__webpack_require__(53019),empty_util=__webpack_require__(25839),notifications_service=__webpack_require__(16228),pagination_component_options_model=__webpack_require__(98865);class EpersonDtoModel{}__name(EpersonDtoModel,"EpersonDtoModel");var feature_id=__webpack_require__(84705),authorization_data_service=__webpack_require__(30835),shared_operators=__webpack_require__(63281),confirmation_modal_component=__webpack_require__(25366),request_service=__webpack_require__(37958),page_info_model=__webpack_require__(45419),pagination_service=__webpack_require__(57854),core=__webpack_require__(70074),ngx_translate_core=__webpack_require__(47241),fesm2015_forms=__webpack_require__(45028),ng_bootstrap=__webpack_require__(63742),fesm2015_core=__webpack_require__(65737),group_data_service=__webpack_require__(96652),eperson_model=__webpack_require__(62610),form_builder_service=__webpack_require__(24656),auth_service=__webpack_require__(28709),follow_link_config_model=__webpack_require__(8183);class ValidateEmailNotTaken{static createValidator(ePersonDataService){return control=>ePersonDataService.getEPersonByEmail(control.value).pipe((0,shared_operators.xw)(),(0,operators.UI)(res=>res.payload?{emailTaken:!0}:null))}}__name(ValidateEmailNotTaken,"ValidateEmailNotTaken");var eperson_registration_service=__webpack_require__(37188),form_component=__webpack_require__(61792),themed_loading_component=__webpack_require__(76924),pagination_component=__webpack_require__(99292);function EPersonFormComponent_div_0_Template(rf,ctx){1&rf&&core._UZ(0,"div")}function EPersonFormComponent_ng_template_2_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h4"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r2=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r2.messagePrefix+".create"))}}function EPersonFormComponent_ng_template_4_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h4"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r4=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r4.messagePrefix+".edit"))}}__name(EPersonFormComponent_div_0_Template,"EPersonFormComponent_div_0_Template"),__name(EPersonFormComponent_ng_template_2_Template,"EPersonFormComponent_ng_template_2_Template"),__name(EPersonFormComponent_ng_template_4_Template,"EPersonFormComponent_ng_template_4_Template");const _c0=__name(function(a0){return{"d-none":a0}},"_c0");function EPersonFormComponent_button_19_Template(rf,ctx){if(1&rf){const _r10=core.EpF();core.TgZ(0,"button",17),core.NdJ("click",__name(function(){return core.CHM(_r10),core.oxw().impersonate()},"EPersonFormComponent_button_19_Template_button_click_0_listener")),core.ALo(1,"async"),core._UZ(2,"i",18),core._uU(3),core.ALo(4,"translate"),core.qZA()}if(2&rf){const ctx_r5=core.oxw();core.Q6J("ngClass",core.VKq(6,_c0,!core.lcZ(1,2,ctx_r5.canImpersonate$))),core.xp6(3),core.hij(" ",core.lcZ(4,4,"admin.access-control.epeople.actions.impersonate")," ")}}function EPersonFormComponent_button_20_Template(rf,ctx){if(1&rf){const _r12=core.EpF();core.TgZ(0,"button",19),core.NdJ("click",__name(function(){return core.CHM(_r12),core.oxw().stopImpersonating()},"EPersonFormComponent_button_20_Template_button_click_0_listener")),core._UZ(1,"i",18),core._uU(2),core.ALo(3,"translate"),core.qZA()}2&rf&&(core.xp6(2),core.hij(" ",core.lcZ(3,1,"admin.access-control.epeople.actions.stop-impersonating")," "))}function EPersonFormComponent_ds_themed_loading_26_Template(rf,ctx){1&rf&&core._UZ(0,"ds-themed-loading",20),2&rf&&core.Q6J("showMessage",!1)}function EPersonFormComponent_div_27_ds_themed_loading_4_Template(rf,ctx){1&rf&&core._UZ(0,"ds-themed-loading",20),2&rf&&core.Q6J("showMessage",!1)}__name(EPersonFormComponent_button_19_Template,"EPersonFormComponent_button_19_Template"),__name(EPersonFormComponent_button_20_Template,"EPersonFormComponent_button_20_Template"),__name(EPersonFormComponent_ds_themed_loading_26_Template,"EPersonFormComponent_ds_themed_loading_26_Template"),__name(EPersonFormComponent_div_27_ds_themed_loading_4_Template,"EPersonFormComponent_div_27_ds_themed_loading_4_Template");const _c1=__name(function(a0){return[a0]},"_c1");function EPersonFormComponent_div_27_ds_pagination_6_tr_17_Template(rf,ctx){if(1&rf){const _r19=core.EpF();core.TgZ(0,"tr")(1,"td",28),core._uU(2),core.qZA(),core.TgZ(3,"td",28)(4,"a",29),core.NdJ("click",__name(function(){const group_r17=core.CHM(_r19).$implicit;return core.oxw(3).groupsDataService.startEditingNewGroup(group_r17)},"EPersonFormComponent_div_27_ds_pagination_6_tr_17_Template_a_click_4_listener")),core._uU(5),core.qZA()(),core.TgZ(6,"td",28),core._uU(7),core.ALo(8,"async"),core.qZA()()}if(2&rf){const group_r17=ctx.$implicit,ctx_r16=core.oxw(3);let tmp_3_0;core.xp6(2),core.Oqu(group_r17.id),core.xp6(2),core.Q6J("routerLink",core.VKq(6,_c1,ctx_r16.groupsDataService.getGroupEditPageRouterLink(group_r17))),core.xp6(1),core.Oqu(group_r17.name),core.xp6(2),core.Oqu(null==(tmp_3_0=core.lcZ(8,4,group_r17.object))||null==tmp_3_0.payload?null:tmp_3_0.payload.name)}}function EPersonFormComponent_div_27_ds_pagination_6_Template(rf,ctx){if(1&rf){const _r21=core.EpF();core.TgZ(0,"ds-pagination",23),core.NdJ("pageChange",__name(function($event){return core.CHM(_r21),core.oxw(2).onPageChange($event)},"EPersonFormComponent_div_27_ds_pagination_6_Template_ds_pagination_pageChange_0_listener")),core.ALo(1,"async"),core.ALo(2,"async"),core.TgZ(3,"div",24)(4,"table",25)(5,"thead")(6,"tr")(7,"th",26),core._uU(8),core.ALo(9,"translate"),core.qZA(),core.TgZ(10,"th",26),core._uU(11),core.ALo(12,"translate"),core.qZA(),core.TgZ(13,"th",26),core._uU(14),core.ALo(15,"translate"),core.qZA()()(),core.TgZ(16,"tbody"),core.YNc(17,EPersonFormComponent_div_27_ds_pagination_6_tr_17_Template,9,8,"tr",27),core.ALo(18,"async"),core.qZA()()()()}if(2&rf){const ctx_r14=core.oxw(2);let tmp_1_0,tmp_2_0,tmp_8_0;core.Q6J("paginationOptions",ctx_r14.config)("pageInfoState",null==(tmp_1_0=core.lcZ(1,9,ctx_r14.groups))?null:tmp_1_0.payload)("collectionSize",null==(tmp_2_0=core.lcZ(2,11,ctx_r14.groups))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(8),core.Oqu(core.lcZ(9,13,ctx_r14.messagePrefix+".table.id")),core.xp6(3),core.Oqu(core.lcZ(12,15,ctx_r14.messagePrefix+".table.name")),core.xp6(3),core.Oqu(core.lcZ(15,17,ctx_r14.messagePrefix+".table.collectionOrCommunity")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_8_0=core.lcZ(18,19,ctx_r14.groups))||null==tmp_8_0.payload?null:tmp_8_0.payload.page)}}function EPersonFormComponent_div_27_div_8_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",30)(1,"div"),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"div")(5,"button",31),core._uU(6),core.ALo(7,"translate"),core.qZA()()()),2&rf){const ctx_r15=core.oxw(2);core.xp6(2),core.Oqu(core.lcZ(3,3,ctx_r15.messagePrefix+".memberOfNoGroups")),core.xp6(3),core.Q6J("routerLink",core.VKq(7,_c1,ctx_r15.groupsDataService.getGroupRegistryRouterLink())),core.xp6(1),core.Oqu(core.lcZ(7,5,ctx_r15.messagePrefix+".goToGroups"))}}function EPersonFormComponent_div_27_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div")(1,"h5"),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.YNc(4,EPersonFormComponent_div_27_ds_themed_loading_4_Template,1,1,"ds-themed-loading",15),core.ALo(5,"async"),core.YNc(6,EPersonFormComponent_div_27_ds_pagination_6_Template,19,21,"ds-pagination",21),core.ALo(7,"async"),core.YNc(8,EPersonFormComponent_div_27_div_8_Template,8,9,"div",22),core.ALo(9,"async"),core.qZA()),2&rf){const ctx_r8=core.oxw();let tmp_2_0,tmp_3_0;core.xp6(2),core.Oqu(core.lcZ(3,4,ctx_r8.messagePrefix+".groupsEPersonIsMemberOf")),core.xp6(2),core.Q6J("ngIf",!core.lcZ(5,6,ctx_r8.groups)),core.xp6(2),core.Q6J("ngIf",(null==(tmp_2_0=core.lcZ(7,8,ctx_r8.groups))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)>0),core.xp6(2),core.Q6J("ngIf",0==(null==(tmp_3_0=core.lcZ(9,10,ctx_r8.groups))||null==tmp_3_0.payload?null:tmp_3_0.payload.totalElements))}}__name(EPersonFormComponent_div_27_ds_pagination_6_tr_17_Template,"EPersonFormComponent_div_27_ds_pagination_6_tr_17_Template"),__name(EPersonFormComponent_div_27_ds_pagination_6_Template,"EPersonFormComponent_div_27_ds_pagination_6_Template"),__name(EPersonFormComponent_div_27_div_8_Template,"EPersonFormComponent_div_27_div_8_Template"),__name(EPersonFormComponent_div_27_Template,"EPersonFormComponent_div_27_Template");class EPersonFormComponent{constructor(changeDetectorRef,epersonService,groupsDataService,formBuilderService,translateService,notificationsService,authService,authorizationService,modalService,paginationService,requestService,epersonRegistrationService){this.changeDetectorRef=changeDetectorRef,this.epersonService=epersonService,this.groupsDataService=groupsDataService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.notificationsService=notificationsService,this.authService=authService,this.authorizationService=authorizationService,this.modalService=modalService,this.paginationService=paginationService,this.requestService=requestService,this.epersonRegistrationService=epersonRegistrationService,this.labelPrefix="admin.access-control.epeople.form.",this.formId="eperson-form",this.messagePrefix="admin.access-control.epeople.form",this.formLayout={firstName:{grid:{host:"row"}},lastName:{grid:{host:"row"}},email:{grid:{host:"row"}},canLogIn:{grid:{host:"col col-sm-6 d-inline-block"}},requireCertificate:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new core.vpe,this.cancelForm=new core.vpe,this.subs=[],this.config=Object.assign(new pagination_component_options_model.r,{id:"gem",pageSize:5,currentPage:1}),this.isImpersonated=!1,this.subs.push(this.epersonService.getActiveEPerson().subscribe(eperson=>{this.epersonInitial=eperson,(0,empty_util.Uh)(eperson)&&(this.isImpersonated=this.authService.isImpersonatingUser(eperson.id))}))}ngOnInit(){this.initialisePage()}initialisePage(){(0,cjs.combineLatest)(this.translateService.get(`${this.messagePrefix}.firstName`),this.translateService.get(`${this.messagePrefix}.lastName`),this.translateService.get(`${this.messagePrefix}.email`),this.translateService.get(`${this.messagePrefix}.canLogIn`),this.translateService.get(`${this.messagePrefix}.requireCertificate`),this.translateService.get(`${this.messagePrefix}.emailHint`)).subscribe(([firstName,lastName,email,canLogIn,requireCertificate,emailHint])=>{this.firstName=new fesm2015_core.b1u({id:"firstName",label:firstName,name:"firstName",validators:{required:null},required:!0}),this.lastName=new fesm2015_core.b1u({id:"lastName",label:lastName,name:"lastName",validators:{required:null},required:!0}),this.email=new fesm2015_core.b1u({id:"email",label:email,name:"email",validators:{required:null,pattern:"^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"},required:!0,errorMessages:{emailTaken:"error.validation.emailTaken",pattern:"error.validation.NotValidEmail"},hint:emailHint}),this.canLogIn=new fesm2015_core.dwp({id:"canLogIn",label:canLogIn,name:"canLogIn",value:null==this.epersonInitial||this.epersonInitial.canLogIn}),this.requireCertificate=new fesm2015_core.dwp({id:"requireCertificate",label:requireCertificate,name:"requireCertificate",value:null!=this.epersonInitial&&this.epersonInitial.requireCertificate}),this.formModel=[this.firstName,this.lastName,this.email,this.canLogIn,this.requireCertificate],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.subs.push(this.epersonService.getActiveEPerson().subscribe(eperson=>{null!=eperson&&(this.groups=this.groupsDataService.findListByHref(eperson._links.groups.href,{currentPage:1,elementsPerPage:this.config.pageSize})),this.formGroup.patchValue({firstName:null!=eperson?eperson.firstMetadataValue("eperson.firstname"):"",lastName:null!=eperson?eperson.firstMetadataValue("eperson.lastname"):"",email:null!=eperson?eperson.email:"",canLogIn:null==eperson||eperson.canLogIn,requireCertificate:null!=eperson&&eperson.requireCertificate}),null===eperson&&this.formGroup.controls.email&&(this.formGroup.controls.email.setAsyncValidators(ValidateEmailNotTaken.createValidator(this.epersonService)),this.emailValueChangeSubscribe=this.email.valueChanges.pipe((0,operators.bh)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()}))}));const activeEPerson$=this.epersonService.getActiveEPerson();this.groups=activeEPerson$.pipe((0,operators.wt)(eperson=>(0,cjs.combineLatest)([(0,cjs.of)(eperson),this.paginationService.getFindListOptions(this.config.id,{currentPage:1,elementsPerPage:this.config.pageSize})])),(0,operators.wt)(([eperson,findListOptions])=>null!=eperson?this.groupsDataService.findListByHref(eperson._links.groups.href,findListOptions,!0,!0,(0,follow_link_config_model.l)("object")):(0,cjs.of)(void 0))),this.canImpersonate$=activeEPerson$.pipe((0,operators.wt)(eperson=>(0,empty_util.Uh)(eperson)?this.authorizationService.isAuthorized(feature_id.i.LoginOnBehalfOf,eperson.self):(0,cjs.of)(!1))),this.canDelete$=activeEPerson$.pipe((0,operators.wt)(eperson=>this.authorizationService.isAuthorized(feature_id.i.CanDelete,(0,empty_util.Uh)(eperson)?eperson.self:void 0))),this.canReset$=(0,cjs.of)(!0)})}onCancel(){this.epersonService.cancelEditEPerson(),this.cancelForm.emit()}onSubmit(){this.epersonService.getActiveEPerson().pipe((0,operators.qn)(1)).subscribe(ePerson=>{const values={metadata:{"eperson.firstname":[{value:this.firstName.value}],"eperson.lastname":[{value:this.lastName.value}]},email:this.email.value,canLogIn:this.canLogIn.value,requireCertificate:this.requireCertificate.value};null==ePerson?this.createNewEPerson(values):this.editEPerson(ePerson,values)})}createNewEPerson(values){const ePersonToCreate=Object.assign(new eperson_model.T,values);this.epersonService.create(ePersonToCreate).pipe((0,shared_operators.hC)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.created.success",{name:ePersonToCreate.name})),this.submitForm.emit(ePersonToCreate)):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.created.failure",{name:ePersonToCreate.name})),this.cancelForm.emit())}),this.showNotificationIfEmailInUse(ePersonToCreate,"created")}editEPerson(ePerson,values){const editedEperson=Object.assign(new eperson_model.T,{id:ePerson.id,metadata:{"eperson.firstname":[{value:this.firstName.value?this.firstName.value:ePerson.firstMetadataValue("eperson.firstname")}],"eperson.lastname":[{value:this.lastName.value?this.lastName.value:ePerson.firstMetadataValue("eperson.lastname")}]},email:(0,empty_util.Uh)(values.email)?values.email:ePerson.email,canLogIn:(0,empty_util.Uh)(values.canLogIn)?values.canLogIn:ePerson.canLogIn,requireCertificate:(0,empty_util.Uh)(values.requireCertificate)?values.requireCertificate:ePerson.requireCertificate,_links:ePerson._links});this.epersonService.updateEPerson(editedEperson).pipe((0,shared_operators.hC)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.edited.success",{name:editedEperson.name})),this.submitForm.emit(editedEperson)):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.edited.failure",{name:editedEperson.name})),this.cancelForm.emit())}),null!=values.email&&values.email!==ePerson.email&&this.showNotificationIfEmailInUse(editedEperson,"edited")}onPageChange(event){this.updateGroups({currentPage:event,elementsPerPage:this.config.pageSize})}impersonate(){this.authService.impersonate(this.epersonInitial.id),this.isImpersonated=!0}delete(){this.epersonService.getActiveEPerson().pipe((0,operators.qn)(1)).subscribe(eperson=>{const modalRef=this.modalService.open(confirmation_modal_component.Y);modalRef.componentInstance.dso=eperson,modalRef.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",modalRef.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",modalRef.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",modalRef.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.qn)(1)).subscribe(confirm=>{confirm&&(0,empty_util.Uh)(eperson.id)&&this.epersonService.deleteEPerson(eperson).pipe((0,shared_operators.hC)()).subscribe(restResponse=>{restResponse.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:eperson.name})),this.submitForm.emit()):this.notificationsService.error("Error occured when trying to delete EPerson with id: "+eperson.id+" with code: "+restResponse.statusCode+" and message: "+restResponse.errorMessage),this.cancelForm.emit()})})})}stopImpersonating(){this.authService.stopImpersonatingAndRefresh(),this.isImpersonated=!1}resetPassword(){(0,empty_util.Uh)(this.epersonInitial.email)&&this.epersonRegistrationService.registerEmail(this.epersonInitial.email).pipe((0,shared_operators.hC)()).subscribe(response=>{response.hasSucceeded?this.notificationsService.success(this.translateService.get("admin.access-control.epeople.actions.reset"),this.translateService.get("forgot-email.form.success.content",{email:this.epersonInitial.email})):this.notificationsService.error(this.translateService.get("forgot-email.form.error.head"),this.translateService.get("forgot-email.form.error.content",{email:this.epersonInitial.email}))})}ngOnDestroy(){this.onCancel(),this.subs.filter(sub=>(0,empty_util.Uh)(sub)).forEach(sub=>sub.unsubscribe()),this.paginationService.clearPagination(this.config.id),(0,empty_util.Uh)(this.emailValueChangeSubscribe)&&this.emailValueChangeSubscribe.unsubscribe()}reset(){this.epersonService.getActiveEPerson().pipe((0,operators.qn)(1)).subscribe(eperson=>{this.requestService.removeByHrefSubstring(eperson.self)}),this.initialisePage()}showNotificationIfEmailInUse(ePerson,notificationSection){this.subs.push(this.epersonService.searchByScope("email",ePerson.email,{currentPage:1,elementsPerPage:0}).pipe((0,shared_operators.xw)(),(0,shared_operators.xe)()).subscribe(list=>{list.totalElements>0&&this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification."+notificationSection+".failure.emailInUse",{name:ePerson.name,email:ePerson.email}))}))}updateGroups(options){this.subs.push(this.epersonService.getActiveEPerson().subscribe(eperson=>{this.groups=this.groupsDataService.findListByHref(eperson._links.groups.href,options)}))}}function EPeopleRegistryComponent_div_7_Template(rf,ctx){if(1&rf){const _r4=core.EpF();core.TgZ(0,"div")(1,"button",7),core.NdJ("click",__name(function(){core.CHM(_r4);return core.oxw().isEPersonFormShown=!0},"EPeopleRegistryComponent_div_7_Template_button_click_1_listener")),core._UZ(2,"i",8),core.TgZ(3,"span",9),core._uU(4),core.ALo(5,"translate"),core.qZA()()()}if(2&rf){const ctx_r0=core.oxw();core.xp6(4),core.Oqu(core.lcZ(5,1,ctx_r0.labelPrefix+"button.add"))}}function EPeopleRegistryComponent_ds_eperson_form_8_Template(rf,ctx){if(1&rf){const _r6=core.EpF();core.TgZ(0,"ds-eperson-form",10),core.NdJ("submitForm",__name(function(){return core.CHM(_r6),core.oxw().reset()},"EPeopleRegistryComponent_ds_eperson_form_8_Template_ds_eperson_form_submitForm_0_listener"))("cancelForm",__name(function(){core.CHM(_r6);return core.oxw().isEPersonFormShown=!1},"EPeopleRegistryComponent_ds_eperson_form_8_Template_ds_eperson_form_cancelForm_0_listener")),core.qZA()}}function EPeopleRegistryComponent_div_9_ds_themed_loading_27_Template(rf,ctx){1&rf&&core._UZ(0,"ds-themed-loading")}__name(EPersonFormComponent,"EPersonFormComponent"),EPersonFormComponent.\u0275fac=__name(function(t){return new(t||EPersonFormComponent)(core.Y36(core.sBO),core.Y36(eperson_data_service.k),core.Y36(group_data_service.O),core.Y36(form_builder_service.c),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(auth_service.e8),core.Y36(authorization_data_service._),core.Y36(ng_bootstrap.FF),core.Y36(pagination_service.N),core.Y36(request_service.s),core.Y36(eperson_registration_service.m))},"EPersonFormComponent_Factory"),EPersonFormComponent.\u0275cmp=core.Xpm({type:EPersonFormComponent,selectors:[["ds-eperson-form"]],outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},decls:29,vars:31,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["createHeader",""],["editheader",""],[3,"formId","formModel","formGroup","formLayout","displayCancel","submitForm"],["before","",1,"btn-group"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["between","",1,"btn-group"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fa","fa-key"],["between","",1,"btn-group","ml-1"],["class","btn btn-primary",3,"ngClass","click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],["after","",1,"btn","btn-danger","delete-button",3,"disabled","click"],[1,"fas","fa-trash"],[3,"showMessage",4,"ngIf"],[4,"ngIf"],[1,"btn","btn-primary",3,"ngClass","click"],[1,"fa","fa-user-secret"],[1,"btn","btn-primary",3,"click"],[3,"showMessage"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage","pageChange",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage","pageChange"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[4,"ngFor","ngForOf"],[1,"align-middle"],[3,"routerLink","click"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"btn","btn-primary",3,"routerLink"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,EPersonFormComponent_div_0_Template,1,0,"div",0),core.ALo(1,"async"),core.YNc(2,EPersonFormComponent_ng_template_2_Template,3,3,"ng-template",null,1,core.W1O),core.YNc(4,EPersonFormComponent_ng_template_4_Template,3,3,"ng-template",null,2,core.W1O),core.TgZ(6,"ds-form",3),core.NdJ("submitForm",__name(function(){return ctx.onSubmit()},"EPersonFormComponent_Template_ds_form_submitForm_6_listener")),core.TgZ(7,"div",4)(8,"button",5),core.NdJ("click",__name(function(){return ctx.onCancel()},"EPersonFormComponent_Template_button_click_8_listener")),core._UZ(9,"i",6),core._uU(10),core.ALo(11,"translate"),core.qZA()(),core.TgZ(12,"div",7)(13,"button",8),core.NdJ("click",__name(function(){return ctx.resetPassword()},"EPersonFormComponent_Template_button_click_13_listener")),core.ALo(14,"async"),core._UZ(15,"i",9),core._uU(16),core.ALo(17,"translate"),core.qZA()(),core.TgZ(18,"div",10),core.YNc(19,EPersonFormComponent_button_19_Template,5,8,"button",11),core.YNc(20,EPersonFormComponent_button_20_Template,4,3,"button",12),core.qZA(),core.TgZ(21,"button",13),core.NdJ("click",__name(function(){return ctx.delete()},"EPersonFormComponent_Template_button_click_21_listener")),core.ALo(22,"async"),core._UZ(23,"i",14),core._uU(24),core.ALo(25,"translate"),core.qZA()(),core.YNc(26,EPersonFormComponent_ds_themed_loading_26_Template,1,1,"ds-themed-loading",15),core.YNc(27,EPersonFormComponent_div_27_Template,10,12,"div",16),core.ALo(28,"async")),2&rf){const _r1=core.MAs(3),_r3=core.MAs(5);core.Q6J("ngIf",core.lcZ(1,17,ctx.epersonService.getActiveEPerson()))("ngIfThen",_r3)("ngIfElse",_r1),core.xp6(6),core.Q6J("formId",ctx.formId)("formModel",ctx.formModel)("formGroup",ctx.formGroup)("formLayout",ctx.formLayout)("displayCancel",!1),core.xp6(4),core.hij(" ",core.lcZ(11,19,ctx.messagePrefix+".return"),""),core.xp6(3),core.Q6J("disabled",!core.lcZ(14,21,ctx.canReset$)),core.xp6(3),core.hij(" ",core.lcZ(17,23,"admin.access-control.epeople.actions.reset")," "),core.xp6(3),core.Q6J("ngIf",!ctx.isImpersonated),core.xp6(1),core.Q6J("ngIf",ctx.isImpersonated),core.xp6(1),core.Q6J("disabled",!core.lcZ(22,25,ctx.canDelete$)),core.xp6(3),core.hij(" ",core.lcZ(25,27,"admin.access-control.epeople.actions.delete")," "),core.xp6(2),core.Q6J("ngIf",!ctx.formGroup),core.xp6(1),core.Q6J("ngIf",core.lcZ(28,29,ctx.epersonService.getActiveEPerson()))}},"EPersonFormComponent_Template"),directives:[common.O5,form_component.U,fesm2015_forms.JL,fesm2015_forms.sg,common.mk,themed_loading_component.Z,pagination_component.Q,common.sg,router.yS,router.rH],pipes:[common.Ov,ngx_translate_core.X$],encapsulation:2}),__name(EPeopleRegistryComponent_div_7_Template,"EPeopleRegistryComponent_div_7_Template"),__name(EPeopleRegistryComponent_ds_eperson_form_8_Template,"EPeopleRegistryComponent_ds_eperson_form_8_Template"),__name(EPeopleRegistryComponent_div_9_ds_themed_loading_27_Template,"EPeopleRegistryComponent_div_9_ds_themed_loading_27_Template");const epeople_registry_component_c0=__name(function(a0){return{"table-primary":a0}},"epeople_registry_component_c0"),epeople_registry_component_c1=__name(function(a0){return{name:a0}},"epeople_registry_component_c1");function EPeopleRegistryComponent_div_9_ds_pagination_29_tr_19_Template(rf,ctx){if(1&rf){const _r14=core.EpF();core.TgZ(0,"tr",30),core.ALo(1,"async"),core.TgZ(2,"td"),core._uU(3),core.qZA(),core.TgZ(4,"td"),core._uU(5),core.qZA(),core.TgZ(6,"td"),core._uU(7),core.qZA(),core.TgZ(8,"td")(9,"div",31)(10,"button",32),core.NdJ("click",__name(function(){const epersonDto_r12=core.CHM(_r14).$implicit;return core.oxw(3).toggleEditEPerson(epersonDto_r12.eperson)},"EPeopleRegistryComponent_div_9_ds_pagination_29_tr_19_Template_button_click_10_listener")),core.ALo(11,"translate"),core._UZ(12,"i",33),core.qZA(),core.TgZ(13,"button",34),core.NdJ("click",__name(function(){const epersonDto_r12=core.CHM(_r14).$implicit;return core.oxw(3).deleteEPerson(epersonDto_r12.eperson)},"EPeopleRegistryComponent_div_9_ds_pagination_29_tr_19_Template_button_click_13_listener")),core.ALo(14,"translate"),core._UZ(15,"i",35),core.qZA()()()()}if(2&rf){const epersonDto_r12=ctx.$implicit,ctx_r11=core.oxw(3);core.Q6J("ngClass",core.VKq(15,epeople_registry_component_c0,core.lcZ(1,7,ctx_r11.isActive(epersonDto_r12.eperson)))),core.xp6(3),core.Oqu(epersonDto_r12.eperson.id),core.xp6(2),core.Oqu(epersonDto_r12.eperson.name),core.xp6(2),core.Oqu(epersonDto_r12.eperson.email),core.xp6(3),core.s9C("title",core.xi3(11,9,ctx_r11.labelPrefix+"table.edit.buttons.edit",core.VKq(17,epeople_registry_component_c1,epersonDto_r12.eperson.name))),core.xp6(3),core.s9C("title",core.xi3(14,12,ctx_r11.labelPrefix+"table.edit.buttons.remove",core.VKq(19,epeople_registry_component_c1,epersonDto_r12.eperson.name))),core.Q6J("disabled",!epersonDto_r12.ableToDelete)}}function EPeopleRegistryComponent_div_9_ds_pagination_29_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",25),core.ALo(1,"async"),core.TgZ(2,"div",26)(3,"table",27)(4,"thead")(5,"tr")(6,"th",28),core._uU(7),core.ALo(8,"translate"),core.qZA(),core.TgZ(9,"th",28),core._uU(10),core.ALo(11,"translate"),core.qZA(),core.TgZ(12,"th",28),core._uU(13),core.ALo(14,"translate"),core.qZA(),core.TgZ(15,"th"),core._uU(16),core.ALo(17,"translate"),core.qZA()()(),core.TgZ(18,"tbody"),core.YNc(19,EPeopleRegistryComponent_div_9_ds_pagination_29_tr_19_Template,16,21,"tr",29),core.ALo(20,"async"),core.qZA()()()()),2&rf){const ctx_r9=core.oxw(2);let tmp_2_0,tmp_9_0;core.Q6J("paginationOptions",ctx_r9.config)("pageInfoState",ctx_r9.pageInfoState$)("collectionSize",null==(tmp_2_0=core.lcZ(1,10,ctx_r9.pageInfoState$))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(7),core.Oqu(core.lcZ(8,12,ctx_r9.labelPrefix+"table.id")),core.xp6(3),core.Oqu(core.lcZ(11,14,ctx_r9.labelPrefix+"table.name")),core.xp6(3),core.Oqu(core.lcZ(14,16,ctx_r9.labelPrefix+"table.email")),core.xp6(3),core.Oqu(core.lcZ(17,18,ctx_r9.labelPrefix+"table.edit")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_9_0=core.lcZ(20,20,ctx_r9.ePeopleDto$))?null:tmp_9_0.page)}}function EPeopleRegistryComponent_div_9_div_32_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",36),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r10=core.oxw(2);core.xp6(1),core.hij(" ",core.lcZ(2,1,ctx_r10.labelPrefix+"no-items")," ")}}function EPeopleRegistryComponent_div_9_Template(rf,ctx){if(1&rf){const _r17=core.EpF();core.TgZ(0,"div")(1,"h3",11),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"form",12),core.NdJ("ngSubmit",__name(function(){core.CHM(_r17);const ctx_r16=core.oxw();return ctx_r16.search(ctx_r16.searchForm.value)},"EPeopleRegistryComponent_div_9_Template_form_ngSubmit_4_listener")),core.TgZ(5,"div")(6,"select",13)(7,"option",14),core._uU(8),core.ALo(9,"translate"),core.qZA(),core.TgZ(10,"option",15),core._uU(11),core.ALo(12,"translate"),core.qZA()()(),core.TgZ(13,"div",16)(14,"div",17),core._UZ(15,"input",18),core.ALo(16,"translate"),core.ALo(17,"translate"),core.TgZ(18,"span",19)(19,"button",20),core._UZ(20,"i",21),core._uU(21),core.ALo(22,"translate"),core.qZA()()()(),core.TgZ(23,"div")(24,"button",22),core.NdJ("click",__name(function(){return core.CHM(_r17),core.oxw().clearFormAndResetResult()},"EPeopleRegistryComponent_div_9_Template_button_click_24_listener")),core._uU(25),core.ALo(26,"translate"),core.qZA()()(),core.YNc(27,EPeopleRegistryComponent_div_9_ds_themed_loading_27_Template,1,0,"ds-themed-loading",5),core.ALo(28,"async"),core.YNc(29,EPeopleRegistryComponent_div_9_ds_pagination_29_Template,21,22,"ds-pagination",23),core.ALo(30,"async"),core.ALo(31,"async"),core.YNc(32,EPeopleRegistryComponent_div_9_div_32_Template,3,3,"div",24),core.ALo(33,"async"),core.qZA()}if(2&rf){const ctx_r2=core.oxw();let tmp_9_0,tmp_10_0;core.xp6(2),core.hij("",core.lcZ(3,11,ctx_r2.labelPrefix+"search.head")," "),core.xp6(2),core.Q6J("formGroup",ctx_r2.searchForm),core.xp6(4),core.Oqu(core.lcZ(9,13,ctx_r2.labelPrefix+"search.scope.metadata")),core.xp6(3),core.Oqu(core.lcZ(12,15,ctx_r2.labelPrefix+"search.scope.email")),core.xp6(4),core.Q6J("placeholder",core.lcZ(17,19,ctx_r2.labelPrefix+"search.placeholder")),core.uIk("aria-label",core.lcZ(16,17,ctx_r2.labelPrefix+"search.placeholder")),core.xp6(6),core.hij(" ",core.lcZ(22,21,ctx_r2.labelPrefix+"search.button")," "),core.xp6(4),core.Oqu(core.lcZ(26,23,ctx_r2.labelPrefix+"button.see-all")),core.xp6(2),core.Q6J("ngIf",core.lcZ(28,25,ctx_r2.searching$)),core.xp6(2),core.Q6J("ngIf",(null==(tmp_9_0=core.lcZ(30,27,ctx_r2.pageInfoState$))?null:tmp_9_0.totalElements)>0&&!core.lcZ(31,29,ctx_r2.searching$)),core.xp6(3),core.Q6J("ngIf",0==(null==(tmp_10_0=core.lcZ(33,31,ctx_r2.pageInfoState$))?null:tmp_10_0.totalElements))}}__name(EPeopleRegistryComponent_div_9_ds_pagination_29_tr_19_Template,"EPeopleRegistryComponent_div_9_ds_pagination_29_tr_19_Template"),__name(EPeopleRegistryComponent_div_9_ds_pagination_29_Template,"EPeopleRegistryComponent_div_9_ds_pagination_29_Template"),__name(EPeopleRegistryComponent_div_9_div_32_Template,"EPeopleRegistryComponent_div_9_div_32_Template"),__name(EPeopleRegistryComponent_div_9_Template,"EPeopleRegistryComponent_div_9_Template");class EPeopleRegistryComponent{constructor(epersonService,translateService,notificationsService,authorizationService,formBuilder,router2,modalService,paginationService,requestService){this.epersonService=epersonService,this.translateService=translateService,this.notificationsService=notificationsService,this.authorizationService=authorizationService,this.formBuilder=formBuilder,this.router=router2,this.modalService=modalService,this.paginationService=paginationService,this.requestService=requestService,this.labelPrefix="admin.access-control.epeople.",this.ePeople$=new cjs.BehaviorSubject((0,paginated_list_model.b)(new page_info_model.S,[])),this.ePeopleDto$=new cjs.BehaviorSubject({}),this.pageInfoState$=new cjs.BehaviorSubject(void 0),this.searching$=new cjs.BehaviorSubject(!1),this.config=Object.assign(new pagination_component_options_model.r,{id:"elp",pageSize:5,currentPage:1}),this.subs=[],this.currentSearchQuery="",this.currentSearchScope="metadata",this.searchForm=this.formBuilder.group({scope:"metadata",query:""})}ngOnInit(){this.initialisePage()}initialisePage(){this.searching$.next(!0),this.isEPersonFormShown=!1,this.search({scope:this.currentSearchScope,query:this.currentSearchQuery}),this.subs.push(this.epersonService.getActiveEPerson().subscribe(eperson=>{null!=eperson&&eperson.id&&(this.isEPersonFormShown=!0)})),this.subs.push(this.ePeople$.pipe((0,operators.wt)(epeople=>epeople.pageInfo.totalElements>0?(0,cjs.combineLatest)(...epeople.page.map(eperson=>this.authorizationService.isAuthorized(feature_id.i.CanDelete,(0,empty_util.Uh)(eperson)?eperson.self:void 0).pipe((0,operators.UI)(authorized=>{const epersonDtoModel=new EpersonDtoModel;return epersonDtoModel.ableToDelete=authorized,epersonDtoModel.eperson=eperson,epersonDtoModel})))).pipe((0,operators.UI)(dtos=>(0,paginated_list_model.b)(epeople.pageInfo,dtos))):[epeople])).subscribe(value=>{this.searching$.next(!1),this.ePeopleDto$.next(value),this.pageInfoState$.next(value.pageInfo)}))}search(data){this.searching$.next(!0),(0,empty_util.Uh)(this.findListOptionsSub)&&this.findListOptionsSub.unsubscribe(),this.findListOptionsSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.wt)(findListOptions=>{const query=data.query,scope=data.scope;return null!=query&&this.currentSearchQuery!==query&&(this.router.navigate([this.epersonService.getEPeoplePageRouterLink()],{queryParamsHandling:"merge"}),this.currentSearchQuery=query,this.paginationService.resetPage(this.config.id)),null!=scope&&this.currentSearchScope!==scope&&(this.router.navigate([this.epersonService.getEPeoplePageRouterLink()],{queryParamsHandling:"merge"}),this.currentSearchScope=scope,this.paginationService.resetPage(this.config.id)),this.epersonService.searchByScope(this.currentSearchScope,this.currentSearchQuery,{currentPage:findListOptions.currentPage,elementsPerPage:findListOptions.pageSize})}),(0,shared_operators.g1)()).subscribe(peopleRD=>{this.ePeople$.next(peopleRD.payload),this.pageInfoState$.next(peopleRD.payload.pageInfo)})}isActive(eperson){return this.getActiveEPerson().pipe((0,operators.UI)(activeEPerson=>eperson===activeEPerson))}getActiveEPerson(){return this.epersonService.getActiveEPerson()}toggleEditEPerson(ePerson){this.getActiveEPerson().pipe((0,operators.qn)(1)).subscribe(activeEPerson=>{ePerson===activeEPerson?(this.epersonService.cancelEditEPerson(),this.isEPersonFormShown=!1):(this.epersonService.editEPerson(ePerson),this.isEPersonFormShown=!0)}),this.scrollToTop()}deleteEPerson(ePerson){if((0,empty_util.Uh)(ePerson.id)){const modalRef=this.modalService.open(confirmation_modal_component.Y);modalRef.componentInstance.dso=ePerson,modalRef.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",modalRef.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",modalRef.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",modalRef.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.qn)(1)).subscribe(confirm=>{confirm&&(0,empty_util.Uh)(ePerson.id)&&this.epersonService.deleteEPerson(ePerson).pipe((0,shared_operators.hC)()).subscribe(restResponse=>{restResponse.hasSucceeded?this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:ePerson.name})):this.notificationsService.error("Error occured when trying to delete EPerson with id: "+ePerson.id+" with code: "+restResponse.statusCode+" and message: "+restResponse.errorMessage)})})}}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){this.subs.filter(sub=>(0,empty_util.Uh)(sub)).forEach(sub=>sub.unsubscribe())}scrollToTop(){__name(function smoothscroll(){const currentScroll=document.documentElement.scrollTop||document.body.scrollTop;currentScroll>0&&(window.requestAnimationFrame(smoothscroll),window.scrollTo(0,currentScroll-currentScroll/8))},"smoothscroll")()}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}reset(){this.epersonService.getBrowseEndpoint().pipe((0,operators.qn)(1)).subscribe(href=>{this.requestService.setStaleByHrefSubstring(href).pipe((0,operators.qn)(1)).subscribe(()=>{this.epersonService.cancelEditEPerson(),this.isEPersonFormShown=!1})})}}__name(EPeopleRegistryComponent,"EPeopleRegistryComponent"),EPeopleRegistryComponent.\u0275fac=__name(function(t){return new(t||EPeopleRegistryComponent)(core.Y36(eperson_data_service.k),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(authorization_data_service._),core.Y36(fesm2015_forms.qu),core.Y36(router.F0),core.Y36(ng_bootstrap.FF),core.Y36(pagination_service.N),core.Y36(request_service.s))},"EPeopleRegistryComponent_Factory"),EPeopleRegistryComponent.\u0275cmp=core.Xpm({type:EPeopleRegistryComponent,selectors:[["ds-epeople-registry"]],decls:10,vars:6,consts:[[1,"container"],[1,"epeople-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[4,"ngIf"],[3,"submitForm","cancelForm",4,"ngIf"],[1,"mr-auto","btn","btn-success","addEPerson-button",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[3,"submitForm","cancelForm"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],["name","scope","id","scope","formControlName","scope","aria-label","Search scope",1,"form-control"],["value","metadata"],["value","email"],[1,"flex-grow-1","mr-3","ml-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"search-button","btn","btn-secondary",3,"click"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","epeople",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"title","click"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.YNc(7,EPeopleRegistryComponent_div_7_Template,6,3,"div",5),core.qZA(),core.YNc(8,EPeopleRegistryComponent_ds_eperson_form_8_Template,1,0,"ds-eperson-form",6),core.YNc(9,EPeopleRegistryComponent_div_9_Template,34,33,"div",5),core.qZA()()()),2&rf&&(core.xp6(5),core.Oqu(core.lcZ(6,4,ctx.labelPrefix+"head")),core.xp6(2),core.Q6J("ngIf",!ctx.isEPersonFormShown),core.xp6(1),core.Q6J("ngIf",ctx.isEPersonFormShown),core.xp6(1),core.Q6J("ngIf",!ctx.isEPersonFormShown))},"EPeopleRegistryComponent_Template"),directives:[common.O5,EPersonFormComponent,fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.sg,fesm2015_forms.EJ,fesm2015_forms.JJ,fesm2015_forms.u,fesm2015_forms.YN,fesm2015_forms.Kr,fesm2015_forms.Fj,themed_loading_component.Z,pagination_component.Q,common.sg,common.mk],pipes:[ngx_translate_core.X$,common.Ov],encapsulation:2});var collection_page_routing_paths=__webpack_require__(10954),community_page_routing_paths=__webpack_require__(18595),dspace_object_data_service=__webpack_require__(51163),group_model=__webpack_require__(15010),collection_model=__webpack_require__(34269),community_model=__webpack_require__(70920),aletr_type=__webpack_require__(338);class ValidateGroupExists{static createValidator(groupDataService){return control=>groupDataService.searchGroups(control.value,{currentPage:1,elementsPerPage:100}).pipe((0,shared_operators.LQ)(),(0,operators.UI)(groups=>groups.filter(group=>group.name===control.value)),(0,operators.UI)(groups=>groups.length>0?{groupExists:!0}:null))}}__name(ValidateGroupExists,"ValidateGroupExists");var alert_component=__webpack_require__(7519);const members_list_component_c0=__name(function(a0){return{name:a0}},"members_list_component_c0");function MembersListComponent_ds_pagination_28_tr_20_button_14_Template(rf,ctx){if(1&rf){const _r10=core.EpF();core.TgZ(0,"button",25),core.NdJ("click",__name(function(){core.CHM(_r10);const ePerson_r5=core.oxw().$implicit;return core.oxw(2).deleteMemberFromGroup(ePerson_r5)},"MembersListComponent_ds_pagination_28_tr_20_button_14_Template_button_click_0_listener")),core.ALo(1,"translate"),core._UZ(2,"i",26),core.qZA()}if(2&rf){const ePerson_r5=core.oxw().$implicit,ctx_r6=core.oxw(2);core.s9C("title",core.xi3(1,1,ctx_r6.messagePrefix+".table.edit.buttons.remove",core.VKq(4,members_list_component_c0,ePerson_r5.eperson.name)))}}function MembersListComponent_ds_pagination_28_tr_20_button_15_Template(rf,ctx){if(1&rf){const _r14=core.EpF();core.TgZ(0,"button",27),core.NdJ("click",__name(function(){core.CHM(_r14);const ePerson_r5=core.oxw().$implicit;return core.oxw(2).addMemberToGroup(ePerson_r5)},"MembersListComponent_ds_pagination_28_tr_20_button_15_Template_button_click_0_listener")),core.ALo(1,"translate"),core._UZ(2,"i",28),core.qZA()}if(2&rf){const ePerson_r5=core.oxw().$implicit,ctx_r7=core.oxw(2);core.s9C("title",core.xi3(1,1,ctx_r7.messagePrefix+".table.edit.buttons.add",core.VKq(4,members_list_component_c0,ePerson_r5.eperson.name)))}}__name(MembersListComponent_ds_pagination_28_tr_20_button_14_Template,"MembersListComponent_ds_pagination_28_tr_20_button_14_Template"),__name(MembersListComponent_ds_pagination_28_tr_20_button_15_Template,"MembersListComponent_ds_pagination_28_tr_20_button_15_Template");const members_list_component_c1=__name(function(a0){return[a0]},"members_list_component_c1");function MembersListComponent_ds_pagination_28_tr_20_Template(rf,ctx){if(1&rf){const _r17=core.EpF();core.TgZ(0,"tr")(1,"td",19),core._uU(2),core.qZA(),core.TgZ(3,"td",19)(4,"a",21),core.NdJ("click",__name(function(){const ePerson_r5=core.CHM(_r17).$implicit;return core.oxw(2).ePersonDataService.startEditingNewEPerson(ePerson_r5.eperson)},"MembersListComponent_ds_pagination_28_tr_20_Template_a_click_4_listener")),core._uU(5),core.qZA()(),core.TgZ(6,"td",19),core._uU(7),core.ALo(8,"translate"),core._UZ(9,"br"),core._uU(10),core.ALo(11,"translate"),core.qZA(),core.TgZ(12,"td",19)(13,"div",22),core.YNc(14,MembersListComponent_ds_pagination_28_tr_20_button_14_Template,3,6,"button",23),core.YNc(15,MembersListComponent_ds_pagination_28_tr_20_button_15_Template,3,6,"button",24),core.qZA()()()}if(2&rf){const ePerson_r5=ctx.$implicit,ctx_r4=core.oxw(2);core.xp6(2),core.Oqu(ePerson_r5.eperson.id),core.xp6(2),core.Q6J("routerLink",core.VKq(13,members_list_component_c1,ctx_r4.ePersonDataService.getEPeoplePageRouterLink())),core.xp6(1),core.Oqu(ePerson_r5.eperson.name),core.xp6(2),core.AsE(" ",core.lcZ(8,9,ctx_r4.messagePrefix+".table.email"),": ",ePerson_r5.eperson.email?ePerson_r5.eperson.email:"-",""),core.xp6(3),core.AsE(" ",core.lcZ(11,11,ctx_r4.messagePrefix+".table.netid"),": ",ePerson_r5.eperson.netid?ePerson_r5.eperson.netid:"-"," "),core.xp6(4),core.Q6J("ngIf",ePerson_r5.memberOfGroup),core.xp6(1),core.Q6J("ngIf",!ePerson_r5.memberOfGroup)}}function MembersListComponent_ds_pagination_28_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",15),core.ALo(1,"async"),core.ALo(2,"async"),core.TgZ(3,"div",16)(4,"table",17)(5,"thead")(6,"tr")(7,"th",18),core._uU(8),core.ALo(9,"translate"),core.qZA(),core.TgZ(10,"th",18),core._uU(11),core.ALo(12,"translate"),core.qZA(),core.TgZ(13,"th",18),core._uU(14),core.ALo(15,"translate"),core.qZA(),core.TgZ(16,"th",19),core._uU(17),core.ALo(18,"translate"),core.qZA()()(),core.TgZ(19,"tbody"),core.YNc(20,MembersListComponent_ds_pagination_28_tr_20_Template,16,15,"tr",20),core.ALo(21,"async"),core.qZA()()()()),2&rf){const ctx_r0=core.oxw();let tmp_2_0,tmp_9_0;core.Q6J("paginationOptions",ctx_r0.configSearch)("pageInfoState",core.lcZ(1,10,ctx_r0.ePeopleSearchDtos))("collectionSize",null==(tmp_2_0=core.lcZ(2,12,ctx_r0.ePeopleSearchDtos))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(8),core.Oqu(core.lcZ(9,14,ctx_r0.messagePrefix+".table.id")),core.xp6(3),core.Oqu(core.lcZ(12,16,ctx_r0.messagePrefix+".table.name")),core.xp6(3),core.Oqu(core.lcZ(15,18,ctx_r0.messagePrefix+".table.identity")),core.xp6(3),core.Oqu(core.lcZ(18,20,ctx_r0.messagePrefix+".table.edit")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_9_0=core.lcZ(21,22,ctx_r0.ePeopleSearchDtos))?null:tmp_9_0.page)}}function MembersListComponent_div_30_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",29),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r1=core.oxw();core.xp6(1),core.hij(" ",core.lcZ(2,1,ctx_r1.messagePrefix+".no-items")," ")}}function MembersListComponent_ds_pagination_35_tr_20_Template(rf,ctx){if(1&rf){const _r21=core.EpF();core.TgZ(0,"tr")(1,"td",19),core._uU(2),core.qZA(),core.TgZ(3,"td",19)(4,"a",21),core.NdJ("click",__name(function(){const ePerson_r19=core.CHM(_r21).$implicit;return core.oxw(2).ePersonDataService.startEditingNewEPerson(ePerson_r19.eperson)},"MembersListComponent_ds_pagination_35_tr_20_Template_a_click_4_listener")),core._uU(5),core.qZA()(),core.TgZ(6,"td",19),core._uU(7),core.ALo(8,"translate"),core._UZ(9,"br"),core._uU(10),core.ALo(11,"translate"),core.qZA(),core.TgZ(12,"td",19)(13,"div",22)(14,"button",25),core.NdJ("click",__name(function(){const ePerson_r19=core.CHM(_r21).$implicit;return core.oxw(2).deleteMemberFromGroup(ePerson_r19)},"MembersListComponent_ds_pagination_35_tr_20_Template_button_click_14_listener")),core.ALo(15,"translate"),core._UZ(16,"i",26),core.qZA()()()()}if(2&rf){const ePerson_r19=ctx.$implicit,ctx_r18=core.oxw(2);core.xp6(2),core.Oqu(ePerson_r19.eperson.id),core.xp6(2),core.Q6J("routerLink",core.VKq(15,members_list_component_c1,ctx_r18.ePersonDataService.getEPeoplePageRouterLink())),core.xp6(1),core.Oqu(ePerson_r19.eperson.name),core.xp6(2),core.AsE(" ",core.lcZ(8,8,ctx_r18.messagePrefix+".table.email"),": ",ePerson_r19.eperson.email?ePerson_r19.eperson.email:"-",""),core.xp6(3),core.AsE(" ",core.lcZ(11,10,ctx_r18.messagePrefix+".table.netid"),": ",ePerson_r19.eperson.netid?ePerson_r19.eperson.netid:"-"," "),core.xp6(4),core.s9C("title",core.xi3(15,12,ctx_r18.messagePrefix+".table.edit.buttons.remove",core.VKq(17,members_list_component_c0,ePerson_r19.eperson.name)))}}function MembersListComponent_ds_pagination_35_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",15),core.ALo(1,"async"),core.ALo(2,"async"),core.TgZ(3,"div",16)(4,"table",30)(5,"thead")(6,"tr")(7,"th",18),core._uU(8),core.ALo(9,"translate"),core.qZA(),core.TgZ(10,"th",18),core._uU(11),core.ALo(12,"translate"),core.qZA(),core.TgZ(13,"th",18),core._uU(14),core.ALo(15,"translate"),core.qZA(),core.TgZ(16,"th",19),core._uU(17),core.ALo(18,"translate"),core.qZA()()(),core.TgZ(19,"tbody"),core.YNc(20,MembersListComponent_ds_pagination_35_tr_20_Template,17,19,"tr",20),core.ALo(21,"async"),core.qZA()()()()),2&rf){const ctx_r2=core.oxw();let tmp_2_0,tmp_9_0;core.Q6J("paginationOptions",ctx_r2.config)("pageInfoState",core.lcZ(1,10,ctx_r2.ePeopleMembersOfGroupDtos))("collectionSize",null==(tmp_2_0=core.lcZ(2,12,ctx_r2.ePeopleMembersOfGroupDtos))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(8),core.Oqu(core.lcZ(9,14,ctx_r2.messagePrefix+".table.id")),core.xp6(3),core.Oqu(core.lcZ(12,16,ctx_r2.messagePrefix+".table.name")),core.xp6(3),core.Oqu(core.lcZ(15,18,ctx_r2.messagePrefix+".table.identity")),core.xp6(3),core.Oqu(core.lcZ(18,20,ctx_r2.messagePrefix+".table.edit")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_9_0=core.lcZ(21,22,ctx_r2.ePeopleMembersOfGroupDtos))?null:tmp_9_0.page)}}function MembersListComponent_div_37_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",29),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r3=core.oxw();core.xp6(1),core.hij(" ",core.lcZ(2,1,ctx_r3.messagePrefix+".no-members-yet")," ")}}var SubKey,SubKey2;__name(MembersListComponent_ds_pagination_28_tr_20_Template,"MembersListComponent_ds_pagination_28_tr_20_Template"),__name(MembersListComponent_ds_pagination_28_Template,"MembersListComponent_ds_pagination_28_Template"),__name(MembersListComponent_div_30_Template,"MembersListComponent_div_30_Template"),__name(MembersListComponent_ds_pagination_35_tr_20_Template,"MembersListComponent_ds_pagination_35_tr_20_Template"),__name(MembersListComponent_ds_pagination_35_Template,"MembersListComponent_ds_pagination_35_Template"),__name(MembersListComponent_div_37_Template,"MembersListComponent_div_37_Template"),(SubKey2=SubKey||(SubKey={}))[SubKey2.ActiveGroup=0]="ActiveGroup",SubKey2[SubKey2.MembersDTO=1]="MembersDTO",SubKey2[SubKey2.SearchResultsDTO=2]="SearchResultsDTO";class MembersListComponent{constructor(groupDataService,ePersonDataService,translateService,notificationsService,formBuilder,paginationService,router2){this.groupDataService=groupDataService,this.ePersonDataService=ePersonDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.formBuilder=formBuilder,this.paginationService=paginationService,this.router=router2,this.ePeopleSearchDtos=new cjs.BehaviorSubject(void 0),this.ePeopleMembersOfGroupDtos=new cjs.BehaviorSubject(void 0),this.configSearch=Object.assign(new pagination_component_options_model.r,{id:"sml",pageSize:5,currentPage:1}),this.config=Object.assign(new pagination_component_options_model.r,{id:"ml",pageSize:5,currentPage:1}),this.subs=new Map,this.currentSearchQuery="",this.currentSearchScope="metadata"}ngOnInit(){this.searchForm=this.formBuilder.group({scope:"metadata",query:""}),this.subs.set(SubKey.ActiveGroup,this.groupDataService.getActiveGroup().subscribe(activeGroup=>{null!=activeGroup&&(this.groupBeingEdited=activeGroup,this.retrieveMembers(this.config.currentPage))}))}retrieveMembers(page){this.unsubFrom(SubKey.MembersDTO),this.subs.set(SubKey.MembersDTO,this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.wt)(currentPagination=>this.ePersonDataService.findListByHref(this.groupBeingEdited._links.epersons.href,{currentPage:currentPagination.currentPage,elementsPerPage:currentPagination.pageSize})),(0,shared_operators.f1)(),(0,operators.UI)(rd=>{if(!rd.hasFailed)return rd;this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure",{cause:rd.errorMessage}))}),(0,operators.wt)(epersonListRD=>(0,cjs.combineLatest)([...epersonListRD.payload.page.map(member=>(0,cjs.combineLatest)(this.isMemberOfGroup(member),isMember=>{const epersonDtoModel=new EpersonDtoModel;return epersonDtoModel.eperson=member,epersonDtoModel.memberOfGroup=isMember,epersonDtoModel}))]).pipe((0,operators.dL)([]),(0,operators.UI)(dtos=>(0,paginated_list_model.b)(epersonListRD.payload.pageInfo,dtos))))).subscribe(paginatedListOfDTOs=>{this.ePeopleMembersOfGroupDtos.next(paginatedListOfDTOs)}))}isMemberOfGroup(possibleMember){return this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1),(0,operators.zg)(group=>null!=group?this.ePersonDataService.findListByHref(group._links.epersons.href,{currentPage:1,elementsPerPage:9999}).pipe((0,shared_operators.xw)(),(0,shared_operators.xe)(),(0,operators.UI)(listEPeopleInGroup=>listEPeopleInGroup.page.filter(ePersonInList=>ePersonInList.id===possibleMember.id)),(0,operators.UI)(epeople=>epeople.length>0)):(0,cjs.of)(!1)))}unsubFrom(key){this.subs.has(key)&&(this.subs.get(key).unsubscribe(),this.subs.delete(key))}deleteMemberFromGroup(ePerson){this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1)).subscribe(activeGroup=>{if(null!=activeGroup){const response=this.groupDataService.deleteMemberFromGroup(activeGroup,ePerson.eperson);this.showNotifications("deleteMember",response,ePerson.eperson.name,activeGroup)}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}addMemberToGroup(ePerson){ePerson.memberOfGroup=!0,this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1)).subscribe(activeGroup=>{if(null!=activeGroup){const response=this.groupDataService.addMemberToGroup(activeGroup,ePerson.eperson);this.showNotifications("addMember",response,ePerson.eperson.name,activeGroup)}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}search(data){this.unsubFrom(SubKey.SearchResultsDTO),this.subs.set(SubKey.SearchResultsDTO,this.paginationService.getCurrentPagination(this.configSearch.id,this.configSearch).pipe((0,operators.wt)(paginationOptions=>{const query=data.query,scope=data.scope;return null!=query&&this.currentSearchQuery!==query&&this.groupBeingEdited&&(this.router.navigate([],{queryParamsHandling:"merge"}),this.currentSearchQuery=query,this.paginationService.resetPage(this.configSearch.id)),null!=scope&&this.currentSearchScope!==scope&&this.groupBeingEdited&&(this.router.navigate([],{queryParamsHandling:"merge"}),this.currentSearchScope=scope,this.paginationService.resetPage(this.configSearch.id)),this.searchDone=!0,this.ePersonDataService.searchByScope(this.currentSearchScope,this.currentSearchQuery,{currentPage:paginationOptions.currentPage,elementsPerPage:paginationOptions.pageSize})}),(0,shared_operators.f1)(),(0,operators.UI)(rd=>{if(!rd.hasFailed)return rd;this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure",{cause:rd.errorMessage}))}),(0,operators.wt)(epersonListRD=>(0,cjs.combineLatest)([...epersonListRD.payload.page.map(member=>(0,cjs.combineLatest)(this.isMemberOfGroup(member),isMember=>{const epersonDtoModel=new EpersonDtoModel;return epersonDtoModel.eperson=member,epersonDtoModel.memberOfGroup=isMember,epersonDtoModel}))]).pipe((0,operators.dL)([]),(0,operators.UI)(dtos=>(0,paginated_list_model.b)(epersonListRD.payload.pageInfo,dtos))))).subscribe(paginatedListOfDTOs=>{this.ePeopleSearchDtos.next(paginatedListOfDTOs)}))}ngOnDestroy(){for(const key of this.subs.keys())this.unsubFrom(key);this.paginationService.clearPagination(this.config.id),this.paginationService.clearPagination(this.configSearch.id)}showNotifications(messageSuffix,response,nameObject,activeGroup){response.pipe((0,shared_operators.hC)()).subscribe(rd=>{rd.hasSucceeded?this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.success."+messageSuffix,{name:nameObject})):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure."+messageSuffix,{name:nameObject}))})}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}}__name(MembersListComponent,"MembersListComponent"),MembersListComponent.\u0275fac=__name(function(t){return new(t||MembersListComponent)(core.Y36(group_data_service.O),core.Y36(eperson_data_service.k),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(fesm2015_forms.qu),core.Y36(pagination_service.N),core.Y36(router.F0))},"MembersListComponent_Factory"),MembersListComponent.\u0275cmp=core.Xpm({type:MembersListComponent,selectors:[["ds-members-list"]],inputs:{messagePrefix:"messagePrefix"},decls:40,vars:36,consts:[[1,"border-bottom","pb-2"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],["name","scope","id","scope","formControlName","scope","aria-label","Search scope",1,"form-control"],["value","metadata"],["value","email"],[1,"flex-grow-1","mr-3","ml-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query","aria-label","Search input",1,"form-control"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary",3,"click"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","epersonsSearch",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[1,"align-middle"],[4,"ngFor","ngForOf"],[3,"routerLink","click"],[1,"btn-group","edit-field"],["class","btn btn-outline-danger btn-sm",3,"title","click",4,"ngIf"],["class","btn btn-outline-primary btn-sm",3,"title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm",3,"title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-primary","btn-sm",3,"title","click"],[1,"fas","fa-plus","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["id","ePeopleMembersOfGroup",1,"table","table-striped","table-hover","table-bordered"]],template:__name(function(rf,ctx){if(1&rf&&(core.ynx(0),core.TgZ(1,"h3",0),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"h4",1),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.TgZ(7,"form",2),core.NdJ("ngSubmit",__name(function(){return ctx.search(ctx.searchForm.value)},"MembersListComponent_Template_form_ngSubmit_7_listener")),core.TgZ(8,"div")(9,"select",3)(10,"option",4),core._uU(11),core.ALo(12,"translate"),core.qZA(),core.TgZ(13,"option",5),core._uU(14),core.ALo(15,"translate"),core.qZA()()(),core.TgZ(16,"div",6)(17,"div",7),core._UZ(18,"input",8),core.TgZ(19,"span",9)(20,"button",10),core._UZ(21,"i",11),core._uU(22),core.ALo(23,"translate"),core.qZA()()()(),core.TgZ(24,"div")(25,"button",12),core.NdJ("click",__name(function(){return ctx.clearFormAndResetResult()},"MembersListComponent_Template_button_click_25_listener")),core._uU(26),core.ALo(27,"translate"),core.qZA()()(),core.YNc(28,MembersListComponent_ds_pagination_28_Template,22,24,"ds-pagination",13),core.ALo(29,"async"),core.YNc(30,MembersListComponent_div_30_Template,3,3,"div",14),core.ALo(31,"async"),core.TgZ(32,"h4"),core._uU(33),core.ALo(34,"translate"),core.qZA(),core.YNc(35,MembersListComponent_ds_pagination_35_Template,22,24,"ds-pagination",13),core.ALo(36,"async"),core.YNc(37,MembersListComponent_div_37_Template,3,3,"div",14),core.ALo(38,"async"),core.ALo(39,"async"),core.BQk()),2&rf){let tmp_7_0,tmp_8_0,tmp_10_0,tmp_11_0;core.xp6(2),core.Oqu(core.lcZ(3,12,ctx.messagePrefix+".head")),core.xp6(3),core.hij("",core.lcZ(6,14,ctx.messagePrefix+".search.head")," "),core.xp6(2),core.Q6J("formGroup",ctx.searchForm),core.xp6(4),core.Oqu(core.lcZ(12,16,ctx.messagePrefix+".search.scope.metadata")),core.xp6(3),core.Oqu(core.lcZ(15,18,ctx.messagePrefix+".search.scope.email")),core.xp6(8),core.hij(" ",core.lcZ(23,20,ctx.messagePrefix+".search.button"),""),core.xp6(4),core.Oqu(core.lcZ(27,22,ctx.messagePrefix+".button.see-all")),core.xp6(2),core.Q6J("ngIf",(null==(tmp_7_0=core.lcZ(29,24,ctx.ePeopleSearchDtos))?null:tmp_7_0.totalElements)>0),core.xp6(2),core.Q6J("ngIf",0==(null==(tmp_8_0=core.lcZ(31,26,ctx.ePeopleSearchDtos))?null:tmp_8_0.totalElements)&&ctx.searchDone),core.xp6(3),core.Oqu(core.lcZ(34,28,ctx.messagePrefix+".headMembers")),core.xp6(2),core.Q6J("ngIf",(null==(tmp_10_0=core.lcZ(36,30,ctx.ePeopleMembersOfGroupDtos))?null:tmp_10_0.totalElements)>0),core.xp6(2),core.Q6J("ngIf",null==core.lcZ(38,32,ctx.ePeopleMembersOfGroupDtos)||0==(null==(tmp_11_0=core.lcZ(39,34,ctx.ePeopleMembersOfGroupDtos))?null:tmp_11_0.totalElements))}},"MembersListComponent_Template"),directives:[fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.sg,fesm2015_forms.EJ,fesm2015_forms.JJ,fesm2015_forms.u,fesm2015_forms.YN,fesm2015_forms.Kr,fesm2015_forms.Fj,common.O5,pagination_component.Q,common.sg,router.yS],pipes:[ngx_translate_core.X$,common.Ov],encapsulation:2});const subgroups_list_component_c0=__name(function(a0){return{name:a0}},"subgroups_list_component_c0");function SubgroupsListComponent_ds_pagination_20_tr_20_button_11_Template(rf,ctx){if(1&rf){const _r11=core.EpF();core.TgZ(0,"button",23),core.NdJ("click",__name(function(){core.CHM(_r11);const group_r5=core.oxw().$implicit;return core.oxw(2).deleteSubgroupFromGroup(group_r5)},"SubgroupsListComponent_ds_pagination_20_tr_20_button_11_Template_button_click_0_listener")),core.ALo(1,"translate"),core._UZ(2,"i",24),core.qZA()}if(2&rf){const group_r5=core.oxw().$implicit,ctx_r6=core.oxw(2);core.s9C("title",core.xi3(1,1,ctx_r6.messagePrefix+".table.edit.buttons.remove",core.VKq(4,subgroups_list_component_c0,group_r5.name)))}}function SubgroupsListComponent_ds_pagination_20_tr_20_p_14_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"p"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r7=core.oxw(3);core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r7.messagePrefix+".table.edit.currentGroup"))}}function SubgroupsListComponent_ds_pagination_20_tr_20_button_16_Template(rf,ctx){if(1&rf){const _r15=core.EpF();core.TgZ(0,"button",25),core.NdJ("click",__name(function(){core.CHM(_r15);const group_r5=core.oxw().$implicit;return core.oxw(2).addSubgroupToGroup(group_r5)},"SubgroupsListComponent_ds_pagination_20_tr_20_button_16_Template_button_click_0_listener")),core.ALo(1,"translate"),core._UZ(2,"i",26),core.qZA()}if(2&rf){const group_r5=core.oxw().$implicit,ctx_r8=core.oxw(2);core.s9C("title",core.xi3(1,1,ctx_r8.messagePrefix+".table.edit.buttons.add",core.VKq(4,subgroups_list_component_c0,group_r5.name)))}}__name(SubgroupsListComponent_ds_pagination_20_tr_20_button_11_Template,"SubgroupsListComponent_ds_pagination_20_tr_20_button_11_Template"),__name(SubgroupsListComponent_ds_pagination_20_tr_20_p_14_Template,"SubgroupsListComponent_ds_pagination_20_tr_20_p_14_Template"),__name(SubgroupsListComponent_ds_pagination_20_tr_20_button_16_Template,"SubgroupsListComponent_ds_pagination_20_tr_20_button_16_Template");const subgroups_list_component_c1=__name(function(a0){return[a0]},"subgroups_list_component_c1");function SubgroupsListComponent_ds_pagination_20_tr_20_Template(rf,ctx){if(1&rf){const _r18=core.EpF();core.TgZ(0,"tr")(1,"td",16),core._uU(2),core.qZA(),core.TgZ(3,"td",16)(4,"a",18),core.NdJ("click",__name(function(){const group_r5=core.CHM(_r18).$implicit;return core.oxw(2).groupDataService.startEditingNewGroup(group_r5)},"SubgroupsListComponent_ds_pagination_20_tr_20_Template_a_click_4_listener")),core._uU(5),core.qZA()(),core.TgZ(6,"td",16),core._uU(7),core.ALo(8,"async"),core.qZA(),core.TgZ(9,"td",16)(10,"div",19),core.YNc(11,SubgroupsListComponent_ds_pagination_20_tr_20_button_11_Template,3,6,"button",20),core.ALo(12,"async"),core.ALo(13,"async"),core.YNc(14,SubgroupsListComponent_ds_pagination_20_tr_20_p_14_Template,3,3,"p",21),core.ALo(15,"async"),core.YNc(16,SubgroupsListComponent_ds_pagination_20_tr_20_button_16_Template,3,6,"button",22),core.ALo(17,"async"),core.ALo(18,"async"),core.qZA()()()}if(2&rf){const group_r5=ctx.$implicit,ctx_r4=core.oxw(2);let tmp_3_0;core.xp6(2),core.Oqu(group_r5.id),core.xp6(2),core.Q6J("routerLink",core.VKq(19,subgroups_list_component_c1,ctx_r4.groupDataService.getGroupEditPageRouterLink(group_r5))),core.xp6(1),core.Oqu(group_r5.name),core.xp6(2),core.Oqu(null==(tmp_3_0=core.lcZ(8,7,group_r5.object))||null==tmp_3_0.payload?null:tmp_3_0.payload.name),core.xp6(4),core.Q6J("ngIf",core.lcZ(12,9,ctx_r4.isSubgroupOfGroup(group_r5))&&!core.lcZ(13,11,ctx_r4.isActiveGroup(group_r5))),core.xp6(3),core.Q6J("ngIf",core.lcZ(15,13,ctx_r4.isActiveGroup(group_r5))),core.xp6(2),core.Q6J("ngIf",!core.lcZ(17,15,ctx_r4.isSubgroupOfGroup(group_r5))&&!core.lcZ(18,17,ctx_r4.isActiveGroup(group_r5)))}}function SubgroupsListComponent_ds_pagination_20_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",12),core.ALo(1,"async"),core.ALo(2,"async"),core.TgZ(3,"div",13)(4,"table",14)(5,"thead")(6,"tr")(7,"th",15),core._uU(8),core.ALo(9,"translate"),core.qZA(),core.TgZ(10,"th",15),core._uU(11),core.ALo(12,"translate"),core.qZA(),core.TgZ(13,"th",15),core._uU(14),core.ALo(15,"translate"),core.qZA(),core.TgZ(16,"th",16),core._uU(17),core.ALo(18,"translate"),core.qZA()()(),core.TgZ(19,"tbody"),core.YNc(20,SubgroupsListComponent_ds_pagination_20_tr_20_Template,19,21,"tr",17),core.ALo(21,"async"),core.qZA()()()()),2&rf){const ctx_r0=core.oxw();let tmp_1_0,tmp_2_0,tmp_9_0;core.Q6J("paginationOptions",ctx_r0.configSearch)("pageInfoState",null==(tmp_1_0=core.lcZ(1,10,ctx_r0.searchResults$))?null:tmp_1_0.payload)("collectionSize",null==(tmp_2_0=core.lcZ(2,12,ctx_r0.searchResults$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(8),core.Oqu(core.lcZ(9,14,ctx_r0.messagePrefix+".table.id")),core.xp6(3),core.Oqu(core.lcZ(12,16,ctx_r0.messagePrefix+".table.name")),core.xp6(3),core.Oqu(core.lcZ(15,18,ctx_r0.messagePrefix+".table.collectionOrCommunity")),core.xp6(3),core.Oqu(core.lcZ(18,20,ctx_r0.messagePrefix+".table.edit")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_9_0=core.lcZ(21,22,ctx_r0.searchResults$))||null==tmp_9_0.payload?null:tmp_9_0.payload.page)}}function SubgroupsListComponent_div_22_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",27),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r1=core.oxw();core.xp6(1),core.hij(" ",core.lcZ(2,1,ctx_r1.messagePrefix+".no-items")," ")}}function SubgroupsListComponent_ds_pagination_27_tr_20_Template(rf,ctx){if(1&rf){const _r22=core.EpF();core.TgZ(0,"tr")(1,"td",16),core._uU(2),core.qZA(),core.TgZ(3,"td",16)(4,"a",18),core.NdJ("click",__name(function(){const group_r20=core.CHM(_r22).$implicit;return core.oxw(2).groupDataService.startEditingNewGroup(group_r20)},"SubgroupsListComponent_ds_pagination_27_tr_20_Template_a_click_4_listener")),core._uU(5),core.qZA()(),core.TgZ(6,"td",16),core._uU(7),core.ALo(8,"async"),core.qZA(),core.TgZ(9,"td",16)(10,"div",19)(11,"button",23),core.NdJ("click",__name(function(){const group_r20=core.CHM(_r22).$implicit;return core.oxw(2).deleteSubgroupFromGroup(group_r20)},"SubgroupsListComponent_ds_pagination_27_tr_20_Template_button_click_11_listener")),core.ALo(12,"translate"),core._UZ(13,"i",24),core.qZA()()()()}if(2&rf){const group_r20=ctx.$implicit,ctx_r19=core.oxw(2);let tmp_3_0;core.xp6(2),core.Oqu(group_r20.id),core.xp6(2),core.Q6J("routerLink",core.VKq(10,subgroups_list_component_c1,ctx_r19.groupDataService.getGroupEditPageRouterLink(group_r20))),core.xp6(1),core.Oqu(group_r20.name),core.xp6(2),core.Oqu(null==(tmp_3_0=core.lcZ(8,5,group_r20.object))||null==tmp_3_0.payload?null:tmp_3_0.payload.name),core.xp6(4),core.s9C("title",core.xi3(12,7,ctx_r19.messagePrefix+".table.edit.buttons.remove",core.VKq(12,subgroups_list_component_c0,group_r20.name)))}}function SubgroupsListComponent_ds_pagination_27_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",12),core.ALo(1,"async"),core.ALo(2,"async"),core.TgZ(3,"div",13)(4,"table",28)(5,"thead")(6,"tr")(7,"th",15),core._uU(8),core.ALo(9,"translate"),core.qZA(),core.TgZ(10,"th",15),core._uU(11),core.ALo(12,"translate"),core.qZA(),core.TgZ(13,"th",15),core._uU(14),core.ALo(15,"translate"),core.qZA(),core.TgZ(16,"th"),core._uU(17),core.ALo(18,"translate"),core.qZA()()(),core.TgZ(19,"tbody"),core.YNc(20,SubgroupsListComponent_ds_pagination_27_tr_20_Template,14,14,"tr",17),core.ALo(21,"async"),core.qZA()()()()),2&rf){const ctx_r2=core.oxw();let tmp_1_0,tmp_2_0,tmp_9_0;core.Q6J("paginationOptions",ctx_r2.config)("pageInfoState",null==(tmp_1_0=core.lcZ(1,10,ctx_r2.subGroups$))?null:tmp_1_0.payload)("collectionSize",null==(tmp_2_0=core.lcZ(2,12,ctx_r2.subGroups$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(8),core.Oqu(core.lcZ(9,14,ctx_r2.messagePrefix+".table.id")),core.xp6(3),core.Oqu(core.lcZ(12,16,ctx_r2.messagePrefix+".table.name")),core.xp6(3),core.Oqu(core.lcZ(15,18,ctx_r2.messagePrefix+".table.collectionOrCommunity")),core.xp6(3),core.Oqu(core.lcZ(18,20,ctx_r2.messagePrefix+".table.edit")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_9_0=core.lcZ(21,22,ctx_r2.subGroups$))||null==tmp_9_0.payload?null:tmp_9_0.payload.page)}}function SubgroupsListComponent_div_29_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",27),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r3=core.oxw();core.xp6(1),core.hij(" ",core.lcZ(2,1,ctx_r3.messagePrefix+".no-subgroups-yet")," ")}}var subgroups_list_component_SubKey;__name(SubgroupsListComponent_ds_pagination_20_tr_20_Template,"SubgroupsListComponent_ds_pagination_20_tr_20_Template"),__name(SubgroupsListComponent_ds_pagination_20_Template,"SubgroupsListComponent_ds_pagination_20_Template"),__name(SubgroupsListComponent_div_22_Template,"SubgroupsListComponent_div_22_Template"),__name(SubgroupsListComponent_ds_pagination_27_tr_20_Template,"SubgroupsListComponent_ds_pagination_27_tr_20_Template"),__name(SubgroupsListComponent_ds_pagination_27_Template,"SubgroupsListComponent_ds_pagination_27_Template"),__name(SubgroupsListComponent_div_29_Template,"SubgroupsListComponent_div_29_Template"),function(SubKey2){SubKey2[SubKey2.Members=0]="Members",SubKey2[SubKey2.ActiveGroup=1]="ActiveGroup",SubKey2[SubKey2.SearchResults=2]="SearchResults"}(subgroups_list_component_SubKey||(subgroups_list_component_SubKey={}));class SubgroupsListComponent{constructor(groupDataService,translateService,notificationsService,formBuilder,paginationService,router2){this.groupDataService=groupDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.formBuilder=formBuilder,this.paginationService=paginationService,this.router=router2,this.searchResults$=new cjs.BehaviorSubject(void 0),this.subGroups$=new cjs.BehaviorSubject(void 0),this.subs=new Map,this.configSearch=Object.assign(new pagination_component_options_model.r,{id:"ssgl",pageSize:5,currentPage:1}),this.config=Object.assign(new pagination_component_options_model.r,{id:"sgl",pageSize:5,currentPage:1}),this.currentSearchQuery=""}ngOnInit(){this.searchForm=this.formBuilder.group({query:""}),this.subs.set(subgroups_list_component_SubKey.ActiveGroup,this.groupDataService.getActiveGroup().subscribe(activeGroup=>{null!=activeGroup&&(this.groupBeingEdited=activeGroup,this.retrieveSubGroups())}))}retrieveSubGroups(){this.unsubFrom(subgroups_list_component_SubKey.Members),this.subs.set(subgroups_list_component_SubKey.Members,this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.wt)(config=>this.groupDataService.findListByHref(this.groupBeingEdited._links.subgroups.href,{currentPage:config.currentPage,elementsPerPage:config.pageSize},!0,!0,(0,follow_link_config_model.l)("object")))).subscribe(rd=>{this.subGroups$.next(rd)}))}isSubgroupOfGroup(possibleSubgroup){return this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1),(0,operators.zg)(activeGroup=>null!=activeGroup?activeGroup.uuid===possibleSubgroup.uuid?(0,cjs.of)(!1):this.groupDataService.findListByHref(activeGroup._links.subgroups.href,{currentPage:1,elementsPerPage:9999}).pipe((0,shared_operators.xw)(),(0,shared_operators.xe)(),(0,operators.UI)(listTotalGroups=>listTotalGroups.page.filter(groupInList=>groupInList.id===possibleSubgroup.id)),(0,operators.UI)(groups=>groups.length>0)):(0,cjs.of)(!1)))}isActiveGroup(group){return this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1),(0,operators.zg)(activeGroup=>null!=activeGroup&&activeGroup.uuid===group.uuid?(0,cjs.of)(!0):(0,cjs.of)(!1)))}deleteSubgroupFromGroup(subgroup){this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1)).subscribe(activeGroup=>{if(null!=activeGroup){const response=this.groupDataService.deleteSubGroupFromGroup(activeGroup,subgroup);this.showNotifications("deleteSubgroup",response,subgroup.name,activeGroup)}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}addSubgroupToGroup(subgroup){this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1)).subscribe(activeGroup=>{if(null!=activeGroup)if(activeGroup.uuid!==subgroup.uuid){const response=this.groupDataService.addSubGroupToGroup(activeGroup,subgroup);this.showNotifications("addSubgroup",response,subgroup.name,activeGroup)}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.subgroupToAddIsActiveGroup"));else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}search(data){const query=data.query;null!=query&&this.currentSearchQuery!==query&&(this.router.navigateByUrl(this.groupDataService.getGroupEditPageRouterLink(this.groupBeingEdited)),this.currentSearchQuery=query,this.configSearch.currentPage=1),this.searchDone=!0,this.unsubFrom(subgroups_list_component_SubKey.SearchResults),this.subs.set(subgroups_list_component_SubKey.SearchResults,this.paginationService.getCurrentPagination(this.configSearch.id,this.configSearch).pipe((0,operators.wt)(config=>this.groupDataService.searchGroups(this.currentSearchQuery,{currentPage:config.currentPage,elementsPerPage:config.pageSize},!0,!0,(0,follow_link_config_model.l)("object")))).subscribe(rd=>{this.searchResults$.next(rd)}))}unsubFrom(key){this.subs.has(key)&&(this.subs.get(key).unsubscribe(),this.subs.delete(key))}ngOnDestroy(){for(const key of this.subs.keys())this.unsubFrom(key);this.paginationService.clearPagination(this.config.id),this.paginationService.clearPagination(this.configSearch.id)}showNotifications(messageSuffix,response,nameObject,activeGroup){response.pipe((0,shared_operators.hC)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.success."+messageSuffix,{name:nameObject})),this.groupDataService.clearGroupLinkRequests(activeGroup._links.subgroups.href)):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure."+messageSuffix,{name:nameObject}))})}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}}function GroupFormComponent_div_3_Template(rf,ctx){1&rf&&core._UZ(0,"div")}function GroupFormComponent_ng_template_5_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h2",14),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r2=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r2.messagePrefix+".head.create"))}}function GroupFormComponent_ng_template_7_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h2",14),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r4=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r4.messagePrefix+".head.edit"))}}function GroupFormComponent_ds_alert_9_Template(rf,ctx){if(1&rf&&core._UZ(0,"ds-alert",15),2&rf){const ctx_r5=core.oxw();core.Q6J("type",ctx_r5.AlertTypeEnum.Warning)("content",ctx_r5.messagePrefix+".alert.permanent")}}__name(SubgroupsListComponent,"SubgroupsListComponent"),SubgroupsListComponent.\u0275fac=__name(function(t){return new(t||SubgroupsListComponent)(core.Y36(group_data_service.O),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(fesm2015_forms.qu),core.Y36(pagination_service.N),core.Y36(router.F0))},"SubgroupsListComponent_Factory"),SubgroupsListComponent.\u0275cmp=core.Xpm({type:SubgroupsListComponent,selectors:[["ds-subgroups-list"]],inputs:{messagePrefix:"messagePrefix"},decls:31,vars:28,consts:[[1,"border-bottom","pb-2"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],[1,"flex-grow-1","mr-3"],[1,"form-group","input-group","mr-3"],["type","text","name","query","id","query","formControlName","query","aria-label","Search input",1,"form-control"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary","float-right",3,"click"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groupsSearch",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[1,"align-middle"],[4,"ngFor","ngForOf"],[3,"routerLink","click"],[1,"btn-group","edit-field"],["class","btn btn-outline-danger btn-sm deleteButton",3,"title","click",4,"ngIf"],[4,"ngIf"],["class","btn btn-outline-primary btn-sm addButton",3,"title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm","deleteButton",3,"title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-primary","btn-sm","addButton",3,"title","click"],[1,"fas","fa-plus","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["id","subgroupsOfGroup",1,"table","table-striped","table-hover","table-bordered"]],template:__name(function(rf,ctx){if(1&rf&&(core.ynx(0),core.TgZ(1,"h3",0),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"h4",1),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.TgZ(7,"form",2),core.NdJ("ngSubmit",__name(function(){return ctx.search(ctx.searchForm.value)},"SubgroupsListComponent_Template_form_ngSubmit_7_listener")),core.TgZ(8,"div",3)(9,"div",4),core._UZ(10,"input",5),core.TgZ(11,"span",6)(12,"button",7),core._UZ(13,"i",8),core._uU(14),core.ALo(15,"translate"),core.qZA()()()(),core.TgZ(16,"div")(17,"button",9),core.NdJ("click",__name(function(){return ctx.clearFormAndResetResult()},"SubgroupsListComponent_Template_button_click_17_listener")),core._uU(18),core.ALo(19,"translate"),core.qZA()()(),core.YNc(20,SubgroupsListComponent_ds_pagination_20_Template,22,24,"ds-pagination",10),core.ALo(21,"async"),core.YNc(22,SubgroupsListComponent_div_22_Template,3,3,"div",11),core.ALo(23,"async"),core.TgZ(24,"h4"),core._uU(25),core.ALo(26,"translate"),core.qZA(),core.YNc(27,SubgroupsListComponent_ds_pagination_27_Template,22,24,"ds-pagination",10),core.ALo(28,"async"),core.YNc(29,SubgroupsListComponent_div_29_Template,3,3,"div",11),core.ALo(30,"async"),core.BQk()),2&rf){let tmp_5_0,tmp_6_0,tmp_8_0,tmp_9_0;core.xp6(2),core.Oqu(core.lcZ(3,10,ctx.messagePrefix+".head")),core.xp6(3),core.hij("",core.lcZ(6,12,ctx.messagePrefix+".search.head")," "),core.xp6(2),core.Q6J("formGroup",ctx.searchForm),core.xp6(7),core.hij(" ",core.lcZ(15,14,ctx.messagePrefix+".search.button")," "),core.xp6(4),core.hij(" ",core.lcZ(19,16,ctx.messagePrefix+".button.see-all")," "),core.xp6(2),core.Q6J("ngIf",(null==(tmp_5_0=core.lcZ(21,18,ctx.searchResults$))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements)>0),core.xp6(2),core.Q6J("ngIf",0==(null==(tmp_6_0=core.lcZ(23,20,ctx.searchResults$))||null==tmp_6_0.payload?null:tmp_6_0.payload.totalElements)&&ctx.searchDone),core.xp6(3),core.Oqu(core.lcZ(26,22,ctx.messagePrefix+".headSubgroups")),core.xp6(2),core.Q6J("ngIf",(null==(tmp_8_0=core.lcZ(28,24,ctx.subGroups$))||null==tmp_8_0.payload?null:tmp_8_0.payload.totalElements)>0),core.xp6(2),core.Q6J("ngIf",0==(null==(tmp_9_0=core.lcZ(30,26,ctx.subGroups$))||null==tmp_9_0.payload?null:tmp_9_0.payload.totalElements))}},"SubgroupsListComponent_Template"),directives:[fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.sg,fesm2015_forms.Fj,fesm2015_forms.JJ,fesm2015_forms.u,common.O5,pagination_component.Q,common.sg,router.yS],pipes:[ngx_translate_core.X$,common.Ov],encapsulation:2}),__name(GroupFormComponent_div_3_Template,"GroupFormComponent_div_3_Template"),__name(GroupFormComponent_ng_template_5_Template,"GroupFormComponent_ng_template_5_Template"),__name(GroupFormComponent_ng_template_7_Template,"GroupFormComponent_ng_template_7_Template"),__name(GroupFormComponent_ds_alert_9_Template,"GroupFormComponent_ds_alert_9_Template");const group_form_component_c0=__name(function(a0,a1,a2){return{name:a0,comcol:a1,comcolEditRolesRoute:a2}},"group_form_component_c0");function GroupFormComponent_ds_alert_10_Template(rf,ctx){if(1&rf&&(core._UZ(0,"ds-alert",15),core.ALo(1,"translate"),core.ALo(2,"async"),core.ALo(3,"async"),core.ALo(4,"async")),2&rf){const ctx_r6=core.oxw();let tmp_1_0;core.Q6J("type",ctx_r6.AlertTypeEnum.Warning)("content",core.xi3(1,2,ctx_r6.messagePrefix+".alert.workflowGroup",core.kEZ(11,group_form_component_c0,null==(tmp_1_0=core.lcZ(2,5,ctx_r6.getLinkedDSO(ctx_r6.groupBeingEdited)))||null==tmp_1_0.payload?null:tmp_1_0.payload.name,null==(tmp_1_0=core.lcZ(3,7,ctx_r6.getLinkedDSO(ctx_r6.groupBeingEdited)))||null==tmp_1_0.payload?null:tmp_1_0.payload.type,core.lcZ(4,9,ctx_r6.getLinkedEditRolesRoute(ctx_r6.groupBeingEdited)))))}}function GroupFormComponent_div_19_Template(rf,ctx){if(1&rf){const _r11=core.EpF();core.TgZ(0,"div",16)(1,"button",17),core.NdJ("click",__name(function(){return core.CHM(_r11),core.oxw().delete()},"GroupFormComponent_div_19_Template_button_click_1_listener")),core.ALo(2,"async"),core._UZ(3,"i",18),core._uU(4),core.ALo(5,"translate"),core.qZA()()}if(2&rf){const ctx_r7=core.oxw();core.xp6(1),core.Q6J("disabled",!core.lcZ(2,2,ctx_r7.canEdit$)||ctx_r7.groupBeingEdited.permanent),core.xp6(3),core.hij(" ",core.lcZ(5,4,ctx_r7.messagePrefix+".actions.delete")," ")}}function GroupFormComponent_ds_members_list_21_Template(rf,ctx){if(1&rf&&core._UZ(0,"ds-members-list",19),2&rf){const ctx_r8=core.oxw();core.Q6J("messagePrefix",ctx_r8.messagePrefix+".members-list")}}function GroupFormComponent_ds_subgroups_list_22_Template(rf,ctx){if(1&rf&&core._UZ(0,"ds-subgroups-list",19),2&rf){const ctx_r9=core.oxw();core.Q6J("messagePrefix",ctx_r9.messagePrefix+".subgroups-list")}}__name(GroupFormComponent_ds_alert_10_Template,"GroupFormComponent_ds_alert_10_Template"),__name(GroupFormComponent_div_19_Template,"GroupFormComponent_div_19_Template"),__name(GroupFormComponent_ds_members_list_21_Template,"GroupFormComponent_ds_members_list_21_Template"),__name(GroupFormComponent_ds_subgroups_list_22_Template,"GroupFormComponent_ds_subgroups_list_22_Template");class GroupFormComponent{constructor(groupDataService,ePersonDataService,dSpaceObjectDataService,formBuilderService,translateService,notificationsService,route,router2,authorizationService,modalService,requestService,changeDetectorRef){this.groupDataService=groupDataService,this.ePersonDataService=ePersonDataService,this.dSpaceObjectDataService=dSpaceObjectDataService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.notificationsService=notificationsService,this.route=route,this.router=router2,this.authorizationService=authorizationService,this.modalService=modalService,this.requestService=requestService,this.changeDetectorRef=changeDetectorRef,this.messagePrefix="admin.access-control.groups.form",this.formId="group-form",this.formLayout={groupName:{grid:{host:"row"}},groupDescription:{grid:{host:"row"}}},this.submitForm=new core.vpe,this.cancelForm=new core.vpe,this.subs=[],this.AlertTypeEnum=aletr_type.N}ngOnInit(){this.initialisePage()}initialisePage(){this.subs.push(this.route.params.subscribe(params=>{"newGroup"!==params.groupId&&this.setActiveGroup(params.groupId)})),this.canEdit$=this.groupDataService.getActiveGroup().pipe((0,empty_util.tz)(),(0,operators.wt)(group=>(0,cjs.combineLatest)(this.authorizationService.isAuthorized(feature_id.i.CanDelete,(0,empty_util.UE)(group)?group.self:void 0),this.hasLinkedDSO(group),(isAuthorized,hasLinkedDSO)=>isAuthorized&&!hasLinkedDSO))),(0,cjs.combineLatest)(this.translateService.get(`${this.messagePrefix}.groupName`),this.translateService.get(`${this.messagePrefix}.groupCommunity`),this.translateService.get(`${this.messagePrefix}.groupDescription`)).subscribe(([groupName,groupCommunity,groupDescription])=>{this.groupName=new fesm2015_core.b1u({id:"groupName",label:groupName,name:"groupName",validators:{required:null},required:!0}),this.groupCommunity=new fesm2015_core.b1u({id:"groupCommunity",label:groupCommunity,name:"groupCommunity",required:!1,readOnly:!0}),this.groupDescription=new fesm2015_core.HBf({id:"groupDescription",label:groupDescription,name:"groupDescription",required:!1}),this.formModel=[this.groupName,this.groupDescription],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.formGroup.controls.groupName&&(this.formGroup.controls.groupName.setAsyncValidators(ValidateGroupExists.createValidator(this.groupDataService)),this.groupNameValueChangeSubscribe=this.groupName.valueChanges.pipe((0,operators.bh)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()})),this.subs.push((0,cjs.combineLatest)(this.groupDataService.getActiveGroup(),this.canEdit$,this.groupDataService.getActiveGroup().pipe((0,operators.hX)(activeGroup=>(0,empty_util.Uh)(activeGroup)),(0,operators.wt)(activeGroup=>this.getLinkedDSO(activeGroup).pipe((0,shared_operators.Gp)())))).subscribe(([activeGroup,canEdit,linkedObject])=>{var _a;null!=activeGroup&&(this.formGroup.controls.groupName.clearAsyncValidators(),this.groupBeingEdited=activeGroup,(null==linkedObject?void 0:linkedObject.name)?(this.formBuilderService.insertFormGroupControl(1,this.formGroup,this.formModel,this.groupCommunity),this.formGroup.patchValue({groupName:activeGroup.name,groupCommunity:null!==(_a=null==linkedObject?void 0:linkedObject.name)&&void 0!==_a?_a:"",groupDescription:activeGroup.firstMetadataValue("dc.description")})):(this.formModel=[this.groupName,this.groupDescription],this.formGroup.patchValue({groupName:activeGroup.name,groupDescription:activeGroup.firstMetadataValue("dc.description")})),setTimeout(()=>{(!canEdit||activeGroup.permanent)&&this.formGroup.disable()},200))}))})}onCancel(){this.groupDataService.cancelEditGroup(),this.cancelForm.emit(),this.router.navigate([this.groupDataService.getGroupRegistryRouterLink()])}onSubmit(){this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1)).subscribe(group=>{const values={name:this.groupName.value,metadata:{"dc.description":[{value:this.groupDescription.value}]}};null===group?this.createNewGroup(values):this.editGroup(group)})}createNewGroup(values){const groupToCreate=Object.assign(new group_model.Z,values);this.groupDataService.create(groupToCreate).pipe((0,shared_operators.hC)()).subscribe(rd=>{if(rd.hasSucceeded){if(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.created.success",{name:groupToCreate.name})),this.submitForm.emit(groupToCreate),(0,empty_util.UE)(rd.payload)){const groupSelfLink=rd.payload._links.self.href;this.setActiveGroupWithLink(groupSelfLink),this.groupDataService.clearGroupsRequests(),this.router.navigateByUrl(this.groupDataService.getGroupEditPageRouterLinkWithID(rd.payload.uuid))}}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.created.failure",{name:groupToCreate.name})),this.showNotificationIfNameInUse(groupToCreate,"created"),this.cancelForm.emit()})}showNotificationIfNameInUse(group,notificationSection){this.subs.push(this.groupDataService.searchGroups(group.name,{currentPage:1,elementsPerPage:0}).pipe((0,shared_operators.xw)(),(0,shared_operators.xe)()).subscribe(list=>{list.totalElements>0&&this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification."+notificationSection+".failure.groupNameInUse",{name:group.name}))}))}editGroup(group){let operations=[];(0,empty_util.Uh)(this.groupDescription.value)&&(operations=[...operations,{op:"replace",path:"/metadata/dc.description/0/value",value:this.groupDescription.value}]),(0,empty_util.Uh)(this.groupName.value)&&(operations=[...operations,{op:"replace",path:"/name",value:this.groupName.value}]),this.groupDataService.patch(group,operations).pipe((0,shared_operators.hC)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.edited.success",{name:rd.payload.name})),this.submitForm.emit(rd.payload)):(this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.edited.failure",{name:group.name})),this.cancelForm.emit())})}setActiveGroup(groupId){this.groupDataService.cancelEditGroup(),this.groupDataService.findById(groupId).pipe((0,shared_operators.xw)(),(0,shared_operators.xe)()).subscribe(group=>{this.groupDataService.editGroup(group)})}setActiveGroupWithLink(groupSelfLink){this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1)).subscribe(activeGroup=>{null===activeGroup&&(this.groupDataService.cancelEditGroup(),this.groupDataService.findByHref(groupSelfLink,!1,!1,(0,follow_link_config_model.l)("subgroups"),(0,follow_link_config_model.l)("epersons"),(0,follow_link_config_model.l)("object")).pipe((0,shared_operators.xw)(),(0,shared_operators.xe)()).subscribe(group=>{this.groupDataService.editGroup(group)}))})}delete(){this.groupDataService.getActiveGroup().pipe((0,operators.qn)(1)).subscribe(group=>{const modalRef=this.modalService.open(confirmation_modal_component.Y);modalRef.componentInstance.dso=group,modalRef.componentInstance.headerLabel=this.messagePrefix+".delete-group.modal.header",modalRef.componentInstance.infoLabel=this.messagePrefix+".delete-group.modal.info",modalRef.componentInstance.cancelLabel=this.messagePrefix+".delete-group.modal.cancel",modalRef.componentInstance.confirmLabel=this.messagePrefix+".delete-group.modal.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.qn)(1)).subscribe(confirm=>{confirm&&(0,empty_util.Uh)(group.id)&&this.groupDataService.delete(group.id).pipe((0,shared_operators.hC)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.deleted.success",{name:group.name})),this.onCancel()):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.deleted.failure.title",{name:group.name}),this.translateService.get(this.messagePrefix+".notification.deleted.failure.content",{cause:rd.errorMessage}))})})})}ngOnDestroy(){this.groupDataService.cancelEditGroup(),this.subs.filter(sub=>(0,empty_util.Uh)(sub)).forEach(sub=>sub.unsubscribe()),(0,empty_util.Uh)(this.groupNameValueChangeSubscribe)&&this.groupNameValueChangeSubscribe.unsubscribe()}hasLinkedDSO(group){if((0,empty_util.Uh)(group)&&(0,empty_util.Uh)(group._links.object.href))return this.getLinkedDSO(group).pipe((0,operators.UI)(rd=>(0,empty_util.Uh)(rd)&&(0,empty_util.Uh)(rd.payload)),(0,operators.KQ)(()=>(0,cjs.of)(!1)))}getLinkedDSO(group){if((0,empty_util.Uh)(group)&&(0,empty_util.Uh)(group._links.object.href))return void 0===group.object?this.dSpaceObjectDataService.findByHref(group._links.object.href):group.object}getLinkedEditRolesRoute(group){if((0,empty_util.Uh)(group)&&(0,empty_util.Uh)(group._links.object.href))return this.getLinkedDSO(group).pipe((0,operators.UI)(rd=>{if((0,empty_util.Uh)(rd)&&(0,empty_util.Uh)(rd.payload))switch(rd.payload.type){case community_model.S.type.value:return(0,community_page_routing_paths.eq)(rd.payload.id);case collection_model.F.type.value:return(0,collection_page_routing_paths.Po)(rd.payload.id)}}))}}__name(GroupFormComponent,"GroupFormComponent"),GroupFormComponent.\u0275fac=__name(function(t){return new(t||GroupFormComponent)(core.Y36(group_data_service.O),core.Y36(eperson_data_service.k),core.Y36(dspace_object_data_service.D),core.Y36(form_builder_service.c),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(router.gz),core.Y36(router.F0),core.Y36(authorization_data_service._),core.Y36(ng_bootstrap.FF),core.Y36(request_service.s),core.Y36(core.sBO))},"GroupFormComponent_Factory"),GroupFormComponent.\u0275cmp=core.Xpm({type:GroupFormComponent,selectors:[["ds-group-form"]],hostBindings:__name(function(rf,ctx){1&rf&&core.NdJ("beforeunload",__name(function(){return ctx.ngOnDestroy()},"GroupFormComponent_beforeunload_HostBindingHandler"),!1,core.Jf7)},"GroupFormComponent_HostBindings"),outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},decls:23,vars:22,consts:[[1,"container"],[1,"group-form","row"],[1,"col-12"],[4,"ngIf","ngIfThen","ngIfElse"],["createHeader",""],["editheader",""],[3,"type","content",4,"ngIf"],[3,"formId","formModel","formGroup","formLayout","displayCancel","submitForm"],["before","",1,"btn-group"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["after","","class","btn-group",4,"ngIf"],[1,"mb-5"],[3,"messagePrefix",4,"ngIf"],[1,"border-bottom","pb-2"],[3,"type","content"],["after","",1,"btn-group"],[1,"btn","btn-danger","delete-button",3,"disabled","click"],[1,"fa","fa-trash"],[3,"messagePrefix"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2),core.YNc(3,GroupFormComponent_div_3_Template,1,0,"div",3),core.ALo(4,"async"),core.YNc(5,GroupFormComponent_ng_template_5_Template,3,3,"ng-template",null,4,core.W1O),core.YNc(7,GroupFormComponent_ng_template_7_Template,3,3,"ng-template",null,5,core.W1O),core.YNc(9,GroupFormComponent_ds_alert_9_Template,1,2,"ds-alert",6),core.YNc(10,GroupFormComponent_ds_alert_10_Template,5,15,"ds-alert",6),core.ALo(11,"async"),core.ALo(12,"async"),core.TgZ(13,"ds-form",7),core.NdJ("submitForm",__name(function(){return ctx.onSubmit()},"GroupFormComponent_Template_ds_form_submitForm_13_listener")),core.TgZ(14,"div",8)(15,"button",9),core.NdJ("click",__name(function(){return ctx.onCancel()},"GroupFormComponent_Template_button_click_15_listener")),core._UZ(16,"i",10),core._uU(17),core.ALo(18,"translate"),core.qZA()(),core.YNc(19,GroupFormComponent_div_19_Template,6,6,"div",11),core.qZA(),core.TgZ(20,"div",12),core.YNc(21,GroupFormComponent_ds_members_list_21_Template,1,1,"ds-members-list",13),core.qZA(),core.YNc(22,GroupFormComponent_ds_subgroups_list_22_Template,1,1,"ds-subgroups-list",13),core.qZA()()()),2&rf){const _r1=core.MAs(6),_r3=core.MAs(8);core.xp6(3),core.Q6J("ngIf",core.lcZ(4,14,ctx.groupDataService.getActiveGroup()))("ngIfThen",_r3)("ngIfElse",_r1),core.xp6(6),core.Q6J("ngIf",null==ctx.groupBeingEdited?null:ctx.groupBeingEdited.permanent),core.xp6(1),core.Q6J("ngIf",!core.lcZ(11,16,ctx.canEdit$)&&core.lcZ(12,18,ctx.groupDataService.getActiveGroup())),core.xp6(3),core.Q6J("formId",ctx.formId)("formModel",ctx.formModel)("formGroup",ctx.formGroup)("formLayout",ctx.formLayout)("displayCancel",!1),core.xp6(4),core.hij(" ",core.lcZ(18,20,ctx.messagePrefix+".return"),""),core.xp6(2),core.Q6J("ngIf",null!=ctx.groupBeingEdited),core.xp6(2),core.Q6J("ngIf",null!=ctx.groupBeingEdited),core.xp6(1),core.Q6J("ngIf",null!=ctx.groupBeingEdited)}},"GroupFormComponent_Template"),directives:[common.O5,alert_component.w,form_component.U,fesm2015_forms.JL,fesm2015_forms.sg,MembersListComponent,SubgroupsListComponent],pipes:[common.Ov,ngx_translate_core.X$],encapsulation:2});class GroupDtoModel{}__name(GroupDtoModel,"GroupDtoModel");var route_service=__webpack_require__(43685);function GroupsRegistryComponent_ds_themed_loading_31_Template(rf,ctx){1&rf&&core._UZ(0,"ds-themed-loading")}__name(GroupsRegistryComponent_ds_themed_loading_31_Template,"GroupsRegistryComponent_ds_themed_loading_31_Template");const groups_registry_component_c0=__name(function(a0){return{name:a0}},"groups_registry_component_c0");function GroupsRegistryComponent_ds_pagination_33_tr_22_button_13_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"button",30),core.ALo(1,"translate"),core._UZ(2,"i",31),core.qZA()),2&rf){const groupDto_r4=core.oxw().$implicit,ctx_r5=core.oxw(2);core.s9C("title",core.xi3(1,2,ctx_r5.messagePrefix+"table.edit.buttons.edit",core.VKq(5,groups_registry_component_c0,groupDto_r4.group.name))),core.Q6J("routerLink",ctx_r5.groupService.getGroupEditPageRouterLink(groupDto_r4.group))}}function GroupsRegistryComponent_ds_pagination_33_tr_22_button_14_Template(rf,ctx){1&rf&&(core.TgZ(0,"button",32),core.ALo(1,"translate"),core._UZ(2,"i",31),core.qZA()),2&rf&&core.Q6J("disabled",!0)("ngbTooltip",core.lcZ(1,2,"admin.access-control.epeople.table.edit.buttons.edit-disabled"))}function GroupsRegistryComponent_ds_pagination_33_tr_22_button_15_Template(rf,ctx){if(1&rf){const _r11=core.EpF();core.TgZ(0,"button",33),core.NdJ("click",__name(function(){core.CHM(_r11);const groupDto_r4=core.oxw().$implicit;return core.oxw(2).deleteGroup(groupDto_r4)},"GroupsRegistryComponent_ds_pagination_33_tr_22_button_15_Template_button_click_0_listener")),core.ALo(1,"translate"),core._UZ(2,"i",34),core.qZA()}if(2&rf){const groupDto_r4=core.oxw().$implicit,ctx_r7=core.oxw(2);core.s9C("title",core.xi3(1,1,ctx_r7.messagePrefix+"table.edit.buttons.remove",core.VKq(4,groups_registry_component_c0,groupDto_r4.group.name)))}}function GroupsRegistryComponent_ds_pagination_33_tr_22_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"tr")(1,"td"),core._uU(2),core.qZA(),core.TgZ(3,"td"),core._uU(4),core.qZA(),core.TgZ(5,"td"),core._uU(6),core.ALo(7,"async"),core.qZA(),core.TgZ(8,"td"),core._uU(9),core.qZA(),core.TgZ(10,"td")(11,"div",25),core.ynx(12,26),core.YNc(13,GroupsRegistryComponent_ds_pagination_33_tr_22_button_13_Template,3,7,"button",27),core.YNc(14,GroupsRegistryComponent_ds_pagination_33_tr_22_button_14_Template,3,4,"button",28),core.BQk(),core.YNc(15,GroupsRegistryComponent_ds_pagination_33_tr_22_button_15_Template,3,6,"button",29),core.qZA()()()),2&rf){const groupDto_r4=ctx.$implicit;let tmp_2_0;core.xp6(2),core.Oqu(groupDto_r4.group.id),core.xp6(2),core.Oqu(groupDto_r4.group.name),core.xp6(2),core.Oqu(null==(tmp_2_0=core.lcZ(7,8,groupDto_r4.group.object))||null==tmp_2_0.payload?null:tmp_2_0.payload.name),core.xp6(3),core.Oqu((null==groupDto_r4.epersons?null:groupDto_r4.epersons.totalElements)+(null==groupDto_r4.subgroups?null:groupDto_r4.subgroups.totalElements)),core.xp6(3),core.Q6J("ngSwitch",groupDto_r4.ableToEdit),core.xp6(1),core.Q6J("ngSwitchCase",!0),core.xp6(1),core.Q6J("ngSwitchCase",!1),core.xp6(1),core.Q6J("ngIf",!(null!=groupDto_r4.group&&groupDto_r4.group.permanent)&&groupDto_r4.ableToDelete)}}function GroupsRegistryComponent_ds_pagination_33_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",20),core.ALo(1,"async"),core.TgZ(2,"div",21)(3,"table",22)(4,"thead")(5,"tr")(6,"th",23),core._uU(7),core.ALo(8,"translate"),core.qZA(),core.TgZ(9,"th",23),core._uU(10),core.ALo(11,"translate"),core.qZA(),core.TgZ(12,"th",23),core._uU(13),core.ALo(14,"translate"),core.qZA(),core.TgZ(15,"th",23),core._uU(16),core.ALo(17,"translate"),core.qZA(),core.TgZ(18,"th"),core._uU(19),core.ALo(20,"translate"),core.qZA()()(),core.TgZ(21,"tbody"),core.YNc(22,GroupsRegistryComponent_ds_pagination_33_tr_22_Template,16,10,"tr",24),core.ALo(23,"async"),core.qZA()()()()),2&rf){const ctx_r1=core.oxw();let tmp_2_0,tmp_10_0;core.Q6J("paginationOptions",ctx_r1.config)("pageInfoState",ctx_r1.pageInfoState$)("collectionSize",null==(tmp_2_0=core.lcZ(1,11,ctx_r1.pageInfoState$))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(7),core.Oqu(core.lcZ(8,13,ctx_r1.messagePrefix+"table.id")),core.xp6(3),core.Oqu(core.lcZ(11,15,ctx_r1.messagePrefix+"table.name")),core.xp6(3),core.Oqu(core.lcZ(14,17,ctx_r1.messagePrefix+"table.collectionOrCommunity")),core.xp6(3),core.Oqu(core.lcZ(17,19,ctx_r1.messagePrefix+"table.members")),core.xp6(3),core.Oqu(core.lcZ(20,21,ctx_r1.messagePrefix+"table.edit")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_10_0=core.lcZ(23,23,ctx_r1.groupsDto$))?null:tmp_10_0.page)}}function GroupsRegistryComponent_div_36_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",35),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r2=core.oxw();core.xp6(1),core.hij(" ",core.lcZ(2,1,ctx_r2.messagePrefix+"no-items")," ")}}__name(GroupsRegistryComponent_ds_pagination_33_tr_22_button_13_Template,"GroupsRegistryComponent_ds_pagination_33_tr_22_button_13_Template"),__name(GroupsRegistryComponent_ds_pagination_33_tr_22_button_14_Template,"GroupsRegistryComponent_ds_pagination_33_tr_22_button_14_Template"),__name(GroupsRegistryComponent_ds_pagination_33_tr_22_button_15_Template,"GroupsRegistryComponent_ds_pagination_33_tr_22_button_15_Template"),__name(GroupsRegistryComponent_ds_pagination_33_tr_22_Template,"GroupsRegistryComponent_ds_pagination_33_tr_22_Template"),__name(GroupsRegistryComponent_ds_pagination_33_Template,"GroupsRegistryComponent_ds_pagination_33_Template"),__name(GroupsRegistryComponent_div_36_Template,"GroupsRegistryComponent_div_36_Template");const groups_registry_component_c1=__name(function(){return["newGroup"]},"groups_registry_component_c1");class GroupsRegistryComponent{constructor(groupService,ePersonDataService,dSpaceObjectDataService,translateService,notificationsService,formBuilder,routeService,router2,authorizationService,paginationService,requestService){this.groupService=groupService,this.ePersonDataService=ePersonDataService,this.dSpaceObjectDataService=dSpaceObjectDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.formBuilder=formBuilder,this.routeService=routeService,this.router=router2,this.authorizationService=authorizationService,this.paginationService=paginationService,this.requestService=requestService,this.messagePrefix="admin.access-control.groups.",this.config=Object.assign(new pagination_component_options_model.r,{id:"gl",pageSize:5,currentPage:1}),this.groupsDto$=new cjs.BehaviorSubject({}),this.deletedGroupsIds=[],this.pageInfoState$=new cjs.BehaviorSubject(void 0),this.loading$=new cjs.BehaviorSubject(!1),this.subs=[],this.currentSearchQuery="",this.searchForm=this.formBuilder.group({query:this.currentSearchQuery})}ngOnInit(){this.search({query:this.currentSearchQuery})}search(data){(0,empty_util.Uh)(this.searchSub)&&(this.searchSub.unsubscribe(),this.subs=this.subs.filter(sub=>sub!==this.searchSub)),this.searchSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.bw)(()=>this.loading$.next(!0)),(0,operators.wt)(paginationOptions=>{const query=data.query;return null!=query&&this.currentSearchQuery!==query&&(this.currentSearchQuery=query,this.paginationService.updateRouteWithUrl(this.config.id,[],{page:1})),this.groupService.searchGroups(this.currentSearchQuery.trim(),{currentPage:paginationOptions.currentPage,elementsPerPage:paginationOptions.pageSize},!0,!0,(0,follow_link_config_model.l)("object"))}),(0,shared_operators.g1)(),(0,shared_operators.xe)(),(0,operators.wt)(groups=>0===groups.page.length?(0,cjs.of)((0,paginated_list_model.b)(groups.pageInfo,[])):this.authorizationService.isAuthorized(feature_id.i.AdministratorOf).pipe((0,operators.wt)(isSiteAdmin=>(0,cjs.combineLatest)([...groups.page.map(group=>(0,empty_util.Uh)(group)&&!this.deletedGroupsIds.includes(group.id)?(0,cjs.combineLatest)([this.authorizationService.isAuthorized(feature_id.i.CanDelete,group.self),this.canManageGroup$(isSiteAdmin,group),this.hasLinkedDSO(group),this.getSubgroups(group),this.getMembers(group)]).pipe((0,operators.UI)(([canDelete,canManageGroup,hasLinkedDSO,subgroups,members])=>{const groupDtoModel=new GroupDtoModel;return groupDtoModel.ableToDelete=canDelete&&!hasLinkedDSO,groupDtoModel.ableToEdit=canManageGroup,groupDtoModel.group=group,groupDtoModel.subgroups=subgroups.payload,groupDtoModel.epersons=members.payload,groupDtoModel})):cjs.EMPTY)]).pipe((0,operators.dL)([]),(0,operators.UI)(dtos=>(0,paginated_list_model.b)(groups.pageInfo,dtos))))))).subscribe(value=>{this.groupsDto$.next(value),this.pageInfoState$.next(value.pageInfo),this.loading$.next(!1)}),this.subs.push(this.searchSub)}canManageGroup$(isSiteAdmin,group){return isSiteAdmin?(0,cjs.of)(!0):this.authorizationService.isAuthorized(feature_id.i.CanManageGroup,group.self)}deleteGroup(group){(0,empty_util.Uh)(group.group.id)&&this.groupService.delete(group.group.id).pipe((0,shared_operators.hC)()).subscribe(rd=>{rd.hasSucceeded?(this.deletedGroupsIds=[...this.deletedGroupsIds,group.group.id],this.notificationsService.success(this.translateService.get(this.messagePrefix+"notification.deleted.success",{name:group.group.name}))):this.notificationsService.error(this.translateService.get(this.messagePrefix+"notification.deleted.failure.title",{name:group.group.name}),this.translateService.get(this.messagePrefix+"notification.deleted.failure.content",{cause:rd.errorMessage}))})}getMembers(group){return this.ePersonDataService.findListByHref(group._links.epersons.href).pipe((0,shared_operators.xw)())}getSubgroups(group){return this.groupService.findListByHref(group._links.subgroups.href).pipe((0,shared_operators.xw)())}hasLinkedDSO(group){return this.dSpaceObjectDataService.findByHref(group._links.object.href).pipe((0,shared_operators.xw)(),(0,operators.UI)(rd=>(0,empty_util.Uh)(rd)&&(0,empty_util.Uh)(rd.payload)),(0,operators.KQ)(()=>(0,cjs.of)(!1)))}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){(0,empty_util.Uh)(this.paginationSub)&&this.paginationSub.unsubscribe(),this.subs.filter(sub=>(0,empty_util.Uh)(sub)).forEach(sub=>sub.unsubscribe()),this.paginationService.clearPagination(this.config.id)}}__name(GroupsRegistryComponent,"GroupsRegistryComponent"),GroupsRegistryComponent.\u0275fac=__name(function(t){return new(t||GroupsRegistryComponent)(core.Y36(group_data_service.O),core.Y36(eperson_data_service.k),core.Y36(dspace_object_data_service.D),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(fesm2015_forms.qu),core.Y36(route_service.MZ),core.Y36(router.F0),core.Y36(authorization_data_service._),core.Y36(pagination_service.N),core.Y36(request_service.s))},"GroupsRegistryComponent_Factory"),GroupsRegistryComponent.\u0275cmp=core.Xpm({type:GroupsRegistryComponent,selectors:[["ds-groups-registry"]],decls:38,vars:35,consts:[[1,"container"],[1,"groups-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"mr-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],[1,"flex-grow-1","mr-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary",3,"click"],[4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],[1,"btn-group","edit-field"],[3,"ngSwitch"],["class","btn btn-outline-primary btn-sm btn-edit",3,"routerLink","title",4,"ngSwitchCase"],["class","btn btn-outline-primary btn-sm btn-edit","placement","left",3,"disabled","ngbTooltip",4,"ngSwitchCase"],["class","btn btn-outline-danger btn-sm btn-delete",3,"title","click",4,"ngIf"],[1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],["placement","left",1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"disabled","ngbTooltip"],[1,"btn","btn-outline-danger","btn-sm","btn-delete",3,"title","click"],[1,"fas","fa-trash-alt","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.TgZ(7,"div")(8,"button",5),core._UZ(9,"i",6),core.TgZ(10,"span",7),core._uU(11),core.ALo(12,"translate"),core.qZA()()()(),core.TgZ(13,"h3",8),core._uU(14),core.ALo(15,"translate"),core.qZA(),core.TgZ(16,"form",9),core.NdJ("ngSubmit",__name(function(){return ctx.search(ctx.searchForm.value)},"GroupsRegistryComponent_Template_form_ngSubmit_16_listener")),core.TgZ(17,"div",10)(18,"div",11),core._UZ(19,"input",12),core.ALo(20,"translate"),core.ALo(21,"translate"),core.TgZ(22,"span",13)(23,"button",14),core._UZ(24,"i",15),core._uU(25),core.ALo(26,"translate"),core.qZA()()()(),core.TgZ(27,"div")(28,"button",16),core.NdJ("click",__name(function(){return ctx.clearFormAndResetResult()},"GroupsRegistryComponent_Template_button_click_28_listener")),core._uU(29),core.ALo(30,"translate"),core.qZA()()(),core.YNc(31,GroupsRegistryComponent_ds_themed_loading_31_Template,1,0,"ds-themed-loading",17),core.ALo(32,"async"),core.YNc(33,GroupsRegistryComponent_ds_pagination_33_Template,24,25,"ds-pagination",18),core.ALo(34,"async"),core.ALo(35,"async"),core.YNc(36,GroupsRegistryComponent_div_36_Template,3,3,"div",19),core.ALo(37,"async"),core.qZA()()()),2&rf){let tmp_10_0,tmp_11_0;core.xp6(5),core.Oqu(core.lcZ(6,12,ctx.messagePrefix+"head")),core.xp6(3),core.Q6J("routerLink",core.DdM(34,groups_registry_component_c1)),core.xp6(3),core.Oqu(core.lcZ(12,14,ctx.messagePrefix+"button.add")),core.xp6(3),core.Oqu(core.lcZ(15,16,ctx.messagePrefix+"search.head")),core.xp6(2),core.Q6J("formGroup",ctx.searchForm),core.xp6(3),core.Q6J("placeholder",core.lcZ(21,20,ctx.messagePrefix+"search.placeholder")),core.uIk("aria-label",core.lcZ(20,18,ctx.messagePrefix+"search.placeholder")),core.xp6(6),core.hij(" ",core.lcZ(26,22,ctx.messagePrefix+"search.button")," "),core.xp6(4),core.hij(" ",core.lcZ(30,24,ctx.messagePrefix+"button.see-all")," "),core.xp6(2),core.Q6J("ngIf",core.lcZ(32,26,ctx.loading$)),core.xp6(2),core.Q6J("ngIf",(null==(tmp_10_0=core.lcZ(34,28,ctx.pageInfoState$))?null:tmp_10_0.totalElements)>0&&!core.lcZ(35,30,ctx.loading$)),core.xp6(3),core.Q6J("ngIf",0==(null==(tmp_11_0=core.lcZ(37,32,ctx.pageInfoState$))?null:tmp_11_0.totalElements))}},"GroupsRegistryComponent_Template"),directives:[router.rH,fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.sg,fesm2015_forms.Fj,fesm2015_forms.JJ,fesm2015_forms.u,common.O5,themed_loading_component.Z,pagination_component.Q,common.sg,common.RF,common.n9,ng_bootstrap._L],pipes:[ngx_translate_core.X$,common.Ov],encapsulation:2});var access_control_routing_paths=__webpack_require__(12838),i18n_breadcrumb_resolver=__webpack_require__(64561),some_feature_authorization_guard=__webpack_require__(65913),hal_endpoint_service=__webpack_require__(19339);class GroupPageGuard extends some_feature_authorization_guard.I{constructor(halEndpointService,authorizationService,router2,authService){super(authorizationService,router2,authService),this.halEndpointService=halEndpointService,this.authorizationService=authorizationService,this.router=router2,this.authService=authService,this.groupsEndpoint="groups"}getFeatureIDs(route,state){return(0,cjs.of)([feature_id.i.CanManageGroup])}getObjectUrl(route,state){return this.halEndpointService.getEndpoint(this.groupsEndpoint).pipe((0,operators.UI)(groupsUrl=>{var _a;return`${groupsUrl}/${null===(_a=null==route?void 0:route.params)||void 0===_a?void 0:_a.groupId}`}))}}__name(GroupPageGuard,"GroupPageGuard"),GroupPageGuard.\u0275fac=__name(function(t){return new(t||GroupPageGuard)(core.LFG(hal_endpoint_service.q),core.LFG(authorization_data_service._),core.LFG(router.F0),core.LFG(auth_service.e8))},"GroupPageGuard_Factory"),GroupPageGuard.\u0275prov=core.Yz7({token:GroupPageGuard,factory:GroupPageGuard.\u0275fac,providedIn:"root"});var group_administrator_guard=__webpack_require__(41461),site_administrator_guard=__webpack_require__(2092);class AccessControlRoutingModule{}__name(AccessControlRoutingModule,"AccessControlRoutingModule"),AccessControlRoutingModule.\u0275fac=__name(function(t){return new(t||AccessControlRoutingModule)},"AccessControlRoutingModule_Factory"),AccessControlRoutingModule.\u0275mod=core.oAB({type:AccessControlRoutingModule}),AccessControlRoutingModule.\u0275inj=core.cJS({imports:[[router.Bz.forChild([{path:"epeople",component:EPeopleRegistryComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.t},data:{title:"admin.access-control.epeople.title",breadcrumbKey:"admin.access-control.epeople"},canActivate:[site_administrator_guard.X]},{path:access_control_routing_paths.CH,component:GroupsRegistryComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.t},data:{title:"admin.access-control.groups.title",breadcrumbKey:"admin.access-control.groups"},canActivate:[group_administrator_guard.E]},{path:`${access_control_routing_paths.CH}/newGroup`,component:GroupFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.t},data:{title:"admin.access-control.groups.title.addGroup",breadcrumbKey:"admin.access-control.groups.addGroup"},canActivate:[group_administrator_guard.E]},{path:`${access_control_routing_paths.CH}/:groupId`,component:GroupFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.t},data:{title:"admin.access-control.groups.title.singleGroup",breadcrumbKey:"admin.access-control.groups.singleGroup"},canActivate:[GroupPageGuard]}])]]});var form_module=__webpack_require__(48197);class AccessControlModule{}__name(AccessControlModule,"AccessControlModule"),AccessControlModule.\u0275fac=__name(function(t){return new(t||AccessControlModule)},"AccessControlModule_Factory"),AccessControlModule.\u0275mod=core.oAB({type:AccessControlModule}),AccessControlModule.\u0275inj=core.cJS({imports:[[common.ez,shared_module.m,router.Bz,AccessControlRoutingModule,form_module.e]]})},66109:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>BITSTREAMFORMATS_MODULE_PATH,e:()=>getBitstreamFormatsModuleRoute});var _core_url_combiner_url_combiner__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69810),_admin_routing_paths__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(71462);const BITSTREAMFORMATS_MODULE_PATH="bitstream-formats";function getBitstreamFormatsModuleRoute(){return new _core_url_combiner_url_combiner__WEBPACK_IMPORTED_MODULE_1__.R((0,_admin_routing_paths__WEBPACK_IMPORTED_MODULE_0__.T)(),BITSTREAMFORMATS_MODULE_PATH).toString()}__name(getBitstreamFormatsModuleRoute,"getBitstreamFormatsModuleRoute")},98917:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AdminRegistriesModule:()=>AdminRegistriesModule});var registry_service=__webpack_require__(88551),cjs=__webpack_require__(39942),pagination_component_options_model=__webpack_require__(98865),operators=__webpack_require__(5796),empty_util=__webpack_require__(25839),notifications_service=__webpack_require__(16228),find_list_options_model=__webpack_require__(30292);function toFindListOptions(pagination,original){return Object.assign(new find_list_options_model.R,original,{currentPage:pagination.currentPage,elementsPerPage:pagination.pageSize})}__name(toFindListOptions,"toFindListOptions");var shared_operators=__webpack_require__(63281),pagination_service=__webpack_require__(57854),core=__webpack_require__(70074),router=__webpack_require__(37895),ngx_translate_core=__webpack_require__(47241),fesm2015_core=__webpack_require__(65737),form_builder_service=__webpack_require__(24656),metadata_schema_model=__webpack_require__(42857),common=__webpack_require__(10210),form_component=__webpack_require__(61792),fesm2015_forms=__webpack_require__(45028);function MetadataSchemaFormComponent_div_0_Template(rf,ctx){1&rf&&core._UZ(0,"div")}function MetadataSchemaFormComponent_ng_template_2_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h4"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r2=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r2.messagePrefix+".create"))}}function MetadataSchemaFormComponent_ng_template_4_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h4"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r4=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r4.messagePrefix+".edit"))}}__name(MetadataSchemaFormComponent_div_0_Template,"MetadataSchemaFormComponent_div_0_Template"),__name(MetadataSchemaFormComponent_ng_template_2_Template,"MetadataSchemaFormComponent_ng_template_2_Template"),__name(MetadataSchemaFormComponent_ng_template_4_Template,"MetadataSchemaFormComponent_ng_template_4_Template");class MetadataSchemaFormComponent{constructor(registryService,formBuilderService,translateService){this.registryService=registryService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.formId="metadata-schema-form",this.messagePrefix="admin.registries.metadata.form",this.formLayout={name:{grid:{host:"col col-sm-6 d-inline-block"}},namespace:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new core.vpe}ngOnInit(){(0,cjs.combineLatest)(this.translateService.get(`${this.messagePrefix}.name`),this.translateService.get(`${this.messagePrefix}.namespace`)).subscribe(([name,namespace])=>{this.name=new fesm2015_core.b1u({id:"name",label:name,name:"name",validators:{required:null,pattern:"^[^ ,_]{1,32}$"},required:!0}),this.namespace=new fesm2015_core.b1u({id:"namespace",label:namespace,name:"namespace",validators:{required:null},required:!0}),this.formModel=[new fesm2015_core.S_O({id:"metadatadataschemagroup",group:[this.namespace,this.name]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.registryService.getActiveMetadataSchema().subscribe(schema=>{this.formGroup.patchValue({metadatadataschemagroup:{name:null!=schema?schema.prefix:"",namespace:null!=schema?schema.namespace:""}})})})}onCancel(){this.registryService.cancelEditMetadataSchema()}onSubmit(){this.registryService.clearMetadataSchemaRequests().subscribe(),this.registryService.getActiveMetadataSchema().pipe((0,operators.qn)(1)).subscribe(schema=>{const values={prefix:this.name.value,namespace:this.namespace.value};null==schema?this.registryService.createOrUpdateMetadataSchema(Object.assign(new metadata_schema_model.B,values)).subscribe(newSchema=>{this.submitForm.emit(newSchema)}):this.registryService.createOrUpdateMetadataSchema(Object.assign(new metadata_schema_model.B,schema,{id:schema.id,prefix:values.prefix?values.prefix:schema.prefix,namespace:values.namespace?values.namespace:schema.namespace})).subscribe(updatedSchema=>{this.submitForm.emit(updatedSchema)}),this.clearFields(),this.registryService.cancelEditMetadataSchema()})}clearFields(){this.formGroup.patchValue({metadatadataschemagroup:{prefix:"",namespace:""}})}ngOnDestroy(){this.onCancel()}}__name(MetadataSchemaFormComponent,"MetadataSchemaFormComponent"),MetadataSchemaFormComponent.\u0275fac=__name(function(t){return new(t||MetadataSchemaFormComponent)(core.Y36(registry_service.k),core.Y36(form_builder_service.c),core.Y36(ngx_translate_core.sK))},"MetadataSchemaFormComponent_Factory"),MetadataSchemaFormComponent.\u0275cmp=core.Xpm({type:MetadataSchemaFormComponent,selectors:[["ds-metadata-schema-form"]],outputs:{submitForm:"submitForm"},decls:7,vars:9,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["createHeader",""],["editheader",""],[3,"formId","formModel","formGroup","formLayout","cancel","submitForm"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,MetadataSchemaFormComponent_div_0_Template,1,0,"div",0),core.ALo(1,"async"),core.YNc(2,MetadataSchemaFormComponent_ng_template_2_Template,3,3,"ng-template",null,1,core.W1O),core.YNc(4,MetadataSchemaFormComponent_ng_template_4_Template,3,3,"ng-template",null,2,core.W1O),core.TgZ(6,"ds-form",3),core.NdJ("cancel",__name(function(){return ctx.onCancel()},"MetadataSchemaFormComponent_Template_ds_form_cancel_6_listener"))("submitForm",__name(function(){return ctx.onSubmit()},"MetadataSchemaFormComponent_Template_ds_form_submitForm_6_listener")),core.qZA()),2&rf){const _r1=core.MAs(3),_r3=core.MAs(5);core.Q6J("ngIf",core.lcZ(1,7,ctx.registryService.getActiveMetadataSchema()))("ngIfThen",_r3)("ngIfElse",_r1),core.xp6(6),core.Q6J("formId",ctx.formId)("formModel",ctx.formModel)("formGroup",ctx.formGroup)("formLayout",ctx.formLayout)}},"MetadataSchemaFormComponent_Template"),directives:[common.O5,form_component.U,fesm2015_forms.JL,fesm2015_forms.sg],pipes:[common.Ov,ngx_translate_core.X$],encapsulation:2});var pagination_component=__webpack_require__(99292);const _c0=__name(function(a0){return{"table-primary":a0}},"_c0"),_c1=__name(function(a0){return[a0]},"_c1");function MetadataRegistryComponent_ds_pagination_10_tr_17_Template(rf,ctx){if(1&rf){const _r6=core.EpF();core.TgZ(0,"tr",14),core.ALo(1,"async"),core.TgZ(2,"td")(3,"label")(4,"input",15),core.NdJ("change",__name(function($event){const schema_r4=core.CHM(_r6).$implicit;return core.oxw(2).selectMetadataSchema(schema_r4,$event)},"MetadataRegistryComponent_ds_pagination_10_tr_17_Template_input_change_4_listener")),core.ALo(5,"async"),core.qZA()()(),core.TgZ(6,"td",16),core.NdJ("click",__name(function(){const schema_r4=core.CHM(_r6).$implicit;return core.oxw(2).editSchema(schema_r4)},"MetadataRegistryComponent_ds_pagination_10_tr_17_Template_td_click_6_listener")),core.TgZ(7,"a",17),core._uU(8),core.qZA()(),core.TgZ(9,"td",16),core.NdJ("click",__name(function(){const schema_r4=core.CHM(_r6).$implicit;return core.oxw(2).editSchema(schema_r4)},"MetadataRegistryComponent_ds_pagination_10_tr_17_Template_td_click_9_listener")),core.TgZ(10,"a",17),core._uU(11),core.qZA()(),core.TgZ(12,"td",16),core.NdJ("click",__name(function(){const schema_r4=core.CHM(_r6).$implicit;return core.oxw(2).editSchema(schema_r4)},"MetadataRegistryComponent_ds_pagination_10_tr_17_Template_td_click_12_listener")),core.TgZ(13,"a",17),core._uU(14),core.qZA()()()}if(2&rf){const schema_r4=ctx.$implicit,ctx_r3=core.oxw(2);core.Q6J("ngClass",core.VKq(12,_c0,core.lcZ(1,8,ctx_r3.isActive(schema_r4)))),core.xp6(4),core.Q6J("checked",core.lcZ(5,10,ctx_r3.isSelected(schema_r4))),core.xp6(3),core.Q6J("routerLink",core.VKq(14,_c1,schema_r4.prefix)),core.xp6(1),core.Oqu(schema_r4.id),core.xp6(2),core.Q6J("routerLink",core.VKq(16,_c1,schema_r4.prefix)),core.xp6(1),core.Oqu(schema_r4.namespace),core.xp6(2),core.Q6J("routerLink",core.VKq(18,_c1,schema_r4.prefix)),core.xp6(1),core.Oqu(schema_r4.prefix)}}function MetadataRegistryComponent_ds_pagination_10_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",9),core.ALo(1,"async"),core.TgZ(2,"div",10)(3,"table",11)(4,"thead")(5,"tr"),core._UZ(6,"th",12),core.TgZ(7,"th",12),core._uU(8),core.ALo(9,"translate"),core.qZA(),core.TgZ(10,"th",12),core._uU(11),core.ALo(12,"translate"),core.qZA(),core.TgZ(13,"th",12),core._uU(14),core.ALo(15,"translate"),core.qZA()()(),core.TgZ(16,"tbody"),core.YNc(17,MetadataRegistryComponent_ds_pagination_10_tr_17_Template,15,20,"tr",13),core.ALo(18,"async"),core.qZA()()()()),2&rf){const ctx_r0=core.oxw();let tmp_1_0,tmp_7_0;core.Q6J("paginationOptions",ctx_r0.config)("collectionSize",null==(tmp_1_0=core.lcZ(1,8,ctx_r0.metadataSchemas))||null==tmp_1_0.payload?null:tmp_1_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(8),core.Oqu(core.lcZ(9,10,"admin.registries.metadata.schemas.table.id")),core.xp6(3),core.Oqu(core.lcZ(12,12,"admin.registries.metadata.schemas.table.namespace")),core.xp6(3),core.Oqu(core.lcZ(15,14,"admin.registries.metadata.schemas.table.name")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_7_0=core.lcZ(18,16,ctx_r0.metadataSchemas))||null==tmp_7_0.payload?null:tmp_7_0.payload.page)}}function MetadataRegistryComponent_div_12_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",18),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.registries.metadata.schemas.no-items")," "))}function MetadataRegistryComponent_button_15_Template(rf,ctx){if(1&rf){const _r11=core.EpF();core.TgZ(0,"button",19),core.NdJ("click",__name(function(){return core.CHM(_r11),core.oxw().deleteSchemas()},"MetadataRegistryComponent_button_15_Template_button_click_0_listener")),core._uU(1),core.ALo(2,"translate"),core.qZA()}2&rf&&(core.xp6(1),core.Oqu(core.lcZ(2,1,"admin.registries.metadata.schemas.table.delete")))}__name(MetadataRegistryComponent_ds_pagination_10_tr_17_Template,"MetadataRegistryComponent_ds_pagination_10_tr_17_Template"),__name(MetadataRegistryComponent_ds_pagination_10_Template,"MetadataRegistryComponent_ds_pagination_10_Template"),__name(MetadataRegistryComponent_div_12_Template,"MetadataRegistryComponent_div_12_Template"),__name(MetadataRegistryComponent_button_15_Template,"MetadataRegistryComponent_button_15_Template");class MetadataRegistryComponent{constructor(registryService,notificationsService,router2,paginationService,translateService){this.registryService=registryService,this.notificationsService=notificationsService,this.router=router2,this.paginationService=paginationService,this.translateService=translateService,this.config=Object.assign(new pagination_component_options_model.r,{id:"rm",pageSize:25}),this.needsUpdate$=new cjs.BehaviorSubject(!0),this.updateSchemas()}updateSchemas(){this.metadataSchemas=this.needsUpdate$.pipe((0,operators.hX)(update=>!0===update),(0,operators.wt)(()=>this.paginationService.getCurrentPagination(this.config.id,this.config)),(0,operators.wt)(currentPagination=>this.registryService.getMetadataSchemas(toFindListOptions(currentPagination))))}forceUpdateSchemas(){this.needsUpdate$.next(!0)}editSchema(schema){this.getActiveSchema().pipe((0,operators.qn)(1)).subscribe(activeSchema=>{schema===activeSchema?this.registryService.cancelEditMetadataSchema():this.registryService.editMetadataSchema(schema)})}isActive(schema){return this.getActiveSchema().pipe((0,operators.UI)(activeSchema=>schema===activeSchema))}getActiveSchema(){return this.registryService.getActiveMetadataSchema()}selectMetadataSchema(schema,event){event.target.checked?this.registryService.selectMetadataSchema(schema):this.registryService.deselectMetadataSchema(schema)}isSelected(schema){return this.registryService.getSelectedMetadataSchemas().pipe((0,operators.UI)(schemas=>null!=schemas.find(selectedSchema=>selectedSchema===schema)))}deleteSchemas(){this.registryService.getSelectedMetadataSchemas().pipe((0,operators.qn)(1)).subscribe(schemas=>{const tasks$=[];for(const schema of schemas)(0,empty_util.Uh)(schema.id)&&tasks$.push(this.registryService.deleteMetadataSchema(schema.id).pipe((0,shared_operators.hC)()));(0,cjs.zip)(...tasks$).subscribe(responses=>{const successResponses=responses.filter(response=>response.hasSucceeded),failedResponses=responses.filter(response=>response.hasFailed);successResponses.length>0&&this.showNotification(!0,successResponses.length),failedResponses.length>0&&this.showNotification(!1,failedResponses.length),this.registryService.deselectAllMetadataSchema(),this.registryService.cancelEditMetadataSchema()})})}showNotification(success,amount){const prefix="admin.registries.schema.notification",suffix=success?"success":"failure";(0,cjs.combineLatest)(this.translateService.get(`${prefix}.${suffix}`),this.translateService.get(`${prefix}.deleted.${suffix}`,{amount})).subscribe(([head,content])=>{success?this.notificationsService.success(head,content):this.notificationsService.error(head,content)})}ngOnDestroy(){this.paginationService.clearPagination(this.config.id)}}__name(MetadataRegistryComponent,"MetadataRegistryComponent"),MetadataRegistryComponent.\u0275fac=__name(function(t){return new(t||MetadataRegistryComponent)(core.Y36(registry_service.k),core.Y36(notifications_service.T),core.Y36(router.F0),core.Y36(pagination_service.N),core.Y36(ngx_translate_core.sK))},"MetadataRegistryComponent_Factory"),MetadataRegistryComponent.\u0275cmp=core.Xpm({type:MetadataRegistryComponent,selectors:[["ds-metadata-registry"]],decls:17,vars:15,consts:[[1,"container"],[1,"metadata-registry","row"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"submitForm"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],["type","submit","class","btn btn-danger float-right",3,"click",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","metadata-schemas",1,"table","table-striped","table-hover"],["scope","col"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["type","checkbox",3,"checked","change"],[1,"selectable-row",3,"click"],[3,"routerLink"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["type","submit",1,"btn","btn-danger","float-right",3,"click"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),core._uU(4),core.ALo(5,"translate"),core.qZA(),core.TgZ(6,"p",4),core._uU(7),core.ALo(8,"translate"),core.qZA(),core.TgZ(9,"ds-metadata-schema-form",5),core.NdJ("submitForm",__name(function(){return ctx.forceUpdateSchemas()},"MetadataRegistryComponent_Template_ds_metadata_schema_form_submitForm_9_listener")),core.qZA(),core.YNc(10,MetadataRegistryComponent_ds_pagination_10_Template,19,18,"ds-pagination",6),core.ALo(11,"async"),core.YNc(12,MetadataRegistryComponent_div_12_Template,3,3,"div",7),core.ALo(13,"async"),core.TgZ(14,"div"),core.YNc(15,MetadataRegistryComponent_button_15_Template,3,3,"button",8),core.ALo(16,"async"),core.qZA()()()()),2&rf){let tmp_2_0,tmp_3_0,tmp_4_0;core.xp6(4),core.Oqu(core.lcZ(5,5,"admin.registries.metadata.head")),core.xp6(3),core.Oqu(core.lcZ(8,7,"admin.registries.metadata.description")),core.xp6(3),core.Q6J("ngIf",(null==(tmp_2_0=core.lcZ(11,9,ctx.metadataSchemas))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)>0),core.xp6(2),core.Q6J("ngIf",0==(null==(tmp_3_0=core.lcZ(13,11,ctx.metadataSchemas))||null==tmp_3_0.payload?null:tmp_3_0.payload.totalElements)),core.xp6(3),core.Q6J("ngIf",(null==(tmp_4_0=core.lcZ(16,13,ctx.metadataSchemas))||null==tmp_4_0.payload||null==tmp_4_0.payload.page?null:tmp_4_0.payload.page.length)>0)}},"MetadataRegistryComponent_Template"),directives:[MetadataSchemaFormComponent,common.O5,pagination_component.Q,common.sg,common.mk,router.yS],pipes:[ngx_translate_core.X$,common.Ov],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}"]});var var_directive=__webpack_require__(41633),metadata_field_model=__webpack_require__(43674);function MetadataFieldFormComponent_div_0_Template(rf,ctx){1&rf&&core._UZ(0,"div")}function MetadataFieldFormComponent_ng_template_2_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h4"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r2=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r2.messagePrefix+".create"))}}function MetadataFieldFormComponent_ng_template_4_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h4"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf){const ctx_r4=core.oxw();core.xp6(1),core.Oqu(core.lcZ(2,1,ctx_r4.messagePrefix+".edit"))}}__name(MetadataFieldFormComponent_div_0_Template,"MetadataFieldFormComponent_div_0_Template"),__name(MetadataFieldFormComponent_ng_template_2_Template,"MetadataFieldFormComponent_ng_template_2_Template"),__name(MetadataFieldFormComponent_ng_template_4_Template,"MetadataFieldFormComponent_ng_template_4_Template");class MetadataFieldFormComponent{constructor(registryService,formBuilderService,translateService){this.registryService=registryService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.formId="metadata-field-form",this.messagePrefix="admin.registries.schema.form",this.formLayout={element:{grid:{host:"col col-sm-6 d-inline-block"}},qualifier:{grid:{host:"col col-sm-6 d-inline-block"}},scopeNote:{grid:{host:"col col-sm-12 d-inline-block"}}},this.submitForm=new core.vpe}ngOnInit(){(0,cjs.combineLatest)(this.translateService.get(`${this.messagePrefix}.element`),this.translateService.get(`${this.messagePrefix}.qualifier`),this.translateService.get(`${this.messagePrefix}.scopenote`)).subscribe(([element,qualifier,scopenote])=>{this.element=new fesm2015_core.b1u({id:"element",label:element,name:"element",validators:{required:null},required:!0}),this.qualifier=new fesm2015_core.b1u({id:"qualifier",label:qualifier,name:"qualifier",required:!1}),this.scopeNote=new fesm2015_core.b1u({id:"scopeNote",label:scopenote,name:"scopeNote",required:!1}),this.formModel=[new fesm2015_core.S_O({id:"metadatadatafieldgroup",group:[this.element,this.qualifier,this.scopeNote]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.registryService.getActiveMetadataField().subscribe(field=>{this.formGroup.patchValue({metadatadatafieldgroup:{element:null!=field?field.element:"",qualifier:null!=field?field.qualifier:"",scopeNote:null!=field?field.scopeNote:""}})})})}onCancel(){this.registryService.cancelEditMetadataField()}onSubmit(){this.registryService.getActiveMetadataField().pipe((0,operators.qn)(1)).subscribe(field=>{const values={element:this.element.value,qualifier:this.qualifier.value,scopeNote:this.scopeNote.value};null==field?this.registryService.createMetadataField(Object.assign(new metadata_field_model.b,values),this.metadataSchema).subscribe(newField=>{this.submitForm.emit(newField)}):this.registryService.updateMetadataField(Object.assign(new metadata_field_model.b,field,{id:field.id,element:values.element?values.element:field.element,qualifier:values.qualifier?values.qualifier:field.qualifier,scopeNote:values.scopeNote?values.scopeNote:field.scopeNote})).subscribe(updatedField=>{this.submitForm.emit(updatedField)}),this.clearFields(),this.registryService.cancelEditMetadataField()})}clearFields(){this.formGroup.patchValue({metadatadatafieldgroup:{element:"",qualifier:"",scopeNote:""}})}ngOnDestroy(){this.onCancel()}}function MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_label_8_Template(rf,ctx){1&rf&&(core.TgZ(0,"label"),core._uU(1,"."),core.qZA())}__name(MetadataFieldFormComponent,"MetadataFieldFormComponent"),MetadataFieldFormComponent.\u0275fac=__name(function(t){return new(t||MetadataFieldFormComponent)(core.Y36(registry_service.k),core.Y36(form_builder_service.c),core.Y36(ngx_translate_core.sK))},"MetadataFieldFormComponent_Factory"),MetadataFieldFormComponent.\u0275cmp=core.Xpm({type:MetadataFieldFormComponent,selectors:[["ds-metadata-field-form"]],inputs:{metadataSchema:"metadataSchema"},outputs:{submitForm:"submitForm"},decls:7,vars:9,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["createHeader",""],["editheader",""],[3,"formId","formModel","formLayout","formGroup","cancel","submit"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,MetadataFieldFormComponent_div_0_Template,1,0,"div",0),core.ALo(1,"async"),core.YNc(2,MetadataFieldFormComponent_ng_template_2_Template,3,3,"ng-template",null,1,core.W1O),core.YNc(4,MetadataFieldFormComponent_ng_template_4_Template,3,3,"ng-template",null,2,core.W1O),core.TgZ(6,"ds-form",3),core.NdJ("cancel",__name(function(){return ctx.onCancel()},"MetadataFieldFormComponent_Template_ds_form_cancel_6_listener"))("submit",__name(function(){return ctx.onSubmit()},"MetadataFieldFormComponent_Template_ds_form_submit_6_listener")),core.qZA()),2&rf){const _r1=core.MAs(3),_r3=core.MAs(5);core.Q6J("ngIf",core.lcZ(1,7,ctx.registryService.getActiveMetadataField()))("ngIfThen",_r3)("ngIfElse",_r1),core.xp6(6),core.Q6J("formId",ctx.formId)("formModel",ctx.formModel)("formLayout",ctx.formLayout)("formGroup",ctx.formGroup)}},"MetadataFieldFormComponent_Template"),directives:[common.O5,form_component.U,fesm2015_forms.JL,fesm2015_forms.sg],pipes:[common.Ov,ngx_translate_core.X$],encapsulation:2}),__name(MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_label_8_Template,"MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_label_8_Template");const metadata_schema_component_c0=__name(function(a0){return{"table-primary":a0}},"metadata_schema_component_c0");function MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_Template(rf,ctx){if(1&rf){const _r11=core.EpF();core.TgZ(0,"tr",17),core.ALo(1,"async"),core.TgZ(2,"td")(3,"label")(4,"input",18),core.NdJ("change",__name(function($event){const field_r8=core.CHM(_r11).$implicit;return core.oxw(4).selectMetadataField(field_r8,$event)},"MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_Template_input_change_4_listener")),core.ALo(5,"async"),core.qZA()()(),core.TgZ(6,"td",19),core.NdJ("click",__name(function(){const field_r8=core.CHM(_r11).$implicit;return core.oxw(4).editField(field_r8)},"MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_Template_td_click_6_listener")),core._uU(7),core.YNc(8,MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_label_8_Template,2,0,"label",20),core._uU(9),core.qZA(),core.TgZ(10,"td",19),core.NdJ("click",__name(function(){const field_r8=core.CHM(_r11).$implicit;return core.oxw(4).editField(field_r8)},"MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_Template_td_click_10_listener")),core._uU(11),core.qZA()()}if(2&rf){const field_r8=ctx.$implicit,schema_r1=core.oxw(3).ngVar,ctx_r7=core.oxw();core.Q6J("ngClass",core.VKq(11,metadata_schema_component_c0,core.lcZ(1,7,ctx_r7.isActive(field_r8)))),core.xp6(4),core.Q6J("checked",core.lcZ(5,9,ctx_r7.isSelected(field_r8))),core.xp6(3),core.AsE("",null==schema_r1?null:schema_r1.prefix,".",field_r8.element,""),core.xp6(1),core.Q6J("ngIf",field_r8.qualifier),core.xp6(1),core.Oqu(field_r8.qualifier),core.xp6(2),core.Oqu(field_r8.scopeNote)}}function MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",12)(1,"div",13)(2,"table",14)(3,"thead")(4,"tr"),core._UZ(5,"th"),core.TgZ(6,"th",15),core._uU(7),core.ALo(8,"translate"),core.qZA(),core.TgZ(9,"th",15),core._uU(10),core.ALo(11,"translate"),core.qZA()()(),core.TgZ(12,"tbody"),core.YNc(13,MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_Template,12,13,"tr",16),core.qZA()()()()),2&rf){const fields_r3=core.oxw().ngVar,ctx_r4=core.oxw(2);core.Q6J("paginationOptions",ctx_r4.config)("pageInfoState",fields_r3)("collectionSize",null==fields_r3?null:fields_r3.totalElements)("hideGear",!1)("hidePagerWhenSinglePage",!0),core.xp6(7),core.Oqu(core.lcZ(8,8,"admin.registries.schema.fields.table.field")),core.xp6(3),core.Oqu(core.lcZ(11,10,"admin.registries.schema.fields.table.scopenote")),core.xp6(3),core.Q6J("ngForOf",null==fields_r3?null:fields_r3.page)}}function MetadataSchemaComponent_div_2_ng_container_11_div_2_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",21),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.registries.schema.fields.no-items")," "))}function MetadataSchemaComponent_div_2_ng_container_11_button_7_Template(rf,ctx){if(1&rf){const _r17=core.EpF();core.TgZ(0,"button",22),core.NdJ("click",__name(function(){return core.CHM(_r17),core.oxw(3).deleteFields()},"MetadataSchemaComponent_div_2_ng_container_11_button_7_Template_button_click_0_listener")),core._uU(1),core.ALo(2,"translate"),core.qZA()}2&rf&&(core.xp6(1),core.Oqu(core.lcZ(2,1,"admin.registries.schema.fields.table.delete")))}__name(MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_Template,"MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_tr_13_Template"),__name(MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_Template,"MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_Template"),__name(MetadataSchemaComponent_div_2_ng_container_11_div_2_Template,"MetadataSchemaComponent_div_2_ng_container_11_div_2_Template"),__name(MetadataSchemaComponent_div_2_ng_container_11_button_7_Template,"MetadataSchemaComponent_div_2_ng_container_11_button_7_Template");const metadata_schema_component_c1=__name(function(){return["/admin/registries/metadata"]},"metadata_schema_component_c1");function MetadataSchemaComponent_div_2_ng_container_11_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.YNc(1,MetadataSchemaComponent_div_2_ng_container_11_ds_pagination_1_Template,14,12,"ds-pagination",8),core.YNc(2,MetadataSchemaComponent_div_2_ng_container_11_div_2_Template,3,3,"div",9),core.TgZ(3,"div")(4,"button",10),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.YNc(7,MetadataSchemaComponent_div_2_ng_container_11_button_7_Template,3,3,"button",11),core.qZA(),core.BQk()),2&rf){const fields_r3=ctx.ngVar;core.xp6(1),core.Q6J("ngIf",(null==fields_r3?null:fields_r3.totalElements)>0),core.xp6(1),core.Q6J("ngIf",0==(null==fields_r3?null:fields_r3.totalElements)),core.xp6(2),core.Q6J("routerLink",core.DdM(7,metadata_schema_component_c1)),core.xp6(1),core.Oqu(core.lcZ(6,5,"admin.registries.schema.return")),core.xp6(2),core.Q6J("ngIf",(null==fields_r3||null==fields_r3.page?null:fields_r3.page.length)>0)}}__name(MetadataSchemaComponent_div_2_ng_container_11_Template,"MetadataSchemaComponent_div_2_ng_container_11_Template");const _c2=__name(function(a0){return{namespace:a0}},"_c2");function MetadataSchemaComponent_div_2_Template(rf,ctx){if(1&rf){const _r19=core.EpF();core.TgZ(0,"div",3)(1,"h2",4),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"p",5),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.TgZ(7,"ds-metadata-field-form",6),core.NdJ("submitForm",__name(function(){return core.CHM(_r19),core.oxw().forceUpdateFields()},"MetadataSchemaComponent_div_2_Template_ds_metadata_field_form_submitForm_7_listener")),core.qZA(),core.TgZ(8,"h3"),core._uU(9),core.ALo(10,"translate"),core.qZA(),core.YNc(11,MetadataSchemaComponent_div_2_ng_container_11_Template,8,8,"ng-container",7),core.ALo(12,"async"),core.qZA()}if(2&rf){const schema_r1=ctx.ngVar,ctx_r0=core.oxw();let tmp_4_0;core.xp6(2),core.AsE("",core.lcZ(3,6,"admin.registries.schema.head"),': "',null==schema_r1?null:schema_r1.prefix,'"'),core.xp6(3),core.Oqu(core.xi3(6,8,"admin.registries.schema.description",core.VKq(15,_c2,null==schema_r1?null:schema_r1.namespace))),core.xp6(2),core.Q6J("metadataSchema",schema_r1),core.xp6(2),core.Oqu(core.lcZ(10,11,"admin.registries.schema.fields.head")),core.xp6(2),core.Q6J("ngVar",null==(tmp_4_0=core.lcZ(12,13,ctx_r0.metadataFields$))?null:tmp_4_0.payload)}}__name(MetadataSchemaComponent_div_2_Template,"MetadataSchemaComponent_div_2_Template");class MetadataSchemaComponent{constructor(registryService,route,notificationsService,router2,paginationService,translateService){this.registryService=registryService,this.route=route,this.notificationsService=notificationsService,this.router=router2,this.paginationService=paginationService,this.translateService=translateService,this.config=Object.assign(new pagination_component_options_model.r,{id:"rm",pageSize:25,pageSizeOptions:[25,50,100,200]}),this.needsUpdate$=new cjs.BehaviorSubject(!0)}ngOnInit(){this.route.params.subscribe(params=>{this.initialize(params)})}initialize(params){this.metadataSchema$=this.registryService.getMetadataSchemaByPrefix(params.schemaName).pipe((0,shared_operators.Gp)()),this.updateFields()}updateFields(){this.metadataFields$=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.wt)(currentPagination=>(0,cjs.combineLatest)(this.metadataSchema$,this.needsUpdate$,(0,cjs.of)(currentPagination))),(0,operators.wt)(([schema,update,currentPagination])=>(update&&this.needsUpdate$.next(!1),this.registryService.getMetadataFieldsBySchema(schema,toFindListOptions(currentPagination),!update,!0))))}forceUpdateFields(){this.registryService.clearMetadataFieldRequests(),this.needsUpdate$.next(!0)}editField(field){this.getActiveField().pipe((0,operators.qn)(1)).subscribe(activeField=>{field===activeField?this.registryService.cancelEditMetadataField():this.registryService.editMetadataField(field)})}isActive(field){return this.getActiveField().pipe((0,operators.UI)(activeField=>field===activeField))}getActiveField(){return this.registryService.getActiveMetadataField()}selectMetadataField(field,event){event.target.checked?this.registryService.selectMetadataField(field):this.registryService.deselectMetadataField(field)}isSelected(field){return this.registryService.getSelectedMetadataFields().pipe((0,operators.UI)(fields=>null!=fields.find(selectedField=>selectedField===field)))}deleteFields(){this.registryService.getSelectedMetadataFields().pipe((0,operators.qn)(1)).subscribe(fields=>{const tasks$=[];for(const field of fields)(0,empty_util.Uh)(field.id)&&tasks$.push(this.registryService.deleteMetadataField(field.id).pipe((0,shared_operators.hC)()));(0,cjs.zip)(...tasks$).subscribe(responses=>{const successResponses=responses.filter(response=>response.hasSucceeded),failedResponses=responses.filter(response=>response.hasFailed);successResponses.length>0&&this.showNotification(!0,successResponses.length),failedResponses.length>0&&this.showNotification(!1,failedResponses.length),this.registryService.deselectAllMetadataField(),this.registryService.cancelEditMetadataField()})})}showNotification(success,amount){const prefix="admin.registries.schema.notification",suffix=success?"success":"failure";(0,cjs.combineLatest)(this.translateService.get(`${prefix}.${suffix}`),this.translateService.get(`${prefix}.field.deleted.${suffix}`,{amount})).subscribe(([head,content])=>{success?this.notificationsService.success(head,content):this.notificationsService.error(head,content)})}ngOnDestroy(){this.paginationService.clearPagination(this.config.id)}}__name(MetadataSchemaComponent,"MetadataSchemaComponent"),MetadataSchemaComponent.\u0275fac=__name(function(t){return new(t||MetadataSchemaComponent)(core.Y36(registry_service.k),core.Y36(router.gz),core.Y36(notifications_service.T),core.Y36(router.F0),core.Y36(pagination_service.N),core.Y36(ngx_translate_core.sK))},"MetadataSchemaComponent_Factory"),MetadataSchemaComponent.\u0275cmp=core.Xpm({type:MetadataSchemaComponent,selectors:[["ds-metadata-schema"]],decls:4,vars:3,consts:[[1,"container"],[1,"metadata-schema","row"],["class","col-12",4,"ngVar"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"metadataSchema","submitForm"],[4,"ngVar"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[1,"btn","btn-primary",3,"routerLink"],["type","submit","class","btn btn-danger float-right",3,"click",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","metadata-fields",1,"table","table-striped","table-hover"],["scope","col"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["type","checkbox",3,"checked","change"],[1,"selectable-row",3,"click"],[4,"ngIf"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["type","submit",1,"btn","btn-danger","float-right",3,"click"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"div",1),core.YNc(2,MetadataSchemaComponent_div_2_Template,13,17,"div",2),core.ALo(3,"async"),core.qZA()()),2&rf&&(core.xp6(2),core.Q6J("ngVar",core.lcZ(3,1,ctx.metadataSchema$)))},"MetadataSchemaComponent_Template"),directives:[var_directive.g,MetadataFieldFormComponent,common.O5,pagination_component.Q,common.sg,common.mk,router.rH],pipes:[common.Ov,ngx_translate_core.X$],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}"]});var i18n_breadcrumb_resolver=__webpack_require__(64561),admin_registries_routing_paths=__webpack_require__(66109);class AdminRegistriesRoutingModule{}__name(AdminRegistriesRoutingModule,"AdminRegistriesRoutingModule"),AdminRegistriesRoutingModule.\u0275fac=__name(function(t){return new(t||AdminRegistriesRoutingModule)},"AdminRegistriesRoutingModule_Factory"),AdminRegistriesRoutingModule.\u0275mod=core.oAB({type:AdminRegistriesRoutingModule}),AdminRegistriesRoutingModule.\u0275inj=core.cJS({imports:[[router.Bz.forChild([{path:"metadata",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},data:{title:"admin.registries.metadata.title",breadcrumbKey:"admin.registries.metadata"},children:[{path:"",component:MetadataRegistryComponent},{path:":schemaName",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},component:MetadataSchemaComponent,data:{title:"admin.registries.schema.title",breadcrumbKey:"admin.registries.schema"}}]},{path:admin_registries_routing_paths.T,resolve:{breadcrumb:i18n_breadcrumb_resolver.t},loadChildren:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,24562)).then(m=>m.BitstreamFormatsModule),data:{title:"admin.registries.bitstream-formats.title",breadcrumbKey:"admin.registries.bitstream-formats"}}])]]});var shared_module=__webpack_require__(66004),bitstream_formats_module=__webpack_require__(24562),form_module=__webpack_require__(48197);class AdminRegistriesModule{}__name(AdminRegistriesModule,"AdminRegistriesModule"),AdminRegistriesModule.\u0275fac=__name(function(t){return new(t||AdminRegistriesModule)},"AdminRegistriesModule_Factory"),AdminRegistriesModule.\u0275mod=core.oAB({type:AdminRegistriesModule}),AdminRegistriesModule.\u0275inj=core.cJS({imports:[[common.ez,shared_module.m,router.Bz,bitstream_formats_module.BitstreamFormatsModule,AdminRegistriesRoutingModule,form_module.e]]})},24562:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BitstreamFormatsModule:()=>BitstreamFormatsModule});var common=__webpack_require__(10210),router=__webpack_require__(37895),shared_module=__webpack_require__(66004),bitstream_format_data_service=__webpack_require__(65820),operators=__webpack_require__(63281),core=__webpack_require__(70074);class BitstreamFormatsResolver{constructor(bitstreamFormatDataService){this.bitstreamFormatDataService=bitstreamFormatDataService}resolve(route,state){return this.bitstreamFormatDataService.findById(route.params.id).pipe((0,operators.hC)())}}__name(BitstreamFormatsResolver,"BitstreamFormatsResolver"),BitstreamFormatsResolver.\u0275fac=__name(function(t){return new(t||BitstreamFormatsResolver)(core.LFG(bitstream_format_data_service.O))},"BitstreamFormatsResolver_Factory"),BitstreamFormatsResolver.\u0275prov=core.Yz7({token:BitstreamFormatsResolver,factory:BitstreamFormatsResolver.\u0275fac});var cjs_operators=__webpack_require__(5796),notifications_service=__webpack_require__(16228),admin_registries_routing_paths=__webpack_require__(66109),ngx_translate_core=__webpack_require__(47241),bitstream_format_model=__webpack_require__(25818),bitstream_format_support_level=__webpack_require__(43963),fesm2015_core=__webpack_require__(65737),empty_util=__webpack_require__(25839),form_component=__webpack_require__(61792);function FormatFormComponent_ds_form_0_Template(rf,ctx){if(1&rf){const _r2=core.EpF();core.TgZ(0,"ds-form",1),core.NdJ("submitForm",__name(function(){return core.CHM(_r2),core.oxw().onSubmit()},"FormatFormComponent_ds_form_0_Template_ds_form_submitForm_0_listener"))("cancel",__name(function(){return core.CHM(_r2),core.oxw().onCancel()},"FormatFormComponent_ds_form_0_Template_ds_form_cancel_0_listener")),core.qZA()}if(2&rf){const ctx_r0=core.oxw();core.Q6J("formId","comcol-form-id")("formModel",ctx_r0.formModel)}}__name(FormatFormComponent_ds_form_0_Template,"FormatFormComponent_ds_form_0_Template");class FormatFormComponent{constructor(dynamicFormService,translateService,router2){this.dynamicFormService=dynamicFormService,this.translateService=translateService,this.router=router2,this.bitstreamFormat=new bitstream_format_model.A,this.updatedFormat=new core.vpe,this.supportLevelOptions=[{label:bitstream_format_support_level.o.Known,value:bitstream_format_support_level.o.Known},{label:bitstream_format_support_level.o.Unknown,value:bitstream_format_support_level.o.Unknown},{label:bitstream_format_support_level.o.Supported,value:bitstream_format_support_level.o.Supported}],this.arrayElementLayout={grid:{group:"form-row"}},this.arrayInputElementLayout={grid:{host:"col"}},this.formModel=[new fesm2015_core.b1u({id:"shortDescription",name:"shortDescription",label:"admin.registries.bitstream-formats.edit.shortDescription.label",hint:"admin.registries.bitstream-formats.edit.shortDescription.hint",required:!0,validators:{required:null},errorMessages:{required:"Please enter a name for this bitstream format"}}),new fesm2015_core.b1u({id:"mimetype",name:"mimetype",label:"admin.registries.bitstream-formats.edit.mimetype.label",hint:"admin.registries.bitstream-formats.edit.mimetype.hint"}),new fesm2015_core.HBf({id:"description",name:"description",label:"admin.registries.bitstream-formats.edit.description.label",hint:"admin.registries.bitstream-formats.edit.description.hint"}),new fesm2015_core.nMt({id:"supportLevel",name:"supportLevel",options:this.supportLevelOptions,label:"admin.registries.bitstream-formats.edit.supportLevel.label",hint:"admin.registries.bitstream-formats.edit.supportLevel.hint",value:this.supportLevelOptions[0].value}),new fesm2015_core.dwp({id:"internal",name:"internal",label:"Internal",hint:"admin.registries.bitstream-formats.edit.internal.hint"}),new fesm2015_core.RRz({id:"extensions",name:"extensions",label:"admin.registries.bitstream-formats.edit.extensions.label",groupFactory:()=>[new fesm2015_core.b1u({id:"extension",placeholder:"admin.registries.bitstream-formats.edit.extensions.placeholder"},this.arrayInputElementLayout)]},this.arrayElementLayout)]}ngOnInit(){this.initValues()}initValues(){this.formModel.forEach(fieldModel=>{if("extensions"===fieldModel.name){if((0,empty_util.Uh)(this.bitstreamFormat.extensions)){const extenstions=this.bitstreamFormat.extensions,formArray=fieldModel;for(let i=0;i<extenstions.length;i++)formArray.insertGroup(i).group[0]=new fesm2015_core.b1u({id:`extension-${i}`,value:extenstions[i]},this.arrayInputElementLayout)}}else(0,empty_util.Uh)(this.bitstreamFormat[fieldModel.name])&&(fieldModel.value=this.bitstreamFormat[fieldModel.name])})}onSubmit(){const updatedBitstreamFormat=Object.assign(new bitstream_format_model.A,{id:this.bitstreamFormat.id});this.formModel.forEach(fieldModel=>{if("extensions"===fieldModel.name){const formArray=fieldModel,extensions=[];for(let i=0;i<formArray.groups.length;i++){const value=formArray.get(i).get(0).value;(0,empty_util.xb)(value)||extensions.push(formArray.get(i).get(0).value)}updatedBitstreamFormat.extensions=extensions}else updatedBitstreamFormat[fieldModel.name]=fieldModel.value}),this.updatedFormat.emit(updatedBitstreamFormat)}onCancel(){this.router.navigate([(0,admin_registries_routing_paths.e)()])}}__name(FormatFormComponent,"FormatFormComponent"),FormatFormComponent.\u0275fac=__name(function(t){return new(t||FormatFormComponent)(core.Y36(fesm2015_core.w1X),core.Y36(ngx_translate_core.sK),core.Y36(router.F0))},"FormatFormComponent_Factory"),FormatFormComponent.\u0275cmp=core.Xpm({type:FormatFormComponent,selectors:[["ds-bitstream-format-form"]],inputs:{bitstreamFormat:"bitstreamFormat"},outputs:{updatedFormat:"updatedFormat"},decls:1,vars:1,consts:[[3,"formId","formModel","submitForm","cancel",4,"ngIf"],[3,"formId","formModel","submitForm","cancel"]],template:__name(function(rf,ctx){1&rf&&core.YNc(0,FormatFormComponent_ds_form_0_Template,1,2,"ds-form",0),2&rf&&core.Q6J("ngIf",ctx.formModel)},"FormatFormComponent_Template"),directives:[common.O5,form_component.U],encapsulation:2});const _c0=__name(function(a0){return{format:a0}},"_c0");class EditBitstreamFormatComponent{constructor(route,router2,notificationService,translateService,bitstreamFormatDataService){this.route=route,this.router=router2,this.notificationService=notificationService,this.translateService=translateService,this.bitstreamFormatDataService=bitstreamFormatDataService}ngOnInit(){this.bitstreamFormatRD$=this.route.data.pipe((0,cjs_operators.UI)(data=>data.bitstreamFormat))}updateFormat(bitstreamFormat){this.bitstreamFormatDataService.updateBitstreamFormat(bitstreamFormat).pipe((0,operators.hC)()).subscribe(response=>{response.hasSucceeded?(this.notificationService.success(this.translateService.get("admin.registries.bitstream-formats.edit.success.head"),this.translateService.get("admin.registries.bitstream-formats.edit.success.content")),this.router.navigate([(0,admin_registries_routing_paths.e)()])):this.notificationService.error("admin.registries.bitstream-formats.edit.failure.head","admin.registries.bitstream-formats.create.edit.content")})}}__name(EditBitstreamFormatComponent,"EditBitstreamFormatComponent"),EditBitstreamFormatComponent.\u0275fac=__name(function(t){return new(t||EditBitstreamFormatComponent)(core.Y36(router.gz),core.Y36(router.F0),core.Y36(notifications_service.T),core.Y36(ngx_translate_core.sK),core.Y36(bitstream_format_data_service.O))},"EditBitstreamFormatComponent_Factory"),EditBitstreamFormatComponent.\u0275cmp=core.Xpm({type:EditBitstreamFormatComponent,selectors:[["ds-edit-bitstream-format"]],decls:9,vars:11,consts:[[1,"container"],[1,"row"],[1,"col-12","mb-4"],["id","sub-header",1,"border-bottom","mb-2"],[3,"bitstreamFormat","updatedFormat"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),core._uU(4),core.ALo(5,"translate"),core.ALo(6,"async"),core.qZA(),core.TgZ(7,"ds-bitstream-format-form",4),core.NdJ("updatedFormat",__name(function($event){return ctx.updateFormat($event)},"EditBitstreamFormatComponent_Template_ds_bitstream_format_form_updatedFormat_7_listener")),core.ALo(8,"async"),core.qZA()()()()),2&rf){let tmp_0_0,tmp_1_0;core.xp6(4),core.Oqu(core.xi3(5,2,"admin.registries.bitstream-formats.edit.head",core.VKq(9,_c0,null==(tmp_0_0=core.lcZ(6,5,ctx.bitstreamFormatRD$))?null:tmp_0_0.payload.shortDescription))),core.xp6(3),core.Q6J("bitstreamFormat",null==(tmp_1_0=core.lcZ(8,7,ctx.bitstreamFormatRD$))?null:tmp_1_0.payload)}},"EditBitstreamFormatComponent_Template"),directives:[FormatFormComponent],pipes:[ngx_translate_core.X$,common.Ov],encapsulation:2});var cjs=__webpack_require__(39942),pagination_component_options_model=__webpack_require__(98865),pagination_service=__webpack_require__(57854),find_list_options_model=__webpack_require__(30292),pagination_component=__webpack_require__(99292);function BitstreamFormatsComponent_ds_pagination_13_tr_18_span_11_Template(rf,ctx){1&rf&&(core.TgZ(0,"span"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij("(",core.lcZ(2,1,"admin.registries.bitstream-formats.table.internal"),")"))}__name(BitstreamFormatsComponent_ds_pagination_13_tr_18_span_11_Template,"BitstreamFormatsComponent_ds_pagination_13_tr_18_span_11_Template");const bitstream_formats_component_c0=__name(function(a1){return["/admin/registries/bitstream-formats",a1,"edit"]},"bitstream_formats_component_c0");function BitstreamFormatsComponent_ds_pagination_13_tr_18_Template(rf,ctx){if(1&rf){const _r8=core.EpF();core.TgZ(0,"tr")(1,"td")(2,"label")(3,"input",16),core.NdJ("change",__name(function($event){const bitstreamFormat_r5=core.CHM(_r8).$implicit;return core.oxw(2).selectBitStreamFormat(bitstreamFormat_r5,$event)},"BitstreamFormatsComponent_ds_pagination_13_tr_18_Template_input_change_3_listener")),core.ALo(4,"async"),core.qZA()()(),core.TgZ(5,"td")(6,"a",17),core._uU(7),core.qZA()(),core.TgZ(8,"td")(9,"a",17),core._uU(10),core.YNc(11,BitstreamFormatsComponent_ds_pagination_13_tr_18_span_11_Template,3,3,"span",18),core.qZA()(),core.TgZ(12,"td")(13,"a",17),core._uU(14),core.ALo(15,"translate"),core.qZA()()()}if(2&rf){const bitstreamFormat_r5=ctx.$implicit,ctx_r4=core.oxw(2);core.xp6(3),core.Q6J("checked",core.lcZ(4,8,ctx_r4.isSelected(bitstreamFormat_r5))),core.xp6(3),core.Q6J("routerLink",core.VKq(12,bitstream_formats_component_c0,bitstreamFormat_r5.id)),core.xp6(1),core.Oqu(bitstreamFormat_r5.shortDescription),core.xp6(2),core.Q6J("routerLink",core.VKq(14,bitstream_formats_component_c0,bitstreamFormat_r5.id)),core.xp6(1),core.hij("",bitstreamFormat_r5.mimetype," "),core.xp6(1),core.Q6J("ngIf",bitstreamFormat_r5.internal),core.xp6(2),core.Q6J("routerLink",core.VKq(16,bitstream_formats_component_c0,bitstreamFormat_r5.id)),core.xp6(1),core.Oqu(core.lcZ(15,10,"admin.registries.bitstream-formats.table.supportLevel."+bitstreamFormat_r5.supportLevel))}}function BitstreamFormatsComponent_ds_pagination_13_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ds-pagination",11),core.ALo(1,"async"),core.ALo(2,"async"),core.TgZ(3,"div",12)(4,"table",13)(5,"thead")(6,"tr"),core._UZ(7,"th",14),core.TgZ(8,"th",14),core._uU(9),core.ALo(10,"translate"),core.qZA(),core.TgZ(11,"th",14),core._uU(12),core.ALo(13,"translate"),core.qZA(),core.TgZ(14,"th",14),core._uU(15),core.ALo(16,"translate"),core.qZA()()(),core.TgZ(17,"tbody"),core.YNc(18,BitstreamFormatsComponent_ds_pagination_13_tr_18_Template,16,18,"tr",15),core.ALo(19,"async"),core.qZA()()()()),2&rf){const ctx_r0=core.oxw();let tmp_1_0,tmp_2_0,tmp_8_0;core.Q6J("paginationOptions",ctx_r0.pageConfig)("pageInfoState",null==(tmp_1_0=core.lcZ(1,9,ctx_r0.bitstreamFormats))?null:tmp_1_0.payload)("collectionSize",null==(tmp_2_0=core.lcZ(2,11,ctx_r0.bitstreamFormats))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.xp6(9),core.Oqu(core.lcZ(10,13,"admin.registries.bitstream-formats.table.name")),core.xp6(3),core.Oqu(core.lcZ(13,15,"admin.registries.bitstream-formats.table.mimetype")),core.xp6(3),core.Oqu(core.lcZ(16,17,"admin.registries.bitstream-formats.table.supportLevel.head")),core.xp6(3),core.Q6J("ngForOf",null==(tmp_8_0=core.lcZ(19,19,ctx_r0.bitstreamFormats))||null==tmp_8_0.payload?null:tmp_8_0.payload.page)}}function BitstreamFormatsComponent_div_15_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",19),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.registries.bitstream-formats.no-items")," "))}function BitstreamFormatsComponent_button_18_Template(rf,ctx){if(1&rf){const _r10=core.EpF();core.TgZ(0,"button",20),core.NdJ("click",__name(function(){return core.CHM(_r10),core.oxw().deselectAll()},"BitstreamFormatsComponent_button_18_Template_button_click_0_listener")),core._uU(1),core.ALo(2,"translate"),core.qZA()}2&rf&&(core.xp6(1),core.Oqu(core.lcZ(2,1,"admin.registries.bitstream-formats.table.deselect-all")))}function BitstreamFormatsComponent_button_20_Template(rf,ctx){if(1&rf){const _r12=core.EpF();core.TgZ(0,"button",21),core.NdJ("click",__name(function(){return core.CHM(_r12),core.oxw().deleteFormats()},"BitstreamFormatsComponent_button_20_Template_button_click_0_listener")),core._uU(1),core.ALo(2,"translate"),core.qZA()}2&rf&&(core.xp6(1),core.Oqu(core.lcZ(2,1,"admin.registries.bitstream-formats.table.delete")))}__name(BitstreamFormatsComponent_ds_pagination_13_tr_18_Template,"BitstreamFormatsComponent_ds_pagination_13_tr_18_Template"),__name(BitstreamFormatsComponent_ds_pagination_13_Template,"BitstreamFormatsComponent_ds_pagination_13_Template"),__name(BitstreamFormatsComponent_div_15_Template,"BitstreamFormatsComponent_div_15_Template"),__name(BitstreamFormatsComponent_button_18_Template,"BitstreamFormatsComponent_button_18_Template"),__name(BitstreamFormatsComponent_button_20_Template,"BitstreamFormatsComponent_button_20_Template");class BitstreamFormatsComponent{constructor(notificationsService,router2,translateService,bitstreamFormatService,paginationService){this.notificationsService=notificationsService,this.router=router2,this.translateService=translateService,this.bitstreamFormatService=bitstreamFormatService,this.paginationService=paginationService,this.config=Object.assign(new find_list_options_model.R,{elementsPerPage:20}),this.pageConfig=Object.assign(new pagination_component_options_model.r,{id:"rbp",pageSize:20})}deleteFormats(){this.bitstreamFormatService.clearBitStreamFormatRequests(),this.bitstreamFormatService.getSelectedBitstreamFormats().pipe((0,cjs_operators.qn)(1),(0,cjs_operators.zg)(formats=>formats),(0,cjs_operators.zg)(format=>this.bitstreamFormatService.delete(format.id).pipe((0,operators.hC)(),(0,cjs_operators.UI)(response=>response.hasSucceeded))),(0,cjs_operators.qo)()).subscribe(results=>{const successResponses=results.filter(result=>result),failedResponses=results.filter(result=>!result);successResponses.length>0&&this.showNotification(!0,successResponses.length),failedResponses.length>0&&this.showNotification(!1,failedResponses.length),this.deselectAll(),this.paginationService.resetPage(this.pageConfig.id)})}deselectAll(){this.bitstreamFormatService.deselectAllBitstreamFormats()}isSelected(bitstreamFormat){return this.bitstreamFormatService.getSelectedBitstreamFormats().pipe((0,cjs_operators.UI)(bitstreamFormats=>null!=bitstreamFormats.find(selectedFormat=>selectedFormat.id===bitstreamFormat.id)))}selectBitStreamFormat(bitstreamFormat,event){event.target.checked?this.bitstreamFormatService.selectBitstreamFormat(bitstreamFormat):this.bitstreamFormatService.deselectBitstreamFormat(bitstreamFormat)}showNotification(success,amount){const prefix="admin.registries.bitstream-formats.delete",suffix=success?"success":"failure";(0,cjs.combineLatest)(this.translateService.get(`${prefix}.${suffix}.head`),this.translateService.get(`${prefix}.${suffix}.amount`,{amount})).subscribe(([head,content])=>{success?this.notificationsService.success(head,content):this.notificationsService.error(head,content)})}ngOnInit(){this.bitstreamFormats=this.paginationService.getFindListOptions(this.pageConfig.id,this.config).pipe((0,cjs_operators.wt)(findListOptions=>this.bitstreamFormatService.findAll(findListOptions)))}ngOnDestroy(){this.paginationService.clearPagination(this.pageConfig.id)}}__name(BitstreamFormatsComponent,"BitstreamFormatsComponent"),BitstreamFormatsComponent.\u0275fac=__name(function(t){return new(t||BitstreamFormatsComponent)(core.Y36(notifications_service.T),core.Y36(router.F0),core.Y36(ngx_translate_core.sK),core.Y36(bitstream_format_data_service.O),core.Y36(pagination_service.N))},"BitstreamFormatsComponent_Factory"),BitstreamFormatsComponent.\u0275cmp=core.Xpm({type:BitstreamFormatsComponent,selectors:[["ds-bitstream-formats"]],decls:22,vars:22,consts:[[1,"container"],[1,"bitstream-formats","row"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description"],["id","create-new",1,"mb-2"],[1,"btn","btn-success",3,"routerLink"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info","role","alert",4,"ngIf"],["class","btn btn-primary deselect",3,"click",4,"ngIf"],["type","submit","class","btn btn-danger float-right",3,"click",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","formats",1,"table","table-striped","table-hover"],["scope","col"],[4,"ngFor","ngForOf"],["type","checkbox",3,"checked","change"],[3,"routerLink"],[4,"ngIf"],["role","alert",1,"alert","alert-info"],[1,"btn","btn-primary","deselect",3,"click"],["type","submit",1,"btn","btn-danger","float-right",3,"click"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),core._uU(4),core.ALo(5,"translate"),core.qZA(),core.TgZ(6,"p",4),core._uU(7),core.ALo(8,"translate"),core.qZA(),core.TgZ(9,"p",5)(10,"a",6),core._uU(11),core.ALo(12,"translate"),core.qZA()(),core.YNc(13,BitstreamFormatsComponent_ds_pagination_13_Template,20,21,"ds-pagination",7),core.ALo(14,"async"),core.YNc(15,BitstreamFormatsComponent_div_15_Template,3,3,"div",8),core.ALo(16,"async"),core.TgZ(17,"div"),core.YNc(18,BitstreamFormatsComponent_button_18_Template,3,3,"button",9),core.ALo(19,"async"),core.YNc(20,BitstreamFormatsComponent_button_20_Template,3,3,"button",10),core.ALo(21,"async"),core.qZA()()()()),2&rf){let tmp_4_0,tmp_5_0,tmp_6_0,tmp_7_0;core.xp6(4),core.Oqu(core.lcZ(5,8,"admin.registries.bitstream-formats.head")),core.xp6(3),core.Oqu(core.lcZ(8,10,"admin.registries.bitstream-formats.description")),core.xp6(3),core.Q6J("routerLink","add"),core.xp6(1),core.Oqu(core.lcZ(12,12,"admin.registries.bitstream-formats.create.new")),core.xp6(2),core.Q6J("ngIf",(null==(tmp_4_0=core.lcZ(14,14,ctx.bitstreamFormats))||null==tmp_4_0.payload?null:tmp_4_0.payload.totalElements)>0),core.xp6(2),core.Q6J("ngIf",0==(null==(tmp_5_0=core.lcZ(16,16,ctx.bitstreamFormats))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements)),core.xp6(3),core.Q6J("ngIf",(null==(tmp_6_0=core.lcZ(19,18,ctx.bitstreamFormats))||null==tmp_6_0.payload||null==tmp_6_0.payload.page?null:tmp_6_0.payload.page.length)>0),core.xp6(2),core.Q6J("ngIf",(null==(tmp_7_0=core.lcZ(21,20,ctx.bitstreamFormats))||null==tmp_7_0.payload||null==tmp_7_0.payload.page?null:tmp_7_0.payload.page.length)>0)}},"BitstreamFormatsComponent_Template"),directives:[router.yS,common.O5,pagination_component.Q,common.sg],pipes:[ngx_translate_core.X$,common.Ov],encapsulation:2});class AddBitstreamFormatComponent{constructor(router2,notificationService,translateService,bitstreamFormatDataService){this.router=router2,this.notificationService=notificationService,this.translateService=translateService,this.bitstreamFormatDataService=bitstreamFormatDataService}createBitstreamFormat(bitstreamFormat){this.bitstreamFormatDataService.createBitstreamFormat(bitstreamFormat).pipe((0,operators.hC)()).subscribe(response=>{response.hasSucceeded?(this.notificationService.success(this.translateService.get("admin.registries.bitstream-formats.create.success.head"),this.translateService.get("admin.registries.bitstream-formats.create.success.content")),this.router.navigate([(0,admin_registries_routing_paths.e)()]),this.bitstreamFormatDataService.clearBitStreamFormatRequests().subscribe()):this.notificationService.error(this.translateService.get("admin.registries.bitstream-formats.create.failure.head"),this.translateService.get("admin.registries.bitstream-formats.create.failure.content"))})}}__name(AddBitstreamFormatComponent,"AddBitstreamFormatComponent"),AddBitstreamFormatComponent.\u0275fac=__name(function(t){return new(t||AddBitstreamFormatComponent)(core.Y36(router.F0),core.Y36(notifications_service.T),core.Y36(ngx_translate_core.sK),core.Y36(bitstream_format_data_service.O))},"AddBitstreamFormatComponent_Factory"),AddBitstreamFormatComponent.\u0275cmp=core.Xpm({type:AddBitstreamFormatComponent,selectors:[["ds-add-bitstream-format"]],decls:7,vars:3,consts:[[1,"container"],[1,"row"],[1,"col-12","mb-4"],["id","sub-header",1,"border-bottom","mb-2"],[3,"updatedFormat"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),core._uU(4),core.ALo(5,"translate"),core.qZA(),core.TgZ(6,"ds-bitstream-format-form",4),core.NdJ("updatedFormat",__name(function($event){return ctx.createBitstreamFormat($event)},"AddBitstreamFormatComponent_Template_ds_bitstream_format_form_updatedFormat_6_listener")),core.qZA()()()()),2&rf&&(core.xp6(4),core.Oqu(core.lcZ(5,1,"admin.registries.bitstream-formats.create.new")))},"AddBitstreamFormatComponent_Template"),directives:[FormatFormComponent],pipes:[ngx_translate_core.X$],encapsulation:2});var i18n_breadcrumb_resolver=__webpack_require__(64561);class BitstreamFormatsRoutingModule{}__name(BitstreamFormatsRoutingModule,"BitstreamFormatsRoutingModule"),BitstreamFormatsRoutingModule.\u0275fac=__name(function(t){return new(t||BitstreamFormatsRoutingModule)},"BitstreamFormatsRoutingModule_Factory"),BitstreamFormatsRoutingModule.\u0275mod=core.oAB({type:BitstreamFormatsRoutingModule}),BitstreamFormatsRoutingModule.\u0275inj=core.cJS({providers:[BitstreamFormatsResolver],imports:[[router.Bz.forChild([{path:"",component:BitstreamFormatsComponent},{path:"add",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},component:AddBitstreamFormatComponent,data:{breadcrumbKey:"admin.registries.bitstream-formats.create"}},{path:":id/edit",component:EditBitstreamFormatComponent,resolve:{bitstreamFormat:BitstreamFormatsResolver,breadcrumb:i18n_breadcrumb_resolver.t},data:{breadcrumbKey:"admin.registries.bitstream-formats.edit"}}])]]});var form_module=__webpack_require__(48197);class BitstreamFormatsModule{}__name(BitstreamFormatsModule,"BitstreamFormatsModule"),BitstreamFormatsModule.\u0275fac=__name(function(t){return new(t||BitstreamFormatsModule)},"BitstreamFormatsModule_Factory"),BitstreamFormatsModule.\u0275mod=core.oAB({type:BitstreamFormatsModule}),BitstreamFormatsModule.\u0275inj=core.cJS({imports:[[common.ez,shared_module.m,router.Bz,BitstreamFormatsRoutingModule,form_module.e]]})},71462:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>REGISTRIES_MODULE_PATH,T:()=>getRegistriesModuleRoute});var _core_url_combiner_url_combiner__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69810),_app_routing_paths__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(61562);const REGISTRIES_MODULE_PATH="registries";function getRegistriesModuleRoute(){return new _core_url_combiner_url_combiner__WEBPACK_IMPORTED_MODULE_1__.R((0,_app_routing_paths__WEBPACK_IMPORTED_MODULE_0__.V5)(),REGISTRIES_MODULE_PATH).toString()}__name(getRegistriesModuleRoute,"getRegistriesModuleRoute")},75272:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AdminModule:()=>AdminModule});var shared_module=__webpack_require__(66004),access_control_module=__webpack_require__(59575),admin_registries_module=__webpack_require__(98917),router=__webpack_require__(37895),script_data_service=__webpack_require__(97965),process_parameter_model=__webpack_require__(85357),empty_util=__webpack_require__(25839),notifications_service=__webpack_require__(16228),operators=__webpack_require__(63281),process_page_routing_paths=__webpack_require__(67809),core=__webpack_require__(70074),common=__webpack_require__(10210),ngx_translate_core=__webpack_require__(47241),fesm2015_forms=__webpack_require__(45028),file_dropzone_no_uploader_component=__webpack_require__(41464);class MetadataImportPageComponent{constructor(location,translate,notificationsService,scriptDataService,router2){this.location=location,this.translate=translate,this.notificationsService=notificationsService,this.scriptDataService=scriptDataService,this.router=router2,this.validateOnly=!0}setFile(file){this.fileObject=file}onReturn(){this.location.back()}importMetadata(){if(null==this.fileObject)this.notificationsService.error(this.translate.get("admin.metadata-import.page.error.addFile"));else{const parameterValues=[Object.assign(new process_parameter_model.N,{name:"-f",value:this.fileObject.name})];this.validateOnly&&parameterValues.push(Object.assign(new process_parameter_model.N,{name:"-v",value:!0})),this.scriptDataService.invoke(script_data_service.As,parameterValues,[this.fileObject]).pipe((0,operators.hC)()).subscribe(rd=>{if(rd.hasSucceeded){const title=this.translate.get("process.new.notification.success.title"),content=this.translate.get("process.new.notification.success.content");this.notificationsService.success(title,content),(0,empty_util.UE)(rd.payload)&&this.router.navigateByUrl((0,process_page_routing_paths.Ah)(rd.payload.processId))}else{const title=this.translate.get("process.new.notification.error.title"),content=this.translate.get("process.new.notification.error.content");this.notificationsService.error(title,content)}})}}}__name(MetadataImportPageComponent,"MetadataImportPageComponent"),MetadataImportPageComponent.\u0275fac=__name(function(t){return new(t||MetadataImportPageComponent)(core.Y36(common.Ye),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(script_data_service.UY),core.Y36(router.F0))},"MetadataImportPageComponent_Factory"),MetadataImportPageComponent.\u0275cmp=core.Xpm({type:MetadataImportPageComponent,selectors:[["ds-metadata-import-page"]],decls:24,vars:21,consts:[[1,"container"],["id","header"],[1,"form-group"],[1,"form-check"],["type","checkbox","id","validateOnly",1,"form-check-input",3,"ngModel","ngModelChange"],["for","validateOnly",1,"form-check-label"],["id","validateOnlyHelpBlock",1,"form-text","text-muted"],[3,"dropMessageLabel","dropMessageLabelReplacement","onFileAdded"],[1,"space-children-mr"],["id","backButton",1,"btn","btn-secondary",3,"click"],["id","proceedButton",1,"btn","btn-primary",3,"click"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"h2",1),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"p"),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.TgZ(7,"div",2)(8,"div",3)(9,"input",4),core.NdJ("ngModelChange",__name(function($event){return ctx.validateOnly=$event},"MetadataImportPageComponent_Template_input_ngModelChange_9_listener")),core.qZA(),core.TgZ(10,"label",5),core._uU(11),core.ALo(12,"translate"),core.qZA()(),core.TgZ(13,"small",6),core._uU(14),core.ALo(15,"translate"),core.qZA()(),core.TgZ(16,"ds-file-dropzone-no-uploader",7),core.NdJ("onFileAdded",__name(function($event){return ctx.setFile($event)},"MetadataImportPageComponent_Template_ds_file_dropzone_no_uploader_onFileAdded_16_listener")),core.qZA(),core.TgZ(17,"div",8)(18,"button",9),core.NdJ("click",__name(function(){return ctx.onReturn()},"MetadataImportPageComponent_Template_button_click_18_listener")),core._uU(19),core.ALo(20,"translate"),core.qZA(),core.TgZ(21,"button",10),core.NdJ("click",__name(function(){return ctx.importMetadata()},"MetadataImportPageComponent_Template_button_click_21_listener")),core._uU(22),core.ALo(23,"translate"),core.qZA()()()),2&rf&&(core.xp6(2),core.Oqu(core.lcZ(3,9,"admin.metadata-import.page.header")),core.xp6(3),core.Oqu(core.lcZ(6,11,"admin.metadata-import.page.help")),core.xp6(4),core.Q6J("ngModel",ctx.validateOnly),core.xp6(2),core.hij(" ",core.lcZ(12,13,"admin.metadata-import.page.validateOnly")," "),core.xp6(3),core.hij(" ",core.lcZ(15,15,"admin.metadata-import.page.validateOnly.hint")," "),core.xp6(2),core.Q6J("dropMessageLabel","admin.metadata-import.page.dropMsg")("dropMessageLabelReplacement","admin.metadata-import.page.dropMsgReplace"),core.xp6(3),core.Oqu(core.lcZ(20,17,"admin.metadata-import.page.button.return")),core.xp6(3),core.Oqu(core.lcZ(23,19,"admin.metadata-import.page.button.proceed")))},"MetadataImportPageComponent_Template"),directives:[fesm2015_forms.Wl,fesm2015_forms.JJ,fesm2015_forms.On,file_dropzone_no_uploader_component.n],pipes:[ngx_translate_core.X$],encapsulation:2});var context_model=__webpack_require__(10364),configuration_search_page_component=__webpack_require__(94719);class AdminSearchPageComponent{constructor(){this.context=context_model._.AdminSearch}}__name(AdminSearchPageComponent,"AdminSearchPageComponent"),AdminSearchPageComponent.\u0275fac=__name(function(t){return new(t||AdminSearchPageComponent)},"AdminSearchPageComponent_Factory"),AdminSearchPageComponent.\u0275cmp=core.Xpm({type:AdminSearchPageComponent,selectors:[["ds-admin-search-page"]],decls:1,vars:1,consts:[["configuration","administrativeView",3,"context"]],template:__name(function(rf,ctx){1&rf&&core._UZ(0,"ds-configuration-search-page",0),2&rf&&core.Q6J("context",ctx.context)},"AdminSearchPageComponent_Template"),directives:[configuration_search_page_component.ConfigurationSearchPageComponent],styles:[""]});var i18n_breadcrumb_resolver=__webpack_require__(64561);class AdminWorkflowPageComponent{constructor(){this.context=context_model._.AdminWorkflowSearch}}__name(AdminWorkflowPageComponent,"AdminWorkflowPageComponent"),AdminWorkflowPageComponent.\u0275fac=__name(function(t){return new(t||AdminWorkflowPageComponent)},"AdminWorkflowPageComponent_Factory"),AdminWorkflowPageComponent.\u0275cmp=core.Xpm({type:AdminWorkflowPageComponent,selectors:[["ds-admin-workflow-page"]],decls:1,vars:1,consts:[["configuration","workflowAdmin",3,"context"]],template:__name(function(rf,ctx){1&rf&&core._UZ(0,"ds-configuration-search-page",0),2&rf&&core.Q6J("context",ctx.context)},"AdminWorkflowPageComponent_Template"),directives:[configuration_search_page_component.ConfigurationSearchPageComponent],styles:[""]});var i18n_breadcrumbs_service=__webpack_require__(17241),curation_form_component=__webpack_require__(12141);class AdminCurationTasksComponent{}__name(AdminCurationTasksComponent,"AdminCurationTasksComponent"),AdminCurationTasksComponent.\u0275fac=__name(function(t){return new(t||AdminCurationTasksComponent)},"AdminCurationTasksComponent_Factory"),AdminCurationTasksComponent.\u0275cmp=core.Xpm({type:AdminCurationTasksComponent,selectors:[["ds-admin-curation-task"]],decls:5,vars:3,consts:[[1,"container"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"h2"),core._uU(2),core.ALo(3,"translate"),core.qZA(),core._UZ(4,"ds-curation-form"),core.qZA()),2&rf&&(core.xp6(2),core.Oqu(core.lcZ(3,1,"admin.curation-tasks.header")))},"AdminCurationTasksComponent_Template"),directives:[curation_form_component._],pipes:[ngx_translate_core.X$],encapsulation:2});var admin_routing_paths=__webpack_require__(71462),import_batch_selector_component=__webpack_require__(80189),cjs_operators=__webpack_require__(5796),dso_name_service=__webpack_require__(53043),ng_bootstrap=__webpack_require__(63742);function BatchImportPageComponent_p_7_Template(rf,ctx){if(1&rf){const _r2=core.EpF();core.TgZ(0,"p"),core._uU(1," selected collection: "),core.TgZ(2,"b"),core._uU(3),core.qZA(),core._uU(4,"\xa0 "),core.TgZ(5,"a",13),core.NdJ("click",__name(function(){return core.CHM(_r2),core.oxw().removeDspaceObject()},"BatchImportPageComponent_p_7_Template_a_click_5_listener")),core._uU(6),core.ALo(7,"translate"),core.qZA()()}if(2&rf){const ctx_r0=core.oxw();core.xp6(3),core.Oqu(ctx_r0.getDspaceObjectName()),core.xp6(3),core.Oqu(core.lcZ(7,2,"admin.batch-import.page.remove"))}}__name(BatchImportPageComponent_p_7_Template,"BatchImportPageComponent_p_7_Template");class BatchImportPageComponent{constructor(location,translate,notificationsService,scriptDataService,router2,modalService,dsoNameService){this.location=location,this.translate=translate,this.notificationsService=notificationsService,this.scriptDataService=scriptDataService,this.router=router2,this.modalService=modalService,this.dsoNameService=dsoNameService,this.validateOnly=!0,this.dso=null}setFile(file){this.fileObject=file}onReturn(){this.location.back()}selectCollection(){this.modalService.open(import_batch_selector_component.w).componentInstance.response.pipe((0,cjs_operators.qn)(1)).subscribe(dso=>{this.dso=dso||null})}importMetadata(){if(null==this.fileObject)this.notificationsService.error(this.translate.get("admin.metadata-import.page.error.addFile"));else{const parameterValues=[Object.assign(new process_parameter_model.N,{name:"--zip",value:this.fileObject.name}),Object.assign(new process_parameter_model.N,{name:"--add"})];this.dso&&parameterValues.push(Object.assign(new process_parameter_model.N,{name:"--collection",value:this.dso.uuid})),this.validateOnly&&parameterValues.push(Object.assign(new process_parameter_model.N,{name:"-v",value:!0})),this.scriptDataService.invoke(script_data_service.rI,parameterValues,[this.fileObject]).pipe((0,operators.hC)()).subscribe(rd=>{if(rd.hasSucceeded){const title=this.translate.get("process.new.notification.success.title"),content=this.translate.get("process.new.notification.success.content");this.notificationsService.success(title,content),(0,empty_util.UE)(rd.payload)&&this.router.navigateByUrl((0,process_page_routing_paths.Ah)(rd.payload.processId))}else{const title=this.translate.get("process.new.notification.error.title"),content=this.translate.get("process.new.notification.error.content");this.notificationsService.error(title,content)}})}}getDspaceObjectName(){return this.dso?this.dsoNameService.getName(this.dso):null}removeDspaceObject(){this.dso=null}}__name(BatchImportPageComponent,"BatchImportPageComponent"),BatchImportPageComponent.\u0275fac=__name(function(t){return new(t||BatchImportPageComponent)(core.Y36(common.Ye),core.Y36(ngx_translate_core.sK),core.Y36(notifications_service.T),core.Y36(script_data_service.UY),core.Y36(router.F0),core.Y36(ng_bootstrap.FF),core.Y36(dso_name_service._))},"BatchImportPageComponent_Factory"),BatchImportPageComponent.\u0275cmp=core.Xpm({type:BatchImportPageComponent,selectors:[["ds-batch-import-page"]],decls:29,vars:25,consts:[[1,"container"],["id","header"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],[1,"form-group"],[1,"form-check"],["type","checkbox","id","validateOnly",1,"form-check-input",3,"ngModel","ngModelChange"],["for","validateOnly",1,"form-check-label"],["id","validateOnlyHelpBlock",1,"form-text","text-muted"],[3,"dropMessageLabel","dropMessageLabelReplacement","onFileAdded"],[1,"space-children-mr"],["id","backButton",1,"btn","btn-secondary",3,"click"],["id","proceedButton",1,"btn","btn-primary",3,"click"],["href","javascript:void(0)",3,"click"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"h2",1),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"p"),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.YNc(7,BatchImportPageComponent_p_7_Template,8,4,"p",2),core.TgZ(8,"p")(9,"button",3),core.NdJ("click",__name(function(){return ctx.selectCollection()},"BatchImportPageComponent_Template_button_click_9_listener")),core._uU(10),core.ALo(11,"translate"),core.qZA()(),core.TgZ(12,"div",4)(13,"div",5)(14,"input",6),core.NdJ("ngModelChange",__name(function($event){return ctx.validateOnly=$event},"BatchImportPageComponent_Template_input_ngModelChange_14_listener")),core.qZA(),core.TgZ(15,"label",7),core._uU(16),core.ALo(17,"translate"),core.qZA()(),core.TgZ(18,"small",8),core._uU(19),core.ALo(20,"translate"),core.qZA()(),core.TgZ(21,"ds-file-dropzone-no-uploader",9),core.NdJ("onFileAdded",__name(function($event){return ctx.setFile($event)},"BatchImportPageComponent_Template_ds_file_dropzone_no_uploader_onFileAdded_21_listener")),core.qZA(),core.TgZ(22,"div",10)(23,"button",11),core.NdJ("click",__name(function(){return ctx.onReturn()},"BatchImportPageComponent_Template_button_click_23_listener")),core._uU(24),core.ALo(25,"translate"),core.qZA(),core.TgZ(26,"button",12),core.NdJ("click",__name(function(){return ctx.importMetadata()},"BatchImportPageComponent_Template_button_click_26_listener")),core._uU(27),core.ALo(28,"translate"),core.qZA()()()),2&rf&&(core.xp6(2),core.Oqu(core.lcZ(3,11,"admin.batch-import.page.header")),core.xp6(3),core.Oqu(core.lcZ(6,13,"admin.batch-import.page.help")),core.xp6(2),core.Q6J("ngIf",ctx.dso),core.xp6(3),core.Oqu(core.lcZ(11,15,"admin.metadata-import.page.button.select-collection")),core.xp6(4),core.Q6J("ngModel",ctx.validateOnly),core.xp6(2),core.hij(" ",core.lcZ(17,17,"admin.metadata-import.page.validateOnly")," "),core.xp6(3),core.hij(" ",core.lcZ(20,19,"admin.batch-import.page.validateOnly.hint")," "),core.xp6(2),core.Q6J("dropMessageLabel","admin.batch-import.page.dropMsg")("dropMessageLabelReplacement","admin.batch-import.page.dropMsgReplace"),core.xp6(3),core.Oqu(core.lcZ(25,21,"admin.metadata-import.page.button.return")),core.xp6(3),core.Oqu(core.lcZ(28,23,"admin.metadata-import.page.button.proceed")))},"BatchImportPageComponent_Template"),directives:[common.O5,fesm2015_forms.Wl,fesm2015_forms.JJ,fesm2015_forms.On,file_dropzone_no_uploader_component.n],pipes:[ngx_translate_core.X$],encapsulation:2});class AdminRoutingModule{}__name(AdminRoutingModule,"AdminRoutingModule"),AdminRoutingModule.\u0275fac=__name(function(t){return new(t||AdminRoutingModule)},"AdminRoutingModule_Factory"),AdminRoutingModule.\u0275mod=core.oAB({type:AdminRoutingModule}),AdminRoutingModule.\u0275inj=core.cJS({providers:[i18n_breadcrumb_resolver.t,i18n_breadcrumbs_service.d],imports:[[router.Bz.forChild([{path:admin_routing_paths.B,loadChildren:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,98917)).then(m=>m.AdminRegistriesModule)},{path:"search",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},component:AdminSearchPageComponent,data:{title:"admin.search.title",breadcrumbKey:"admin.search"}},{path:"workflow",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},component:AdminWorkflowPageComponent,data:{title:"admin.workflow.title",breadcrumbKey:"admin.workflow"}},{path:"curation-tasks",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},component:AdminCurationTasksComponent,data:{title:"admin.curation-tasks.title",breadcrumbKey:"admin.curation-tasks"}},{path:"metadata-import",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},component:MetadataImportPageComponent,data:{title:"admin.metadata-import.title",breadcrumbKey:"admin.metadata-import"}},{path:"batch-import",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},component:BatchImportPageComponent,data:{title:"admin.batch-import.title",breadcrumbKey:"admin.batch-import"}}])]]});var tslib_es6=__webpack_require__(70655),view_mode_model=__webpack_require__(84484),listable_object_decorator=__webpack_require__(17410),search_result_grid_element_component=__webpack_require__(44126),truncatable_service=__webpack_require__(77606),bitstream_data_service=__webpack_require__(93132),listable_object_directive=__webpack_require__(94658),link_service=__webpack_require__(72564),follow_link_config_model=__webpack_require__(8183),workflow_item_search_result_model=__webpack_require__(72004),theme_service=__webpack_require__(70248),workflowitems_edit_page_routing_paths=(__webpack_require__(41527),__webpack_require__(47864));function WorkflowItemAdminWorkflowActionsComponent_span_4_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",6),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.workflow.item.delete"),""))}function WorkflowItemAdminWorkflowActionsComponent_span_8_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",6),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.workflow.item.send-back"),""))}__name(WorkflowItemAdminWorkflowActionsComponent_span_4_Template,"WorkflowItemAdminWorkflowActionsComponent_span_4_Template"),__name(WorkflowItemAdminWorkflowActionsComponent_span_8_Template,"WorkflowItemAdminWorkflowActionsComponent_span_8_Template");const _c0=__name(function(a0){return{"btn-sm":a0}},"_c0"),_c1=__name(function(a0){return[a0]},"_c1");class WorkflowItemAdminWorkflowActionsComponent{getDeleteRoute(){return(0,workflowitems_edit_page_routing_paths.fk)(this.wfi.id)}getSendBackRoute(){return(0,workflowitems_edit_page_routing_paths.Du)(this.wfi.id)}}__name(WorkflowItemAdminWorkflowActionsComponent,"WorkflowItemAdminWorkflowActionsComponent"),WorkflowItemAdminWorkflowActionsComponent.\u0275fac=__name(function(t){return new(t||WorkflowItemAdminWorkflowActionsComponent)},"WorkflowItemAdminWorkflowActionsComponent_Factory"),WorkflowItemAdminWorkflowActionsComponent.\u0275cmp=core.Xpm({type:WorkflowItemAdminWorkflowActionsComponent,selectors:[["ds-workflow-item-admin-workflow-actions-element"]],inputs:{wfi:"wfi",small:"small"},decls:9,vars:20,consts:[[1,"space-children-mr"],[1,"btn","btn-light","my-1","delete-link",3,"ngClass","routerLink","title"],[1,"fa","fa-trash"],["class","d-none d-sm-inline",4,"ngIf"],[1,"btn","btn-light","my-1","send-back-link",3,"ngClass","routerLink","title"],[1,"fa","fa-hand-point-left"],[1,"d-none","d-sm-inline"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"a",1),core.ALo(2,"translate"),core._UZ(3,"i",2),core.YNc(4,WorkflowItemAdminWorkflowActionsComponent_span_4_Template,3,3,"span",3),core.qZA(),core.TgZ(5,"a",4),core.ALo(6,"translate"),core._UZ(7,"i",5),core.YNc(8,WorkflowItemAdminWorkflowActionsComponent_span_8_Template,3,3,"span",3),core.qZA()()),2&rf&&(core.xp6(1),core.Q6J("ngClass",core.VKq(12,_c0,ctx.small))("routerLink",core.VKq(14,_c1,ctx.getDeleteRoute()))("title",core.lcZ(2,8,"admin.workflow.item.delete")),core.xp6(3),core.Q6J("ngIf",!ctx.small),core.xp6(1),core.Q6J("ngClass",core.VKq(16,_c0,ctx.small))("routerLink",core.VKq(18,_c1,ctx.getSendBackRoute()))("title",core.lcZ(6,10,"admin.workflow.item.send-back")),core.xp6(3),core.Q6J("ngIf",!ctx.small))},"WorkflowItemAdminWorkflowActionsComponent_Template"),directives:[router.yS,common.mk,common.O5],pipes:[ngx_translate_core.X$],styles:[""]});const workflow_item_search_result_admin_workflow_grid_element_component_c0=["badges"],workflow_item_search_result_admin_workflow_grid_element_component_c1=["buttons"];function WorkflowItemSearchResultAdminWorkflowGridElementComponent_ng_template_0_Template(rf,ctx){}function WorkflowItemSearchResultAdminWorkflowGridElementComponent_ds_workflow_item_admin_workflow_actions_element_10_Template(rf,ctx){if(1&rf&&core._UZ(0,"ds-workflow-item-admin-workflow-actions-element",9),2&rf){const ctx_r3=core.oxw();core.Q6J("wfi",ctx_r3.dso)("small",!0)}}__name(WorkflowItemSearchResultAdminWorkflowGridElementComponent_ng_template_0_Template,"WorkflowItemSearchResultAdminWorkflowGridElementComponent_ng_template_0_Template"),__name(WorkflowItemSearchResultAdminWorkflowGridElementComponent_ds_workflow_item_admin_workflow_actions_element_10_Template,"WorkflowItemSearchResultAdminWorkflowGridElementComponent_ds_workflow_item_admin_workflow_actions_element_10_Template");let WorkflowItemSearchResultAdminWorkflowGridElementComponent=__name(class extends search_result_grid_element_component.h{constructor(componentFactoryResolver,linkService,truncatableService,themeService,bitstreamDataService){super(truncatableService,bitstreamDataService),this.componentFactoryResolver=componentFactoryResolver,this.linkService=linkService,this.truncatableService=truncatableService,this.themeService=themeService,this.bitstreamDataService=bitstreamDataService}ngOnInit(){super.ngOnInit(),this.dso=this.linkService.resolveLink(this.dso,(0,follow_link_config_model.l)("item")),this.item$=this.dso.item.pipe((0,operators.g1)(),(0,operators.xe)()),this.item$.pipe((0,cjs_operators.qn)(1)).subscribe(item=>{const componentFactory=this.componentFactoryResolver.resolveComponentFactory(this.getComponent(item)),viewContainerRef=this.listableObjectDirective.viewContainerRef;viewContainerRef.clear();const componentRef=viewContainerRef.createComponent(componentFactory,0,void 0,[[this.badges.nativeElement],[this.buttons.nativeElement]]);componentRef.instance.object=item,componentRef.instance.index=this.index,componentRef.instance.linkType=this.linkType,componentRef.instance.listID=this.listID,componentRef.changeDetectorRef.detectChanges()})}getComponent(item){return(0,listable_object_decorator.mt)(item.getRenderTypes(),view_mode_model.w.GridElement,void 0,this.themeService.getThemeName())}},"WorkflowItemSearchResultAdminWorkflowGridElementComponent");WorkflowItemSearchResultAdminWorkflowGridElementComponent.\u0275fac=__name(function(t){return new(t||WorkflowItemSearchResultAdminWorkflowGridElementComponent)(core.Y36(core._Vd),core.Y36(link_service.M),core.Y36(truncatable_service.F),core.Y36(theme_service.fY),core.Y36(bitstream_data_service.J))},"WorkflowItemSearchResultAdminWorkflowGridElementComponent_Factory"),WorkflowItemSearchResultAdminWorkflowGridElementComponent.\u0275cmp=core.Xpm({type:WorkflowItemSearchResultAdminWorkflowGridElementComponent,selectors:[["ds-workflow-item-search-result-admin-workflow-grid-element"]],viewQuery:__name(function(rf,ctx){if(1&rf&&(core.Gf(listable_object_directive.U,7),core.Gf(workflow_item_search_result_admin_workflow_grid_element_component_c0,7),core.Gf(workflow_item_search_result_admin_workflow_grid_element_component_c1,7)),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.listableObjectDirective=_t.first),core.iGM(_t=core.CRH())&&(ctx.badges=_t.first),core.iGM(_t=core.CRH())&&(ctx.buttons=_t.first)}},"WorkflowItemSearchResultAdminWorkflowGridElementComponent_Query"),features:[core.qOj],decls:11,vars:4,consts:[["dsListableObject",""],[1,"position-absolute","ml-1"],["badges",""],[1,"workflow-badge"],[1,"badge","badge-info"],[1,"list-group","list-group-flush"],["buttons",""],[1,"list-group-item"],["class","d-flex justify-content-between",3,"wfi","small",4,"ngIf"],[1,"d-flex","justify-content-between",3,"wfi","small"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,WorkflowItemSearchResultAdminWorkflowGridElementComponent_ng_template_0_Template,0,0,"ng-template",0),core.TgZ(1,"div",1,2)(3,"div",3)(4,"span",4),core._uU(5),core.ALo(6,"translate"),core.qZA()()(),core.TgZ(7,"ul",5,6)(9,"li",7),core.YNc(10,WorkflowItemSearchResultAdminWorkflowGridElementComponent_ds_workflow_item_admin_workflow_actions_element_10_Template,1,2,"ds-workflow-item-admin-workflow-actions-element",8),core.qZA()()),2&rf&&(core.xp6(5),core.Oqu(core.lcZ(6,2,"admin.workflow.item.workflow")),core.xp6(5),core.Q6J("ngIf",ctx.object))},"WorkflowItemSearchResultAdminWorkflowGridElementComponent_Template"),directives:[listable_object_directive.U,common.O5,WorkflowItemAdminWorkflowActionsComponent],pipes:[ngx_translate_core.X$],styles:[""]}),WorkflowItemSearchResultAdminWorkflowGridElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(workflow_item_search_result_model.s,view_mode_model.w.GridElement,context_model._.AdminWorkflowSearch),(0,tslib_es6.__metadata)("design:paramtypes",[core._Vd,link_service.M,truncatable_service.F,theme_service.fY,bitstream_data_service.J])],WorkflowItemSearchResultAdminWorkflowGridElementComponent);var search_result_list_element_component=__webpack_require__(83625),app_config_interface=__webpack_require__(19349),listable_object_component_loader_component=__webpack_require__(99967);function WorkflowItemSearchResultAdminWorkflowListElementComponent_ds_listable_object_component_loader_4_Template(rf,ctx){if(1&rf&&(core._UZ(0,"ds-listable-object-component-loader",4),core.ALo(1,"async")),2&rf){const ctx_r0=core.oxw();core.Q6J("object",core.lcZ(1,5,ctx_r0.item$))("viewMode",ctx_r0.viewModes.ListElement)("index",ctx_r0.index)("linkType",ctx_r0.linkType)("listID",ctx_r0.listID)}}__name(WorkflowItemSearchResultAdminWorkflowListElementComponent_ds_listable_object_component_loader_4_Template,"WorkflowItemSearchResultAdminWorkflowListElementComponent_ds_listable_object_component_loader_4_Template");let WorkflowItemSearchResultAdminWorkflowListElementComponent=__name(class extends search_result_list_element_component.c{constructor(linkService,truncatableService,dsoNameService,appConfig){super(truncatableService,dsoNameService,appConfig),this.linkService=linkService,this.truncatableService=truncatableService,this.dsoNameService=dsoNameService,this.appConfig=appConfig}ngOnInit(){super.ngOnInit(),this.dso=this.linkService.resolveLink(this.dso,(0,follow_link_config_model.l)("item")),this.item$=this.dso.item.pipe((0,operators.g1)(),(0,operators.xe)())}},"WorkflowItemSearchResultAdminWorkflowListElementComponent");WorkflowItemSearchResultAdminWorkflowListElementComponent.\u0275fac=__name(function(t){return new(t||WorkflowItemSearchResultAdminWorkflowListElementComponent)(core.Y36(link_service.M),core.Y36(truncatable_service.F),core.Y36(dso_name_service._),core.Y36(app_config_interface.q))},"WorkflowItemSearchResultAdminWorkflowListElementComponent_Factory"),WorkflowItemSearchResultAdminWorkflowListElementComponent.\u0275cmp=core.Xpm({type:WorkflowItemSearchResultAdminWorkflowListElementComponent,selectors:[["ds-workflow-item-search-result-admin-workflow-list-element"]],features:[core.qOj],decls:7,vars:8,consts:[[1,"workflow-badge"],[1,"badge","badge-info"],[3,"object","viewMode","index","linkType","listID",4,"ngIf"],[3,"wfi","small"],[3,"object","viewMode","index","linkType","listID"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"span",1),core._uU(2),core.ALo(3,"translate"),core.qZA()(),core.YNc(4,WorkflowItemSearchResultAdminWorkflowListElementComponent_ds_listable_object_component_loader_4_Template,2,7,"ds-listable-object-component-loader",2),core.ALo(5,"async"),core._UZ(6,"ds-workflow-item-admin-workflow-actions-element",3)),2&rf&&(core.xp6(2),core.Oqu(core.lcZ(3,4,"admin.workflow.item.workflow")),core.xp6(2),core.Q6J("ngIf",core.lcZ(5,6,ctx.item$)),core.xp6(2),core.Q6J("wfi",ctx.dso)("small",!1))},"WorkflowItemSearchResultAdminWorkflowListElementComponent_Template"),directives:[common.O5,listable_object_component_loader_component.p,WorkflowItemAdminWorkflowActionsComponent],pipes:[ngx_translate_core.X$,common.Ov],styles:[""]}),WorkflowItemSearchResultAdminWorkflowListElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(workflow_item_search_result_model.s,view_mode_model.w.ListElement,context_model._.AdminWorkflowSearch),(0,tslib_es6.__metadata)("design:paramtypes",[link_service.M,truncatable_service.F,dso_name_service._,Object])],WorkflowItemSearchResultAdminWorkflowListElementComponent);var search_module=__webpack_require__(24277);const ENTRY_COMPONENTS=[WorkflowItemSearchResultAdminWorkflowListElementComponent,WorkflowItemSearchResultAdminWorkflowGridElementComponent];class AdminWorkflowModuleModule{static withEntryComponents(){return{ngModule:shared_module.m,providers:ENTRY_COMPONENTS.map(component=>({provide:component}))}}}__name(AdminWorkflowModuleModule,"AdminWorkflowModuleModule"),AdminWorkflowModuleModule.\u0275fac=__name(function(t){return new(t||AdminWorkflowModuleModule)},"AdminWorkflowModuleModule_Factory"),AdminWorkflowModuleModule.\u0275mod=core.oAB({type:AdminWorkflowModuleModule}),AdminWorkflowModuleModule.\u0275inj=core.cJS({imports:[[search_module.t,shared_module.m.withEntryComponents()]]});var item_search_result_model=__webpack_require__(11771),url_combiner=(__webpack_require__(27899),__webpack_require__(69810)),item_page_routing_paths=__webpack_require__(96007),edit_item_page_routing_paths=__webpack_require__(40238);function ItemAdminSearchResultActionsComponent_span_4_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",12),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.search.item.move"),""))}function ItemAdminSearchResultActionsComponent_a_5_span_3_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",12),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.search.item.make-private"),""))}__name(ItemAdminSearchResultActionsComponent_span_4_Template,"ItemAdminSearchResultActionsComponent_span_4_Template"),__name(ItemAdminSearchResultActionsComponent_a_5_span_3_Template,"ItemAdminSearchResultActionsComponent_a_5_span_3_Template");const item_admin_search_result_actions_component_c0=__name(function(a0){return{"btn-sm":a0}},"item_admin_search_result_actions_component_c0"),item_admin_search_result_actions_component_c1=__name(function(a0){return[a0]},"item_admin_search_result_actions_component_c1");function ItemAdminSearchResultActionsComponent_a_5_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"a",13),core.ALo(1,"translate"),core._UZ(2,"i",14),core.YNc(3,ItemAdminSearchResultActionsComponent_a_5_span_3_Template,3,3,"span",3),core.qZA()),2&rf){const ctx_r1=core.oxw();core.Q6J("ngClass",core.VKq(6,item_admin_search_result_actions_component_c0,ctx_r1.small))("routerLink",core.VKq(8,item_admin_search_result_actions_component_c1,ctx_r1.getPrivateRoute()))("title",core.lcZ(1,4,"admin.search.item.make-private")),core.xp6(3),core.Q6J("ngIf",!ctx_r1.small)}}function ItemAdminSearchResultActionsComponent_a_6_span_3_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",12),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.search.item.make-public"),""))}function ItemAdminSearchResultActionsComponent_a_6_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"a",15),core.ALo(1,"translate"),core._UZ(2,"i",16),core.YNc(3,ItemAdminSearchResultActionsComponent_a_6_span_3_Template,3,3,"span",3),core.qZA()),2&rf){const ctx_r2=core.oxw();core.Q6J("ngClass",core.VKq(6,item_admin_search_result_actions_component_c0,ctx_r2.small))("routerLink",core.VKq(8,item_admin_search_result_actions_component_c1,ctx_r2.getPublicRoute()))("title",core.lcZ(1,4,"admin.search.item.make-public")),core.xp6(3),core.Q6J("ngIf",!ctx_r2.small)}}function ItemAdminSearchResultActionsComponent_span_10_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",12),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.search.item.edit"),""))}function ItemAdminSearchResultActionsComponent_a_11_span_3_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",12),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.search.item.withdraw"),""))}function ItemAdminSearchResultActionsComponent_a_11_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"a",17),core.ALo(1,"translate"),core._UZ(2,"i",18),core.YNc(3,ItemAdminSearchResultActionsComponent_a_11_span_3_Template,3,3,"span",3),core.qZA()),2&rf){const ctx_r4=core.oxw();core.Q6J("ngClass",core.VKq(6,item_admin_search_result_actions_component_c0,ctx_r4.small))("routerLink",core.VKq(8,item_admin_search_result_actions_component_c1,ctx_r4.getWithdrawRoute()))("title",core.lcZ(1,4,"admin.search.item.withdraw")),core.xp6(3),core.Q6J("ngIf",!ctx_r4.small)}}function ItemAdminSearchResultActionsComponent_a_12_span_3_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",12),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.search.item.reinstate"),""))}function ItemAdminSearchResultActionsComponent_a_12_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"a",19),core.ALo(1,"translate"),core._UZ(2,"i",20),core.YNc(3,ItemAdminSearchResultActionsComponent_a_12_span_3_Template,3,3,"span",3),core.qZA()),2&rf){const ctx_r5=core.oxw();core.Q6J("ngClass",core.VKq(6,item_admin_search_result_actions_component_c0,ctx_r5.small))("routerLink",core.VKq(8,item_admin_search_result_actions_component_c1,ctx_r5.getReinstateRoute()))("title",core.lcZ(1,4,"admin.search.item.reinstate")),core.xp6(3),core.Q6J("ngIf",!ctx_r5.small)}}function ItemAdminSearchResultActionsComponent_span_16_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",12),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"admin.search.item.delete"),""))}__name(ItemAdminSearchResultActionsComponent_a_5_Template,"ItemAdminSearchResultActionsComponent_a_5_Template"),__name(ItemAdminSearchResultActionsComponent_a_6_span_3_Template,"ItemAdminSearchResultActionsComponent_a_6_span_3_Template"),__name(ItemAdminSearchResultActionsComponent_a_6_Template,"ItemAdminSearchResultActionsComponent_a_6_Template"),__name(ItemAdminSearchResultActionsComponent_span_10_Template,"ItemAdminSearchResultActionsComponent_span_10_Template"),__name(ItemAdminSearchResultActionsComponent_a_11_span_3_Template,"ItemAdminSearchResultActionsComponent_a_11_span_3_Template"),__name(ItemAdminSearchResultActionsComponent_a_11_Template,"ItemAdminSearchResultActionsComponent_a_11_Template"),__name(ItemAdminSearchResultActionsComponent_a_12_span_3_Template,"ItemAdminSearchResultActionsComponent_a_12_span_3_Template"),__name(ItemAdminSearchResultActionsComponent_a_12_Template,"ItemAdminSearchResultActionsComponent_a_12_Template"),__name(ItemAdminSearchResultActionsComponent_span_16_Template,"ItemAdminSearchResultActionsComponent_span_16_Template");class ItemAdminSearchResultActionsComponent{getEditRoute(){return(0,item_page_routing_paths.tn)(this.item)}getMoveRoute(){return new url_combiner.R(this.getEditRoute(),edit_item_page_routing_paths.Gr).toString()}getDeleteRoute(){return new url_combiner.R(this.getEditRoute(),edit_item_page_routing_paths.kJ).toString()}getWithdrawRoute(){return new url_combiner.R(this.getEditRoute(),edit_item_page_routing_paths.M0).toString()}getReinstateRoute(){return new url_combiner.R(this.getEditRoute(),edit_item_page_routing_paths.Pu).toString()}getPrivateRoute(){return new url_combiner.R(this.getEditRoute(),edit_item_page_routing_paths.X$).toString()}getPublicRoute(){return new url_combiner.R(this.getEditRoute(),edit_item_page_routing_paths.dI).toString()}}__name(ItemAdminSearchResultActionsComponent,"ItemAdminSearchResultActionsComponent"),ItemAdminSearchResultActionsComponent.\u0275fac=__name(function(t){return new(t||ItemAdminSearchResultActionsComponent)},"ItemAdminSearchResultActionsComponent_Factory"),ItemAdminSearchResultActionsComponent.\u0275cmp=core.Xpm({type:ItemAdminSearchResultActionsComponent,selectors:[["ds-item-admin-search-result-actions-element"]],inputs:{item:"item",small:"small"},decls:17,vars:34,consts:[[1,"space-children-mr","my-1"],[1,"btn","btn-secondary","move-link",3,"ngClass","routerLink","title"],[1,"fa","fa-arrow-circle-right"],["class","d-none d-sm-inline",4,"ngIf"],["class","btn btn-secondary private-link",3,"ngClass","routerLink","title",4,"ngIf"],["class","btn btn-secondary public-link",3,"ngClass","routerLink","title",4,"ngIf"],[1,"btn","btn-secondary","edit-link",3,"ngClass","routerLink","title"],[1,"fa","fa-edit"],["class","btn btn-warning t withdraw-link",3,"ngClass","routerLink","title",4,"ngIf"],["class","btn btn-warning reinstate-link",3,"ngClass","routerLink","title",4,"ngIf"],[1,"btn","btn-danger","delete-link",3,"ngClass","routerLink","title"],[1,"fa","fa-trash"],[1,"d-none","d-sm-inline"],[1,"btn","btn-secondary","private-link",3,"ngClass","routerLink","title"],[1,"fa","fa-eye-slash"],[1,"btn","btn-secondary","public-link",3,"ngClass","routerLink","title"],[1,"fa","fa-eye"],[1,"btn","btn-warning","t","withdraw-link",3,"ngClass","routerLink","title"],[1,"fa","fa-ban"],[1,"btn","btn-warning","reinstate-link",3,"ngClass","routerLink","title"],[1,"fa","fa-undo"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"a",1),core.ALo(2,"translate"),core._UZ(3,"i",2),core.YNc(4,ItemAdminSearchResultActionsComponent_span_4_Template,3,3,"span",3),core.qZA(),core.YNc(5,ItemAdminSearchResultActionsComponent_a_5_Template,4,10,"a",4),core.YNc(6,ItemAdminSearchResultActionsComponent_a_6_Template,4,10,"a",5),core.TgZ(7,"a",6),core.ALo(8,"translate"),core._UZ(9,"i",7),core.YNc(10,ItemAdminSearchResultActionsComponent_span_10_Template,3,3,"span",3),core.qZA(),core.YNc(11,ItemAdminSearchResultActionsComponent_a_11_Template,4,10,"a",8),core.YNc(12,ItemAdminSearchResultActionsComponent_a_12_Template,4,10,"a",9),core.TgZ(13,"a",10),core.ALo(14,"translate"),core._UZ(15,"i",11),core.YNc(16,ItemAdminSearchResultActionsComponent_span_16_Template,3,3,"span",3),core.qZA()()),2&rf&&(core.xp6(1),core.Q6J("ngClass",core.VKq(22,item_admin_search_result_actions_component_c0,ctx.small))("routerLink",core.VKq(24,item_admin_search_result_actions_component_c1,ctx.getMoveRoute()))("title",core.lcZ(2,16,"admin.search.item.move")),core.xp6(3),core.Q6J("ngIf",!ctx.small),core.xp6(1),core.Q6J("ngIf",ctx.item&&ctx.item.isDiscoverable),core.xp6(1),core.Q6J("ngIf",ctx.item&&!ctx.item.isDiscoverable),core.xp6(1),core.Q6J("ngClass",core.VKq(26,item_admin_search_result_actions_component_c0,ctx.small))("routerLink",core.VKq(28,item_admin_search_result_actions_component_c1,ctx.getEditRoute()))("title",core.lcZ(8,18,"admin.search.item.edit")),core.xp6(3),core.Q6J("ngIf",!ctx.small),core.xp6(1),core.Q6J("ngIf",ctx.item&&!ctx.item.isWithdrawn),core.xp6(1),core.Q6J("ngIf",ctx.item&&ctx.item.isWithdrawn),core.xp6(1),core.Q6J("ngClass",core.VKq(30,item_admin_search_result_actions_component_c0,ctx.small))("routerLink",core.VKq(32,item_admin_search_result_actions_component_c1,ctx.getDeleteRoute()))("title",core.lcZ(14,20,"admin.search.item.delete")),core.xp6(3),core.Q6J("ngIf",!ctx.small))},"ItemAdminSearchResultActionsComponent_Template"),directives:[router.yS,common.mk,common.O5],pipes:[ngx_translate_core.X$],styles:[""]});let ItemAdminSearchResultListElementComponent=__name(class extends search_result_list_element_component.c{},"ItemAdminSearchResultListElementComponent");ItemAdminSearchResultListElementComponent.\u0275fac=function(){let \u0275ItemAdminSearchResultListElementComponent_BaseFactory;return __name(function(t){return(\u0275ItemAdminSearchResultListElementComponent_BaseFactory||(\u0275ItemAdminSearchResultListElementComponent_BaseFactory=core.n5z(ItemAdminSearchResultListElementComponent)))(t||ItemAdminSearchResultListElementComponent)},"ItemAdminSearchResultListElementComponent_Factory")}(),ItemAdminSearchResultListElementComponent.\u0275cmp=core.Xpm({type:ItemAdminSearchResultListElementComponent,selectors:[["ds-item-admin-search-result-list-element"]],features:[core.qOj],decls:2,vars:8,consts:[[3,"object","viewMode","index","linkType","listID","hideBadges"],[3,"item","small"]],template:__name(function(rf,ctx){1&rf&&core._UZ(0,"ds-listable-object-component-loader",0)(1,"ds-item-admin-search-result-actions-element",1),2&rf&&(core.Q6J("object",ctx.object)("viewMode",ctx.viewModes.ListElement)("index",ctx.index)("linkType",ctx.linkType)("listID",ctx.listID)("hideBadges",!0),core.xp6(1),core.Q6J("item",ctx.dso)("small",!1))},"ItemAdminSearchResultListElementComponent_Template"),directives:[listable_object_component_loader_component.p,ItemAdminSearchResultActionsComponent],styles:[""]}),ItemAdminSearchResultListElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(item_search_result_model.T,view_mode_model.w.ListElement,context_model._.AdminSearch)],ItemAdminSearchResultListElementComponent);var community_search_result_model=__webpack_require__(35540),community_page_routing_paths=__webpack_require__(18595),community_search_result_list_element_component=__webpack_require__(36127);const community_admin_search_result_list_element_component_c0=__name(function(a0){return[a0]},"community_admin_search_result_list_element_component_c0");let CommunityAdminSearchResultListElementComponent=__name(class extends search_result_list_element_component.c{ngOnInit(){super.ngOnInit(),this.editPath=(0,community_page_routing_paths.xm)(this.dso.uuid)}},"CommunityAdminSearchResultListElementComponent");CommunityAdminSearchResultListElementComponent.\u0275fac=function(){let \u0275CommunityAdminSearchResultListElementComponent_BaseFactory;return __name(function(t){return(\u0275CommunityAdminSearchResultListElementComponent_BaseFactory||(\u0275CommunityAdminSearchResultListElementComponent_BaseFactory=core.n5z(CommunityAdminSearchResultListElementComponent)))(t||CommunityAdminSearchResultListElementComponent)},"CommunityAdminSearchResultListElementComponent_Factory")}(),CommunityAdminSearchResultListElementComponent.\u0275cmp=core.Xpm({type:CommunityAdminSearchResultListElementComponent,selectors:[["ds-community-admin-search-result-list-element"]],features:[core.qOj],decls:6,vars:10,consts:[[3,"object","index","linkType","listID"],[1,"btn","btn-light","mt-1",3,"routerLink"],[1,"fa","fa-edit"]],template:__name(function(rf,ctx){1&rf&&(core._UZ(0,"ds-community-search-result-list-element",0),core.TgZ(1,"div")(2,"a",1),core._UZ(3,"i",2),core._uU(4),core.ALo(5,"translate"),core.qZA()()),2&rf&&(core.Q6J("object",ctx.object)("index",ctx.index)("linkType",ctx.linkType)("listID",ctx.listID),core.xp6(2),core.Q6J("routerLink",core.VKq(8,community_admin_search_result_list_element_component_c0,ctx.editPath)),core.xp6(2),core.hij(" ",core.lcZ(5,6,"admin.search.community.edit")," "))},"CommunityAdminSearchResultListElementComponent_Template"),directives:[community_search_result_list_element_component.K,router.yS],pipes:[ngx_translate_core.X$],styles:[""]}),CommunityAdminSearchResultListElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(community_search_result_model.o,view_mode_model.w.ListElement,context_model._.AdminSearch)],CommunityAdminSearchResultListElementComponent);var collection_search_result_model=__webpack_require__(35587),collection_page_routing_paths=__webpack_require__(10954),collection_search_result_list_element_component=__webpack_require__(67734);const collection_admin_search_result_list_element_component_c0=__name(function(a0){return[a0]},"collection_admin_search_result_list_element_component_c0");let CollectionAdminSearchResultListElementComponent=__name(class extends search_result_list_element_component.c{ngOnInit(){super.ngOnInit(),this.editPath=(0,collection_page_routing_paths.Ou)(this.dso.uuid)}},"CollectionAdminSearchResultListElementComponent");CollectionAdminSearchResultListElementComponent.\u0275fac=function(){let \u0275CollectionAdminSearchResultListElementComponent_BaseFactory;return __name(function(t){return(\u0275CollectionAdminSearchResultListElementComponent_BaseFactory||(\u0275CollectionAdminSearchResultListElementComponent_BaseFactory=core.n5z(CollectionAdminSearchResultListElementComponent)))(t||CollectionAdminSearchResultListElementComponent)},"CollectionAdminSearchResultListElementComponent_Factory")}(),CollectionAdminSearchResultListElementComponent.\u0275cmp=core.Xpm({type:CollectionAdminSearchResultListElementComponent,selectors:[["ds-collection-admin-search-result-list-element"]],features:[core.qOj],decls:6,vars:10,consts:[[3,"object","index","linkType","listID"],[1,"btn","btn-light","mt-1",3,"routerLink"],[1,"fa","fa-edit"]],template:__name(function(rf,ctx){1&rf&&(core._UZ(0,"ds-collection-search-result-list-element",0),core.TgZ(1,"div")(2,"a",1),core._UZ(3,"i",2),core._uU(4),core.ALo(5,"translate"),core.qZA()()),2&rf&&(core.Q6J("object",ctx.object)("index",ctx.index)("linkType",ctx.linkType)("listID",ctx.listID),core.xp6(2),core.Q6J("routerLink",core.VKq(8,collection_admin_search_result_list_element_component_c0,ctx.editPath)),core.xp6(2),core.hij(" ",core.lcZ(5,6,"admin.search.collection.edit")," "))},"CollectionAdminSearchResultListElementComponent_Template"),directives:[collection_search_result_list_element_component.q,router.yS],pipes:[ngx_translate_core.X$],styles:[""]}),CollectionAdminSearchResultListElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(collection_search_result_model.o,view_mode_model.w.ListElement,context_model._.AdminSearch)],CollectionAdminSearchResultListElementComponent);const item_admin_search_result_grid_element_component_c0=["badges"],item_admin_search_result_grid_element_component_c1=["buttons"];function ItemAdminSearchResultGridElementComponent_ng_template_0_Template(rf,ctx){}__name(ItemAdminSearchResultGridElementComponent_ng_template_0_Template,"ItemAdminSearchResultGridElementComponent_ng_template_0_Template");let ItemAdminSearchResultGridElementComponent=__name(class extends search_result_grid_element_component.h{constructor(truncatableService,bitstreamDataService,themeService,componentFactoryResolver){super(truncatableService,bitstreamDataService),this.truncatableService=truncatableService,this.bitstreamDataService=bitstreamDataService,this.themeService=themeService,this.componentFactoryResolver=componentFactoryResolver}ngOnInit(){super.ngOnInit();const componentFactory=this.componentFactoryResolver.resolveComponentFactory(this.getComponent()),viewContainerRef=this.listableObjectDirective.viewContainerRef;viewContainerRef.clear();const componentRef=viewContainerRef.createComponent(componentFactory,0,void 0,[[this.badges.nativeElement],[this.buttons.nativeElement]]);componentRef.instance.object=this.object,componentRef.instance.index=this.index,componentRef.instance.linkType=this.linkType,componentRef.instance.listID=this.listID}getComponent(){return(0,listable_object_decorator.mt)(this.object.getRenderTypes(),view_mode_model.w.GridElement,void 0,this.themeService.getThemeName())}},"ItemAdminSearchResultGridElementComponent");ItemAdminSearchResultGridElementComponent.\u0275fac=__name(function(t){return new(t||ItemAdminSearchResultGridElementComponent)(core.Y36(truncatable_service.F),core.Y36(bitstream_data_service.J),core.Y36(theme_service.fY),core.Y36(core._Vd))},"ItemAdminSearchResultGridElementComponent_Factory"),ItemAdminSearchResultGridElementComponent.\u0275cmp=core.Xpm({type:ItemAdminSearchResultGridElementComponent,selectors:[["ds-item-admin-search-result-grid-element"]],viewQuery:__name(function(rf,ctx){if(1&rf&&(core.Gf(listable_object_directive.U,7),core.Gf(item_admin_search_result_grid_element_component_c0,7),core.Gf(item_admin_search_result_grid_element_component_c1,7)),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.listableObjectDirective=_t.first),core.iGM(_t=core.CRH())&&(ctx.badges=_t.first),core.iGM(_t=core.CRH())&&(ctx.buttons=_t.first)}},"ItemAdminSearchResultGridElementComponent_Query"),features:[core.qOj],ngContentSelectors:["*"],decls:8,vars:2,consts:[["dsListableObject",""],["badges",""],[1,"list-group","list-group-flush"],["buttons",""],[1,"list-group-item"],[1,"d-flex","justify-content-between",3,"item","small"]],template:__name(function(rf,ctx){1&rf&&(core.F$t(),core.YNc(0,ItemAdminSearchResultGridElementComponent_ng_template_0_Template,0,0,"ng-template",0),core.TgZ(1,"div",null,1),core.Hsn(3),core.qZA(),core.TgZ(4,"ul",2,3)(6,"li",4),core._UZ(7,"ds-item-admin-search-result-actions-element",5),core.qZA()()),2&rf&&(core.xp6(7),core.Q6J("item",ctx.dso)("small",!0))},"ItemAdminSearchResultGridElementComponent_Template"),directives:[listable_object_directive.U,ItemAdminSearchResultActionsComponent],styles:[""]}),ItemAdminSearchResultGridElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(item_search_result_model.T,view_mode_model.w.GridElement,context_model._.AdminSearch),(0,tslib_es6.__metadata)("design:paramtypes",[truncatable_service.F,bitstream_data_service.J,theme_service.fY,core._Vd])],ItemAdminSearchResultGridElementComponent);var community_search_result_grid_element_component=__webpack_require__(1579);const community_admin_search_result_grid_element_component_c0=__name(function(a0){return[a0]},"community_admin_search_result_grid_element_component_c0");let CommunityAdminSearchResultGridElementComponent=__name(class extends search_result_grid_element_component.h{ngOnInit(){super.ngOnInit(),this.editPath=(0,community_page_routing_paths.xm)(this.dso.uuid)}},"CommunityAdminSearchResultGridElementComponent");CommunityAdminSearchResultGridElementComponent.\u0275fac=function(){let \u0275CommunityAdminSearchResultGridElementComponent_BaseFactory;return __name(function(t){return(\u0275CommunityAdminSearchResultGridElementComponent_BaseFactory||(\u0275CommunityAdminSearchResultGridElementComponent_BaseFactory=core.n5z(CommunityAdminSearchResultGridElementComponent)))(t||CommunityAdminSearchResultGridElementComponent)},"CommunityAdminSearchResultGridElementComponent_Factory")}(),CommunityAdminSearchResultGridElementComponent.\u0275cmp=core.Xpm({type:CommunityAdminSearchResultGridElementComponent,selectors:[["ds-community-admin-search-result-grid-element"]],features:[core.qOj],decls:5,vars:7,consts:[[3,"object","index","linkType","listID"],[1,"list-group","list-group-flush"],[1,"list-group-item","text-center"],[1,"btn","btn-light","btn-sm","btn-auto","my-1","edit-link",3,"routerLink"],[1,"fa","fa-edit"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"ds-community-search-result-grid-element",0)(1,"ul",1)(2,"li",2)(3,"a",3),core._UZ(4,"i",4),core.qZA()()()()),2&rf&&(core.Q6J("object",ctx.object)("index",ctx.index)("linkType",ctx.linkType)("listID",ctx.listID),core.xp6(3),core.Q6J("routerLink",core.VKq(5,community_admin_search_result_grid_element_component_c0,ctx.editPath)))},"CommunityAdminSearchResultGridElementComponent_Template"),directives:[community_search_result_grid_element_component.g,router.yS],styles:[""]}),CommunityAdminSearchResultGridElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(community_search_result_model.o,view_mode_model.w.GridElement,context_model._.AdminSearch)],CommunityAdminSearchResultGridElementComponent);var collection_search_result_grid_element_component=__webpack_require__(29836);const collection_admin_search_result_grid_element_component_c0=__name(function(a0){return[a0]},"collection_admin_search_result_grid_element_component_c0");let CollectionAdminSearchResultGridElementComponent=__name(class extends search_result_grid_element_component.h{ngOnInit(){super.ngOnInit(),this.editPath=(0,collection_page_routing_paths.Ou)(this.dso.uuid)}},"CollectionAdminSearchResultGridElementComponent");CollectionAdminSearchResultGridElementComponent.\u0275fac=function(){let \u0275CollectionAdminSearchResultGridElementComponent_BaseFactory;return __name(function(t){return(\u0275CollectionAdminSearchResultGridElementComponent_BaseFactory||(\u0275CollectionAdminSearchResultGridElementComponent_BaseFactory=core.n5z(CollectionAdminSearchResultGridElementComponent)))(t||CollectionAdminSearchResultGridElementComponent)},"CollectionAdminSearchResultGridElementComponent_Factory")}(),CollectionAdminSearchResultGridElementComponent.\u0275cmp=core.Xpm({type:CollectionAdminSearchResultGridElementComponent,selectors:[["ds-collection-admin-search-result-list-element"]],features:[core.qOj],decls:5,vars:7,consts:[[3,"object","index","linkType","listID"],[1,"list-group","list-group-flush"],[1,"list-group-item","text-center"],[1,"btn","btn-light","btn-sm","btn-auto","my-1","edit-link",3,"routerLink"],[1,"fa","fa-edit"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"ds-collection-search-result-grid-element",0)(1,"ul",1)(2,"li",2)(3,"a",3),core._UZ(4,"i",4),core.qZA()()()()),2&rf&&(core.Q6J("object",ctx.object)("index",ctx.index)("linkType",ctx.linkType)("listID",ctx.listID),core.xp6(3),core.Q6J("routerLink",core.VKq(5,collection_admin_search_result_grid_element_component_c0,ctx.editPath)))},"CollectionAdminSearchResultGridElementComponent_Template"),directives:[collection_search_result_grid_element_component.a,router.yS],styles:[""]}),CollectionAdminSearchResultGridElementComponent=(0,tslib_es6.__decorate)([(0,listable_object_decorator.d$)(collection_search_result_model.o,view_mode_model.w.GridElement,context_model._.AdminSearch)],CollectionAdminSearchResultGridElementComponent);var journal_entities_module=__webpack_require__(30504),research_entities_module=__webpack_require__(42245);const admin_search_module_ENTRY_COMPONENTS=[ItemAdminSearchResultListElementComponent,CommunityAdminSearchResultListElementComponent,CollectionAdminSearchResultListElementComponent,ItemAdminSearchResultGridElementComponent,CommunityAdminSearchResultGridElementComponent,CollectionAdminSearchResultGridElementComponent,ItemAdminSearchResultActionsComponent];class AdminSearchModule{static withEntryComponents(){return{ngModule:shared_module.m,providers:admin_search_module_ENTRY_COMPONENTS.map(component=>({provide:component}))}}}__name(AdminSearchModule,"AdminSearchModule"),AdminSearchModule.\u0275fac=__name(function(t){return new(t||AdminSearchModule)},"AdminSearchModule_Factory"),AdminSearchModule.\u0275mod=core.oAB({type:AdminSearchModule}),AdminSearchModule.\u0275inj=core.cJS({imports:[[search_module.t,shared_module.m.withEntryComponents(),journal_entities_module.x.withEntryComponents(),research_entities_module.a.withEntryComponents()]]});var admin_sidebar_section_component=__webpack_require__(83067),expandable_admin_sidebar_section_component=__webpack_require__(49913);const admin_module_ENTRY_COMPONENTS=[admin_sidebar_section_component.F,expandable_admin_sidebar_section_component.O];class AdminModule{static withEntryComponents(){return{ngModule:AdminModule,providers:admin_module_ENTRY_COMPONENTS.map(component=>({provide:component}))}}}__name(AdminModule,"AdminModule"),AdminModule.\u0275fac=__name(function(t){return new(t||AdminModule)},"AdminModule_Factory"),AdminModule.\u0275mod=core.oAB({type:AdminModule}),AdminModule.\u0275inj=core.cJS({imports:[[AdminRoutingModule,admin_registries_module.AdminRegistriesModule,access_control_module.AccessControlModule,AdminSearchModule.withEntryComponents(),AdminWorkflowModuleModule.withEntryComponents(),shared_module.m]]})},37188:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>EpersonRegistrationService});var request_service=__webpack_require__(37958),hal_endpoint_service=__webpack_require__(19339),request_models=__webpack_require__(61449),operators=__webpack_require__(5796),empty_util=__webpack_require__(25839),registration_model=__webpack_require__(53116),shared_operators=__webpack_require__(63281),response_models=__webpack_require__(47820),core=__webpack_require__(70074);class RegistrationResponseParsingService{parse(request,data){const payload=data.payload,registration=Object.assign(new registration_model.Y,payload);return new response_models.tp(data.statusCode,void 0,registration)}}__name(RegistrationResponseParsingService,"RegistrationResponseParsingService"),RegistrationResponseParsingService.\u0275fac=__name(function(t){return new(t||RegistrationResponseParsingService)},"RegistrationResponseParsingService_Factory"),RegistrationResponseParsingService.\u0275prov=core.Yz7({token:RegistrationResponseParsingService,factory:RegistrationResponseParsingService.\u0275fac,providedIn:"root"});var remote_data_build_service=__webpack_require__(10303),http=__webpack_require__(78819);class EpersonRegistrationService{constructor(requestService,rdbService,halService){this.requestService=requestService,this.rdbService=rdbService,this.halService=halService,this.linkPath="registrations",this.searchByTokenPath="/search/findByToken?token="}getRegistrationEndpoint(){return this.halService.getEndpoint(this.linkPath)}getTokenSearchEndpoint(token){return this.halService.getEndpoint(this.linkPath).pipe((0,operators.hX)(href=>(0,empty_util.UE)(href)),(0,operators.UI)(href=>`${href}${this.searchByTokenPath}${token}`))}registerEmail(email,captchaToken=null){const registration=new registration_model.Y;registration.email=email;const requestId=this.requestService.generateRequestId(),href$=this.getRegistrationEndpoint(),options=Object.create({});let headers=new http.WM;return captchaToken&&(headers=headers.append("x-recaptcha-token",captchaToken)),options.headers=headers,href$.pipe((0,operators.sE)(href=>(0,empty_util.Uh)(href)),(0,operators.UI)(href=>{const request=new request_models.xo(requestId,href,registration,options);this.requestService.send(request)})).subscribe(),this.rdbService.buildFromRequestUUID(requestId).pipe((0,shared_operators.hC)())}searchByToken(token){const requestId=this.requestService.generateRequestId(),href$=this.getTokenSearchEndpoint(token).pipe((0,operators.sE)(href=>(0,empty_util.Uh)(href)));return href$.subscribe(href=>{const request=new request_models.Gl(requestId,href);Object.assign(request,{getResponseParser:()=>RegistrationResponseParsingService}),this.requestService.send(request,!0)}),this.rdbService.buildSingle(href$).pipe((0,operators.UI)(rd=>rd.hasSucceeded&&(0,empty_util.Uh)(rd.payload)?Object.assign(rd,{payload:Object.assign(rd.payload,{token})}):rd))}}__name(EpersonRegistrationService,"EpersonRegistrationService"),EpersonRegistrationService.\u0275fac=__name(function(t){return new(t||EpersonRegistrationService)(core.LFG(request_service.s),core.LFG(remote_data_build_service.Q),core.LFG(hal_endpoint_service.q))},"EpersonRegistrationService_Factory"),EpersonRegistrationService.\u0275prov=core.Yz7({token:EpersonRegistrationService,factory:EpersonRegistrationService.\u0275fac,providedIn:"root"})},72004:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>WorkflowItemSearchResult});var tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(70655),_core_submission_models_workflowitem_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41527),_search_models_search_result_model__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(46894),_search_search_result_element_decorator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91807);let WorkflowItemSearchResult=__name(class extends _search_models_search_result_model__WEBPACK_IMPORTED_MODULE_1__.l{},"WorkflowItemSearchResult");WorkflowItemSearchResult=(0,tslib__WEBPACK_IMPORTED_MODULE_3__.__decorate)([(0,_search_search_result_element_decorator__WEBPACK_IMPORTED_MODULE_2__.D)(_core_submission_models_workflowitem_model__WEBPACK_IMPORTED_MODULE_0__.p)],WorkflowItemSearchResult)}};