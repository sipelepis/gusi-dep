(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[4563],{9830:(N,x,t)=>{"use strict";t.r(x),t.d(x,{CommunityListPageComponent:()=>c});var s=t(70074),r=t(53508),p=t(86553);let c=(()=>{class l{}return l.\u0275fac=function(v){return new(v||l)},l.\u0275cmp=s.\u0275\u0275defineComponent({type:l,selectors:[["ds-community-list-page"]],decls:5,vars:3,consts:[[1,"container"]],template:function(v,u){1&v&&(s.\u0275\u0275elementStart(0,"div",0)(1,"h2"),s.\u0275\u0275text(2),s.\u0275\u0275pipe(3,"translate"),s.\u0275\u0275elementEnd(),s.\u0275\u0275element(4,"ds-themed-community-list"),s.\u0275\u0275elementEnd()),2&v&&(s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate(s.\u0275\u0275pipeBind1(3,1,"communityList.title")))},directives:[r.J],pipes:[p.X$],encapsulation:2}),l})()},24563:(N,x,t)=>{"use strict";t.r(x),t.d(x,{CommunityListPageModule:()=>M});var s=t(10210),r=t(66004),c=(t(9830),t(37895)),l=t(47722),g=t(42466),v=t(46533),u=t(70074);function F(m,L){}let e=(()=>{class m extends v.F{getComponentName(){return"CommunityListPageComponent"}importThemedComponent(P){return t(94015)(`./${P}/app/community-list-page/community-list-page.component`)}importUnthemedComponent(){return Promise.resolve().then(t.bind(t,9830))}}return m.\u0275fac=function(){let L;return function(U){return(L||(L=u.\u0275\u0275getInheritedFactory(m)))(U||m)}}(),m.\u0275cmp=u.\u0275\u0275defineComponent({type:m,selectors:[["ds-themed-community-list-page"]],features:[u.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["vcr",""]],template:function(P,U){1&P&&u.\u0275\u0275template(0,F,0,0,"ng-template",null,0,u.\u0275\u0275templateRefExtractor)},encapsulation:2}),m})();var O=t(64561);let B=(()=>{class m{}return m.\u0275fac=function(P){return new(P||m)},m.\u0275mod=u.\u0275\u0275defineNgModule({type:m}),m.\u0275inj=u.\u0275\u0275defineInjector({providers:[g.rv],imports:[[c.Bz.forChild([{path:"",component:e,pathMatch:"full",resolve:{breadcrumb:O.t},data:{title:"communityList.tabTitle",breadcrumbKey:"communityList"}}]),l.nZ]]}),m})();t(66143),t(53508);let M=(()=>{class m{}return m.\u0275fac=function(P){return new(P||m)},m.\u0275mod=u.\u0275\u0275defineNgModule({type:m}),m.\u0275inj=u.\u0275\u0275defineInjector({imports:[[s.ez,r.m,B]]}),m})()},42466:(N,x,t)=>{"use strict";t.d(x,{rv:()=>a});var s=t(5328),r=t(53426),p=t(9237),c=t(48358),l=t(77007),g=t(21160),v=t(63749),u=t(70920),F=t(45419),e=t(25839),O=t(73535),B=t(64508),j=t(25013),R=t(18595),A=t(10954),M=t(5496),m=t(8183);class L{}var P=t(30292),U=t(19349),D=t(70074);const $=i=>(0,r.a)([...i]).pipe((0,c.U)(n=>[].concat(...n)),(0,l.h)(n=>n.every(o=>(0,e.Uh)(o)))),z=(i,n,o,d,f)=>({isExpandable$:n,name:i.name,id:i.id,level:o,isExpanded:d,parent:f,payload:i,isShowMoreNode:!1,route:i instanceof u.S?(0,R.Ke)(i.id):(0,A.MI)(i.id)}),K=(i,n,o)=>({isExpandable$:(0,p.of)(!1),name:"Show More Flatnode",id:i,level:n,isExpanded:!1,parent:o,payload:new L,isShowMoreNode:!0}),V=i=>i.communityList,X=(0,s.P1)(V,i=>i.expandedNodes),k=(0,s.P1)(V,i=>i.loadingNode);let a=(()=>{class i{constructor(o,d,f,C){this.appConfig=o,this.communityDataService=d,this.collectionDataService=f,this.store=C,this.configOnePage=Object.assign(new P.R,{elementsPerPage:1}),this.pageSize=o.communityList.pageSize}saveCommunityListStateToStore(o,d){this.store.dispatch(new j.Q(o,d))}getExpandedNodesFromStore(){return this.store.select(X)}getLoadingNodeFromStore(){return this.store.select(k)}loadCommunities(o,d){const f=o.currentPage,C=[];for(let y=1;y<=f;y++){const S=Object.assign({},o,{currentPage:y});C.push(this.getTopCommunities(S))}return(0,r.a)([...C]).pipe((0,c.U)(y=>{const S=y.map(W=>W.page),I=[].concat(...S);let b=new F.S;return y&&y.length>0&&(b=Object.assign({},y[0].pageInfo,{currentPage:f})),(0,O.b)(b,I)})).pipe((0,g.w)(y=>this.transformListOfCommunities(y,0,null,d)))}getTopCommunities(o){return this.communityDataService.findTop({currentPage:o.currentPage,elementsPerPage:this.pageSize,sort:{field:o.sort.field,direction:o.sort.direction}},(0,m.l)("subcommunities",{findListOptions:this.configOnePage}),(0,m.l)("collections",{findListOptions:this.configOnePage})).pipe((0,M.xw)(),(0,c.U)(d=>d.payload))}transformListOfCommunities(o,d,f,C){if((0,e.UE)(o.page)){let h=o.currentPage;(0,e.UE)(f)&&(h=C.find(S=>S.id===f.id).currentCommunityPage);let y=o.page.map(S=>this.transformCommunity(S,d,f,C));return h<o.totalPages&&h===o.currentPage&&(y=[...y,(0,p.of)([K("community",d,f)])]),$(y)}return(0,p.of)([])}transformCommunity(o,d,f,C){let h=!1;(0,e.UE)(C)&&(h=(0,e.Uh)(C.find(b=>b.id===o.id)));const y=this.getIsExpandable(o),S=z(o,y,d,h,f);let I=[(0,p.of)([S])];if(h){const b=C.find(E=>E.id===o.id).currentCommunityPage;let W=[];for(let E=1;E<=b;E++){const H=this.communityDataService.findByParent(o.uuid,{elementsPerPage:this.pageSize,currentPage:E},(0,m.l)("subcommunities",{findListOptions:this.configOnePage}),(0,m.l)("collections",{findListOptions:this.configOnePage})).pipe((0,M.hC)(),(0,g.w)(T=>(0,e.Uh)(T)&&(0,e.Uh)(T.payload)?this.transformListOfCommunities(T.payload,d+1,S,C):(0,p.of)([])));W=[...W,H]}I=[...I,$(W)];const J=C.find(E=>E.id===o.id).currentCollectionPage;let Z=[];for(let E=1;E<=J;E++){const H=this.collectionDataService.findByParent(o.uuid,{elementsPerPage:this.pageSize,currentPage:E}).pipe((0,M.hC)(),(0,c.U)(T=>{if((0,e.Uh)(T)&&(0,e.Uh)(T.payload)){let Q=T.payload.page.map(G=>z(G,(0,p.of)(!1),d+1,!1,S));return J<T.payload.totalPages&&J===T.payload.currentPage&&(Q=[...Q,K("collection",d+1,S)]),Q}return[]}));Z=[...Z,H]}I=[...I,$(Z)]}return $(I)}getIsExpandable(o){let d,f,C;return d=this.communityDataService.findByParent(o.uuid,this.configOnePage).pipe((0,c.U)(h=>!(!(0,e.Uh)(h)||!(0,e.Uh)(h.payload))&&h.payload.totalElements>0)),f=this.collectionDataService.findByParent(o.uuid,this.configOnePage).pipe((0,c.U)(h=>!(!(0,e.Uh)(h)||!(0,e.Uh)(h.payload))&&h.payload.totalElements>0)),C=(0,r.a)(d,f).pipe((0,c.U)(([h,y])=>h||y)),C}}return i.\u0275fac=function(o){return new(o||i)(D.\u0275\u0275inject(U.q),D.\u0275\u0275inject(v.w),D.\u0275\u0275inject(B.W),D.\u0275\u0275inject(s.yh))},i.\u0275prov=D.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i})()},66143:(N,x,t)=>{"use strict";t.r(x),t.d(x,{CommunityListComponent:()=>k});var s=t(77176),r=t(1367),p=t(42466),c=t(25839),l=t(35841),g=t(90410);class v{constructor(i){this.communityListService=i,this.communityList$=new l.X([]),this.loading$=new l.X(!1)}connect(i){return this.communityList$.asObservable()}loadCommunities(i,n){this.loading$.next(!0),(0,c.Uh)(this.subLoadCommunities)&&this.subLoadCommunities.unsubscribe(),this.subLoadCommunities=this.communityListService.loadCommunities(i,n).pipe((0,g.x)(()=>this.loading$.next(!1))).subscribe(o=>{this.communityList$.next(o)})}disconnect(i){this.communityList$.complete(),this.loading$.complete()}}var u=t(47722),F=t(30292),e=t(70074),O=t(10210),B=t(76924),j=t(37895),R=t(14748),A=t(71708),M=t(86553);function m(a,i){1&a&&e.\u0275\u0275element(0,"ds-themed-loading",5)}const L=function(){return[]};function P(a,i){if(1&a){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",14),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const d=e.\u0275\u0275nextContext().$implicit;return e.\u0275\u0275nextContext().getNextPage(d)}),e.\u0275\u0275element(1,"i",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()}2&a&&(e.\u0275\u0275property("routerLink",e.\u0275\u0275pureFunction0(4,L)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,2,"communityList.showMore")," "))}function U(a,i){1&a&&e.\u0275\u0275element(0,"ds-themed-loading",5)}function D(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"cdk-tree-node",6)(1,"div",7)(2,"button",8),e.\u0275\u0275element(3,"span",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",10),e.\u0275\u0275template(5,P,4,5,"a",11),e.\u0275\u0275template(6,U,1,0,"ds-themed-loading",0),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div",12),e.\u0275\u0275element(9,"div",13),e.\u0275\u0275elementEnd()()),2&a){const n=i.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",n!==o.loadingNode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,2,n===o.loadingNode&&o.dataSource.loading$))}}function $(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",13)(1,"button",23),e.\u0275\u0275element(2,"span",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"ds-truncatable-part",24)(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()()),2&a){const n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275classMap(n.isExpanded?"fa fa-chevron-down":"fa fa-chevron-right"),e.\u0275\u0275advance(1),e.\u0275\u0275property("id",n.id)("minLines",3),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.payload.shortDescription)}}function z(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",25)(1,"button",23),e.\u0275\u0275element(2,"span",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"ds-themed-loading",5),e.\u0275\u0275elementEnd()),2&a){const n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275classMap(n.isExpanded?"fa fa-chevron-down":"fa fa-chevron-right")}}function K(a,i){if(1&a){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cdk-tree-node",16)(1,"div",7)(2,"button",17),e.\u0275\u0275listener("click",function(){const f=e.\u0275\u0275restoreView(n).$implicit;return e.\u0275\u0275nextContext().toggleExpanded(f)}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275element(4,"span",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"h5",10)(6,"a",19),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"ds-truncatable",20)(9,"div",12),e.\u0275\u0275template(10,$,6,6,"div",21),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(11,z,4,3,"div",22),e.\u0275\u0275pipe(12,"async"),e.\u0275\u0275elementEnd()}if(2&a){const n=i.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("title","toggle "+n.name)("ngClass",e.\u0275\u0275pipeBind1(3,11,o.hasChild(null,n))?"visible":"invisible"),e.\u0275\u0275attribute("aria-label","toggle "+n.name),e.\u0275\u0275advance(2),e.\u0275\u0275classMap(n.isExpanded?"fa fa-chevron-down":"fa fa-chevron-right"),e.\u0275\u0275advance(2),e.\u0275\u0275property("routerLink",n.route),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("id",n.id),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.payload.shortDescription),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(12,13,n===o.loadingNode&&o.dataSource.loading$))}}function V(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",13)(1,"button",23),e.\u0275\u0275element(2,"span",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"ds-truncatable-part",24)(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()()),2&a){const n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275classMap(n.isExpanded?"fa fa-chevron-down":"fa fa-chevron-right"),e.\u0275\u0275advance(1),e.\u0275\u0275property("id",n.id)("minLines",3),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.payload.shortDescription)}}function X(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"cdk-tree-node",26)(1,"div",7)(2,"button",8),e.\u0275\u0275element(3,"span",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"h6",10)(5,"a",19),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"ds-truncatable",20)(8,"div",12),e.\u0275\u0275template(9,V,6,6,"div",21),e.\u0275\u0275elementEnd()()()),2&a){const n=i.$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275property("routerLink",n.route),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("id",n.id),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.payload.shortDescription)}}let k=(()=>{class a{constructor(n){this.communityListService=n,this.expandedNodes=[],this.treeControl=new u.C2(o=>o.level,o=>!0),this.paginationConfig=new F.R,this.paginationConfig.elementsPerPage=2,this.paginationConfig.currentPage=1,this.paginationConfig.sort=new r.o("dc.title",r.S.ASC)}ngOnInit(){this.dataSource=new v(this.communityListService),this.communityListService.getLoadingNodeFromStore().pipe((0,s.q)(1)).subscribe(n=>{this.loadingNode=n}),this.communityListService.getExpandedNodesFromStore().pipe((0,s.q)(1)).subscribe(n=>{this.expandedNodes=[...n],this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)})}ngOnDestroy(){this.communityListService.saveCommunityListStateToStore(this.expandedNodes,this.loadingNode)}hasChild(n,o){return o.isExpandable$}isShowMore(n,o){return o.isShowMoreNode}toggleExpanded(n){this.loadingNode=n,n.isExpanded?(this.expandedNodes=this.expandedNodes.filter(o=>o.name!==n.name),n.isExpanded=!1):(this.expandedNodes.push(n),n.isExpanded=!0,(0,c.xb)(n.currentCollectionPage)&&(n.currentCollectionPage=1),(0,c.xb)(n.currentCommunityPage)&&(n.currentCommunityPage=1)),this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)}getNextPage(n){this.loadingNode=n,null!=n.parent?("collection"===n.id&&this.expandedNodes.find(d=>n.parent.id===d.id).currentCollectionPage++,"community"===n.id&&this.expandedNodes.find(d=>n.parent.id===d.id).currentCommunityPage++,this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)):(this.paginationConfig.currentPage++,this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes))}}return a.\u0275fac=function(n){return new(n||a)(e.\u0275\u0275directiveInject(p.rv))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["ds-community-list"]],decls:6,vars:8,consts:[["class","ds-themed-loading",4,"ngIf"],[3,"dataSource","treeControl"],["cdkTreeNodePadding","","class","example-tree-node show-more-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],["cdkTreeNodePadding","","class","example-tree-node expandable-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],["cdkTreeNodePadding","","class","example-tree-node childless-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],[1,"ds-themed-loading"],["cdkTreeNodePadding","",1,"example-tree-node","show-more-node"],[1,"btn-group"],["type","button","cdkTreeNodeToggle","",1,"btn","btn-default"],["aria-hidden","true",1,"fa","fa-chevron-right","invisible"],[1,"align-middle","pt-2"],["class","btn btn-outline-primary btn-sm","role","button",3,"routerLink","click",4,"ngIf"],["cdkTreeNodePadding","",1,"text-muted"],[1,"d-flex"],["role","button",1,"btn","btn-outline-primary","btn-sm",3,"routerLink","click"],[1,"fas","fa-angle-down"],["cdkTreeNodePadding","",1,"example-tree-node","expandable-node"],["type","button","cdkTreeNodeToggle","",1,"btn","btn-default",3,"title","ngClass","click"],["aria-hidden","true"],[1,"lead",3,"routerLink"],[3,"id"],["class","d-flex",4,"ngIf"],["class","d-flex","cdkTreeNodePadding","",4,"ngIf"],["type","button",1,"btn","btn-default","invisible"],[3,"id","minLines"],["cdkTreeNodePadding","",1,"d-flex"],["cdkTreeNodePadding","",1,"example-tree-node","childless-node"]],template:function(n,o){1&n&&(e.\u0275\u0275template(0,m,1,0,"ds-themed-loading",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"cdk-tree",1),e.\u0275\u0275template(3,D,10,4,"cdk-tree-node",2),e.\u0275\u0275template(4,K,13,15,"cdk-tree-node",3),e.\u0275\u0275template(5,X,10,4,"cdk-tree-node",4),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,6,o.dataSource.loading$)&&!o.loadingNode),e.\u0275\u0275advance(2),e.\u0275\u0275property("dataSource",o.dataSource)("treeControl",o.treeControl),e.\u0275\u0275advance(1),e.\u0275\u0275property("cdkTreeNodeDefWhen",o.isShowMore),e.\u0275\u0275advance(1),e.\u0275\u0275property("cdkTreeNodeDefWhen",o.hasChild),e.\u0275\u0275advance(1),e.\u0275\u0275property("cdkTreeNodeDefWhen",!(o.hasChild&&o.isShowMore)))},directives:[O.O5,B.Z,u._0,u.rO,u.Hs,u.XJ,u.Ud,j.yS,O.mk,R.n,A.L],pipes:[O.Ov,M.X$],styles:["a[_ngcontent-%COMP%]{color:var(--cs-a-col)}a[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus   [_ngcontent-%COMP%]:hover{color:var(--cs-a-col-hover)}"]}),a})()},53508:(N,x,t)=>{"use strict";t.d(x,{J:()=>c});var s=t(46533),r=t(70074);function p(l,g){}let c=(()=>{class l extends s.F{getComponentName(){return"CommunityListComponent"}importThemedComponent(v){return t(65978)(`./${v}/app/community-list-page/community-list/community-list.component`)}importUnthemedComponent(){return Promise.resolve().then(t.bind(t,66143))}}return l.\u0275fac=function(){let g;return function(u){return(g||(g=r.\u0275\u0275getInheritedFactory(l)))(u||l)}}(),l.\u0275cmp=r.\u0275\u0275defineComponent({type:l,selectors:[["ds-themed-community-list"]],features:[r.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["vcr",""]],template:function(v,u){1&v&&r.\u0275\u0275template(0,p,0,0,"ng-template",null,0,r.\u0275\u0275templateRefExtractor)},encapsulation:2}),l})()},94015:(N,x,t)=>{var s={"./custom/app/community-list-page/community-list-page.component":[40777,777],"./gusi/app/community-list-page/community-list-page.component":[28658,8658]};function r(p){if(!t.o(s,p))return Promise.resolve().then(()=>{var g=new Error("Cannot find module '"+p+"'");throw g.code="MODULE_NOT_FOUND",g});var c=s[p],l=c[0];return t.e(c[1]).then(()=>t(l))}r.keys=()=>Object.keys(s),r.id=94015,N.exports=r},65978:(N,x,t)=>{var s={"./custom/app/community-list-page/community-list/community-list.component":[35776,5776],"./gusi/app/community-list-page/community-list/community-list.component":[86585,6585]};function r(p){if(!t.o(s,p))return Promise.resolve().then(()=>{var g=new Error("Cannot find module '"+p+"'");throw g.code="MODULE_NOT_FOUND",g});var c=s[p],l=c[0];return t.e(c[1]).then(()=>t(l))}r.keys=()=>Object.keys(s),r.id=65978,N.exports=r}}]);