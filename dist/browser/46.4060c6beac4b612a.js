"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[46,8723],{48723:(F,g,i)=>{i.d(g,{V:()=>S});var r=i(70074),o=i(59492),E=i(25839),x=i(53019),y=i(16228),O=i(48358),h=i(5496),_=i(86553),I=i(7519),P=i(10210),e=i(61792),f=i(45028);function M(s,m){if(1&s&&r.\u0275\u0275element(0,"ds-form",4),2&s){const n=r.\u0275\u0275nextContext();r.\u0275\u0275property("formId",n.FORM_PREFIX)("formModel",n.formModel)("formGroup",n.formGroup)("displaySubmit",!1)("displayCancel",!1)}}function C(s,m){if(1&s&&(r.\u0275\u0275elementStart(0,"div",5),r.\u0275\u0275text(1),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275elementEnd()),2&s){const n=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(2,1,n.FORM_PREFIX+"error.matching-passwords"))}}function v(s,m){if(1&s&&(r.\u0275\u0275elementStart(0,"div",6),r.\u0275\u0275text(1),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275elementEnd()),2&s){const n=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(2,1,n.FORM_PREFIX+"error.empty-password"))}}let S=(()=>{class s{constructor(n,p,u,T){this.formService=n,this.translate=p,this.epersonService=u,this.notificationsService=T,this.isInvalid=new r.EventEmitter,this.passwordValue=new r.EventEmitter,this.currentPasswordValue=new r.EventEmitter,this.formModel=[new o.b1u({id:"password",name:"password",inputType:"password"}),new o.b1u({id:"passwordrepeat",name:"passwordrepeat",inputType:"password"})],this.passwordCanBeEmpty=!0,this.subs=[]}ngOnInit(){"profile.security.form."===this.FORM_PREFIX&&this.formModel.unshift(new o.b1u({id:"current-password",name:"current-password",inputType:"password",required:!0})),this.formGroup=this.formService.createFormGroup(this.formModel,this.passwordCanBeEmpty?{validators:[this.checkPasswordsEqual]}:{validators:[this.checkPasswordsEqual,this.checkPasswordEmpty]}),this.updateFieldTranslations(),this.translate.onLangChange.subscribe(()=>{this.updateFieldTranslations()}),this.subs.push(this.formGroup.statusChanges.pipe((0,h.ig)(300),(0,O.U)(n=>"VALID"!==n)).subscribe(n=>this.isInvalid.emit(n))),this.subs.push(this.formGroup.valueChanges.pipe((0,h.ig)(300)).subscribe(n=>{this.passwordValue.emit(n.password),"profile.security.form."===this.FORM_PREFIX&&this.currentPasswordValue.emit(n["current-password"])}))}updateFieldTranslations(){this.formModel.forEach(n=>{n.label=this.translate.instant(this.FORM_PREFIX+"label."+n.id)})}checkPasswordsEqual(n){return n.get("password").value===n.get("passwordrepeat").value?null:{notSame:!0}}checkPasswordEmpty(n){const p=n.get("password").value;return(0,E.xb)(p)?{emptyPassword:!0}:null}ngOnDestroy(){this.subs.filter(n=>(0,E.Uh)(n)).forEach(n=>n.unsubscribe())}}return s.\u0275fac=function(n){return new(n||s)(r.\u0275\u0275directiveInject(o.w1X),r.\u0275\u0275directiveInject(_.sK),r.\u0275\u0275directiveInject(x.k),r.\u0275\u0275directiveInject(y.T))},s.\u0275cmp=r.\u0275\u0275defineComponent({type:s,selectors:[["ds-profile-page-security-form"]],inputs:{passwordCanBeEmpty:"passwordCanBeEmpty",FORM_PREFIX:"FORM_PREFIX"},outputs:{isInvalid:"isInvalid",passwordValue:"passwordValue",currentPasswordValue:"currentPasswordValue"},decls:6,vars:7,consts:[[1,"mb-4",3,"type"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel",4,"ngIf"],["id","notSame","class","container-fluid text-danger",4,"ngIf"],["id","emptyPassword","class","container-fluid text-danger",4,"ngIf"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel"],["id","notSame",1,"container-fluid","text-danger"],["id","emptyPassword",1,"container-fluid","text-danger"]],template:function(n,p){1&n&&(r.\u0275\u0275elementStart(0,"ds-alert",0),r.\u0275\u0275text(1),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(3,M,1,5,"ds-form",1),r.\u0275\u0275template(4,C,3,3,"div",2),r.\u0275\u0275template(5,v,3,3,"div",3)),2&n&&(r.\u0275\u0275property("type","alert-info"),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(2,5,p.FORM_PREFIX+"info")),r.\u0275\u0275advance(2),r.\u0275\u0275property("ngIf",p.formModel),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",p.formGroup.hasError("notSame")),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",(p.formGroup.dirty||p.formGroup.touched)&&p.formGroup.hasError("emptyPassword")))},directives:[I.w,P.O5,e.U,f.JL,f.sg],pipes:[_.X$],encapsulation:2}),s})()},50046:(F,g,i)=>{i.r(g),i.d(g,{CreateProfileComponent:()=>L});var r=i(48358),o=i(45028),E=i(53019),x=i(62610),y=i(80485),O=i(16228),h=i(57017),_=i(25839),I=i(3765),P=i(5496),e=i(70074),f=i(86553),M=i(5328),C=i(37895),v=i(10210),S=i(48723);function s(a,l){1&a&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"register-page.create-profile.identification.first-name.error")," "))}function m(a,l){1&a&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"register-page.create-profile.identification.first-name.error.invalidformat")," "))}function n(a,l){if(1&a&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275template(1,s,3,3,"span",20),e.\u0275\u0275template(2,m,3,3,"span",20),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.firstName.errors&&t.firstName.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.firstName.errors&&t.firstName.errors.pattern)}}function p(a,l){if(1&a&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275template(1,n,3,2,"span",20),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.firstName.errors)}}function u(a,l){1&a&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"register-page.create-profile.identification.last-name.error")," "))}function T(a,l){1&a&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"register-page.create-profile.identification.last-name.error.invalidformat")," "))}function N(a,l){if(1&a&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275template(1,u,3,3,"span",20),e.\u0275\u0275template(2,T,3,3,"span",20),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.lastName.errors&&t.lastName.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.lastName.errors&&t.lastName.errors.pattern)}}function w(a,l){if(1&a&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275template(1,N,3,2,"span",20),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.lastName.errors)}}function B(a,l){1&a&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"register-page.create-profile.identification.phone.error.invalidformat")," "))}function R(a,l){if(1&a&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,B,3,3,"span",20),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.contactPhone.errors&&t.contactPhone.errors.pattern)}}function A(a,l){if(1&a&&(e.\u0275\u0275elementStart(0,"option",23),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=l.$implicit;e.\u0275\u0275property("value",t.code),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.label)}}function b(a,l){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",1)(1,"h3",2),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",3)(5,"div",4),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"span",9),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(17,"form",10),e.\u0275\u0275listener("ngSubmit",function(){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext().submitEperson()}),e.\u0275\u0275elementStart(18,"div",11)(19,"div",6)(20,"div",7)(21,"label",12),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"input",13),e.\u0275\u0275template(25,p,2,1,"div",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(26,"div",6)(27,"div",7)(28,"label",15),e.\u0275\u0275text(29),e.\u0275\u0275pipe(30,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(31,"input",16),e.\u0275\u0275template(32,w,2,1,"div",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(33,"div",6)(34,"div",7)(35,"label",17),e.\u0275\u0275text(36),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(38,"input",18),e.\u0275\u0275elementStart(39,"div",19),e.\u0275\u0275template(40,R,2,1,"div",20),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(41,"div",6)(42,"div",7)(43,"label",21),e.\u0275\u0275text(44),e.\u0275\u0275pipe(45,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"select",22),e.\u0275\u0275element(47,"option",23),e.\u0275\u0275template(48,A,2,2,"option",24),e.\u0275\u0275elementEnd()()()()()()(),e.\u0275\u0275elementStart(49,"div",3)(50,"div",4),e.\u0275\u0275text(51),e.\u0275\u0275pipe(52,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(53,"div",5)(54,"ds-profile-page-security-form",25),e.\u0275\u0275listener("isInvalid",function(d){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext().setInValid(d)})("passwordValue",function(d){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext().setPasswordValue(d)}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(55,"div",6)(56,"div",7)(57,"button",26),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext().submitEperson()}),e.\u0275\u0275text(58),e.\u0275\u0275pipe(59,"translate"),e.\u0275\u0275elementEnd()()()()}if(2&a){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,23,"register-page.create-profile.header")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,25,"register-page.create-profile.identification.header")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(13,27,"register-page.create-profile.identification.email"),": "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,29,t.registration$).email),e.\u0275\u0275advance(2),e.\u0275\u0275classMap("ng-invalid"),e.\u0275\u0275property("formGroup",t.userInfoForm),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(23,31,"register-page.create-profile.identification.first-name")),e.\u0275\u0275advance(2),e.\u0275\u0275property("className",t.firstName.invalid&&(t.firstName.dirty||t.firstName.touched)?"form-control is-invalid":"form-control"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.firstName.invalid&&(t.firstName.dirty||t.firstName.touched)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(30,33,"register-page.create-profile.identification.last-name")),e.\u0275\u0275advance(2),e.\u0275\u0275property("className",t.lastName.invalid&&(t.lastName.dirty||t.lastName.touched)?"form-control is-invalid":"form-control"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.lastName.invalid&&(t.lastName.dirty||t.lastName.touched)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(37,35,"register-page.create-profile.identification.contact")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.contactPhone.errors),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(45,37,"register-page.create-profile.identification.language")),e.\u0275\u0275advance(3),e.\u0275\u0275property("value",""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.activeLangs),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(52,39,"register-page.create-profile.security.header")),e.\u0275\u0275advance(3),e.\u0275\u0275property("passwordCanBeEmpty",!1)("FORM_PREFIX","register-page.create-profile.security."),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",t.isInValidPassword||t.userInfoForm.invalid),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(59,41,"register-page.create-profile.submit"))}}let L=(()=>{class a{constructor(t,c,d,D,U,K,V,W){this.translateService=t,this.ePersonDataService=c,this.store=d,this.router=D,this.route=U,this.formBuilder=K,this.notificationsService=V,this.endUserAgreementService=W,this.isInValidPassword=!0,this.NOTIFICATIONS_PREFIX="register-page.create-profile.submit."}ngOnInit(){this.registration$=this.route.data.pipe((0,r.U)(t=>t.registration),(0,P.Gp)()),this.registration$.subscribe(t=>{this.email=t.email,this.token=t.token}),this.activeLangs=h.N.languages.filter(t=>!0===t.active),this.userInfoForm=this.formBuilder.group({firstName:new o.NI("",{validators:[o.kI.required,o.kI.pattern(/^[a-z ,.'-]+$/i)]}),lastName:new o.NI("",{validators:[o.kI.required,o.kI.pattern(/^[a-z ,.'-]+$/i)]}),contactPhone:new o.NI("",{validators:[o.kI.required,o.kI.pattern(/^(09|\+639)\d{9}$/)]}),language:new o.NI("")})}setInValid(t){this.isInValidPassword=t||(0,_.xb)(this.password)}setPasswordValue(t){this.password=t,this.isInValidPassword=this.isInValidPassword||(0,_.xb)(this.password)}get firstName(){return this.userInfoForm.get("firstName")}get lastName(){return this.userInfoForm.get("lastName")}get contactPhone(){return this.userInfoForm.get("contactPhone")}get language(){return this.userInfoForm.get("language")}submitEperson(){if(!this.userInfoForm.invalid&&!this.isInValidPassword){const t={metadata:{"eperson.firstname":[{value:this.firstName.value}],"eperson.lastname":[{value:this.lastName.value}],"eperson.phone":[{value:this.contactPhone.value}],"eperson.language":[{value:this.language.value}]},email:this.email,password:this.password,canLogIn:!0,requireCertificate:!1};this.endUserAgreementService.isCookieAccepted()&&(t.metadata[I.DJ]=[{value:String(!0)}],this.endUserAgreementService.removeCookieAccepted());const c=Object.assign(new x.T,t);this.ePersonDataService.createEPersonForToken(c,this.token).pipe((0,P.hC)()).subscribe(d=>{d.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.NOTIFICATIONS_PREFIX+"success.head"),this.translateService.get(this.NOTIFICATIONS_PREFIX+"success.content")),this.store.dispatch(new y.zn(this.email,this.password)),this.router.navigate(["/home"])):this.notificationsService.error(this.translateService.get(this.NOTIFICATIONS_PREFIX+"error.head"),d.errorMessage)})}}}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(f.sK),e.\u0275\u0275directiveInject(E.k),e.\u0275\u0275directiveInject(M.yh),e.\u0275\u0275directiveInject(C.F0),e.\u0275\u0275directiveInject(C.gz),e.\u0275\u0275directiveInject(o.qu),e.\u0275\u0275directiveInject(O.T),e.\u0275\u0275directiveInject(I.u4))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["ds-create-profile"]],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"mb-4"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-12"],["for","email",1,"font-weight-bold"],["id","email"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","firstName"],["type","text","id","firstName","formControlName","firstName",3,"className"],["class","invalid-feedback show-feedback",4,"ngIf"],["for","lastName"],["id","lastName","formControlName","lastName",3,"className"],["for","contactPhone"],["id","contactPhone","formControlName","contactPhone",1,"form-control"],[1,"invalid-feedback","show-feedback","d-block"],[4,"ngIf"],["for","language"],["id","language","formControlName","language",1,"form-control"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"passwordCanBeEmpty","FORM_PREFIX","isInvalid","passwordValue"],[1,"btn","btn-default","btn-primary",3,"disabled","click"],[1,"invalid-feedback","show-feedback"]],template:function(t,c){1&t&&(e.\u0275\u0275template(0,b,60,43,"div",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,c.registration$))},directives:[v.O5,o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,o.EJ,o.YN,o.Kr,v.sg,S.V],pipes:[v.Ov,f.X$],styles:[""]}),a})()}}]);